<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:image" content="http://get.carrotsearch.com/foamtree/latest/demos/assets/img/main-thumbnail.jpg"/>
    <meta name="description" content="Carrot Search FoamTree is a modern, in-browser HTML5 implementation of hierarchical Voronoi Treemaps. With animated transitions and zooming, varied layouts and visual customizations, FoamTree can provide an engaging user experience." />

    <title>Carrot Search FoamTree, API reference</title>

    <link href="../demos/assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../demos/assets/css/bootstrap-theme.min.css" rel="stylesheet" />
    <link href="../demos/assets/css/docs.css" rel="stylesheet" />
    <link href="../demos/assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../demos/assets/css/github.css" rel="stylesheet" />
  </head>

  <body data-spy="scroll" data-target=".bs-sidebar">
    <div id="example-overlay" class="fadeout">
      <div id="visualization"></div>
      <div id="example-overlay-help">
        <span class="label label-warning"><i class="icon-remove icon-white"></i> Press ESC or click outside to exit.</span>
      </div>
    </div>

    <div class="container bs-docs-container">
      <div class="row">
        <div class="col-sm-3">
          <div class="bs-sidebar hidden-print affix-top">
            <div class="searchbox">
              <input id="search" type="search" class="form-control input-sm" placeholder="type to filter" />
              <button class="btn btn-default btn-xs" id="toggle-font"><i class="fa fa-lg fa-text-height"></i> <span>normal</span></button>
            </div>

            <div class="bs-sidenav" id="toc">
            </div>
          </div>
        </div>

        <section class="col-sm-9" role="main">
          <div class="jumbotron">
            <h1>Carrot Search FoamTree</h1>
            <p id="buildinfo" class="lead">API reference, version 3.3.1</p>
          </div>

          <section class="notoc" id="home">
            <p>
              Carrot Search FoamTree is a modern, in-browser implementation of hierarchical Voronoi Treemaps.
              With animated transitions and zooming, varied layouts and visual customizations, FoamTree
              can provide an engaging user experience.
            </p>

            <p>
              Technically, FoamTree is an HTML5 application, all modern desktop and mobile browsers supporting the
              canvas specification will be able to display the visualization. FoamTree can be
              integrated into an HTML page using a simple JavaScript API.
            </p>

            <p>An up-to-date version for the latest stable release of FoamTree is always at:
              <a href="http://get.carrotsearch.com/foamtree/api"><code>http://get.carrotsearch.com/foamtree/api</code></a>.</p>
          </section>

          <section id="quick-start">
            <div class="page-header"><h1>Quick start</h1></div>

            <p>
              You can get your first FoamTree visualization in 3 simple steps:
            </p>

            <ol>
              <li>
                Include <code>carrotsearch.foamtree.js</code> in your page.
              </li>

              <li>
                Define an HTML element in which FoamTree should be embedded. The element
                must have non-zero dimensions.
              </li>

              <li>
                Initialize FoamTree by creating a new instance of the <code>CarrotSearchFoamTree</code>
                class. In the <a href="#changing-options">options</a> object passed to the constructor, provide the
                the identifier of your HTML element and some <a href="#data-model">data to visualize</a>.
              </li>
            </ol>

            <p>
              Below is a complete working example illustrating the above steps. Please note you
              may need to correct the path to the <code>carrotsearch.foamtree.js</code>
              script to match the directory structure of your page.
            </p>

            <pre class="example">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;FoamTree Quick Start&lt;/title&gt;
    &lt;meta charset="utf-8" /&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div id="visualization" style="width: 800px; height: 600px"&gt;&lt;/div&gt;

    &lt;script src="../carrotsearch.foamtree.js"&gt;&lt;/script&gt;
    &lt;script&gt;
      window.addEventListener("load", function() {
        var foamtree = new CarrotSearchFoamTree({
          id: "visualization",
          dataObject: {
            groups: [
              { label: "Your", weight: 1.0 },
              { label: "First", weight: 3.0 },
              { label: "FoamTree", weight: 2.0 },
              { label: "Visualization", weight: 4.0 }
            ]
          }
        });
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

            <pre class="executable example hidden">
var foamtree = new CarrotSearchFoamTree({
  id: "visualization",
  dataObject: {
    groups: [
      { label: "Your", weight: 1.0 },
      { label: "First", weight: 3.0 },
      { label: "FoamTree", weight: 2.0 },
      { label: "Visualization", weight: 4.0 }
    ]
  }
});</pre>
          </section>

          <section id="introduction">
            <div class="page-header"><h1>Introduction</h1></div>

            <section id="requirements">
              <h3>Requirements</h3>

              <p>
                FoamTree requires a HTML5-compliant browser to run. In particular, it uses
                the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html">canvas</a>
                and <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webstorage.html">local storage</a>
                parts of the specification, as well as
                <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript 5 JavaScript</a> constructs.
                Most modern browsers meet the requirements and can run FoamTree.
              </p>

              <p>FoamTree is officially supported on the following browsers:</p>
              <ul>
                <li><a href="https://www.google.com/chrome/">Google Chrome</a>: two latest versions</li>
                <li><a href="http://www.mozilla.org/en-US/firefox/new/">Mozilla Firefox</a>: two latest versions</li>
                <li><a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">Microsoft Internet Explorer</a>: version 9 and later</li>
                <li>Mac OS Safari: version 5 and later</li>
                <li>iOS Safari: version 4.2 and later</li>
              </ul>

              <p>
                FoamTree will most likely work on other modern browsers (such as <a href="http://www.opera.com/">Opera</a>),
                though support for these is not a priority.
              </p>
            </section>

            <section id="distribution-package">
              <h3>Distribution package</h3>

              <p>
                FoamTree distribution package contains the following files and directories:
              </p>

              <ul>
                <li><code>api/</code>: FoamTree API reference.</li>
                <li>
                  <code>demos/</code>: a number of complete <a href="../demos/index.html">demo applications</a> illustrating
                  specific aspects of FoamTree.
                </li>
                <li>
                  <code>tests/</code>: FoamTree's <a href="../tests/index.html">test suite</a>.
                </li>

                <li>
                  <code>carrotsearch.foamtree.js</code>: FoamTree implementation, required at runtime.
                </li>

                <li>
                  <code>carrotsearch.foamtree.asserts.js</code>: validates
                  option values passed to FoamTree, useful for development and
                  <a href="#debugging">debugging</a>, not required at runtime.
                </li>

                <li>
                  <code>carrotsearch.foamtree.util.*.js</code>: <a href="#utilities">utility
                  scripts</a> that handle a number of typical programming tasks
                  around FoamTree, such as showing and hiding a <em>Loading...</em>
                  indicator when new data is loading.
                </li>
              </ul>
            </section>

            <section id="api-overview">
              <h3>API Overview</h3>

              <p>
                The core implementation and API of the visualization is contained in the
                <code>carrotsearch.foamtree.js</code> file. It handles all your code's
                interactions with the visualization, including embedding, changing visual properties,
                loading new data and listening to events.
              </p>

              <p>
                The entry point to the API is an instance of the <code>CarrotSearchFoamTree</code>
                class created <a href="#embedding">during embedding</a>.
              </p>
            </section>

            <section id="concepts">
              <h3>Important concepts</h3>

              <p>
                The remaining part of this documentation refers to a number of concepts defined below.
              </p>

              <dl class="dl-horizontal">
                <dt>data model</dt>
                <dd>
                  the data FoamTree can visualize; consists of a hierarchical structure of groups
                </dd>

                <dt>group</dt>
                <dd>
                  an individual piece of data FoamTree can visualize; represented by a polygon
                </dd>

                <dt>rollout</dt>
                <dd>
                  the animated effect FoamTree uses to show a new data model
                </dd>

                <dt>pullback</dt>
                <dd>
                  the animated effect FoamTree uses to hide an existing data model
                </dd>
              </dl>

              <h4 id="group-states">Group states</h4>

              <p>
                Each group shown in the visualization can be in a combination of four different states
                (see the image below):
              </p>

              <dl class="dl-horizontal">
                <dt>selected / unselected</dt>
                <dd>
                  groups selected by the user are drawn with a thick outline
                </dd>

                <dt>open / closed</dt>
                <dd>
                  if a group is open, its label and polygon are not painted so that the user can
                  interact with its child groups
                </dd>

                <dt>exposed / unexposed</dt>
                <dd>
                  an exposed group gets zoomed in, so that the user can inspect its contents more easily;
                  groups that are not exposed at the moment are zoomed out and dimmed
                </dd>

                <dt>hovered</dt>
                <dd>
                  a group over which the user's pointer is hovering gets highlighted
                </dd>
              </dl>

              <img src="../demos/assets/img/foamtree-group-states.jpg" class="img-rounded img-responsive"
                   style="margin-bottom: 20px"/>


              <h4 id="group-decorations">Group decorations</h4>

              <p>
                Each group is drawn with a number of customizable graphical decorations, shown in the image below:
              </p>

              <dl class="dl-horizontal">
                <dt>border width</dt>
                <dd>
                  the distance between neighboring groups of the same level
                </dd>

                <dt>inset width</dt>
                <dd>
                  the distance between a group's border and its immediate child groups' borders
                </dd>

                <dt>stroke width</dt>
                <dd>
                  width of the line drawn along the group's border
                </dd>

                <dt>selection outline width</dt>
                <dd>
                  width of the line drawn to mark selected groups
                </dd>

                <dt>border radius</dt>
                <dd>
                  radius of the group's border
                </dd>
              </dl>

              <img src="../demos/assets/img/foamtree-group-shapes.jpg" class="img-rounded img-responsive" />
            </section>

            <section id="interaction">
              <h3>Interaction</h3>

              <p>
                Users can interact with FoamTree in the following ways:
              </p>

              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 14em" class="text-right">On desktop device</th>
                    <th style="width: 14em" class="text-right">On touch device</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr id="interaction-select">
                    <td class="text-right">left click</td>
                    <td class="text-right">tap</td>
                    <td>select group, again to deselect</td>
                  </tr>
                  <tr>
                    <td class="text-right">
                      <span class="key">Ctrl</span> + left click<br />
                      <span class="key">&#8984;</span> + left click
                    </td>
                    <td></td>
                    <td>select multiple groups</td>
                  </tr>
                  <tr id="interaction-expose">
                    <td class="text-right">left double click</td>
                    <td class="text-right">double tap</td>
                    <td>expose group</td>
                  </tr>
                  <tr id="interaction-unexpose">
                    <td class="text-right">
                      right double click<br/>
                      <span class="key">Shift</span> + left double click
                    </td>
                    <td class="text-right">two-finger double tap</td>
                    <td>unexpose group</td>
                  </tr>
                  <tr id="interaction-open">
                    <td class="text-right">left click-and-hold</td>
                    <td class="text-right">tap-and-hold</td>
                    <td>open group</td>
                  </tr>
                  <tr id="interaction-close">
                    <td class="text-right">
                      right click-and-hold<br/>
                      <span class="key">Shift</span> + left click-and-hold
                    </td>
                    <td class="text-right">two-finger tap-and-hold</td>
                    <td>close group</td>
                  </tr>
                  <tr id="interaction-zoom">
                    <td class="text-right">mouse wheel</td>
                    <td class="text-right">pinch</td>
                    <td>zoom in / out</td>
                  </tr>
                  <tr id="interaction-pan">
                    <td class="text-right">mouse drag</td>
                    <td class="text-right">drag</td>
                    <td>pan around zoomed visualization</td>
                  </tr>
                  <tr id="interaction-reset">
                    <td class="text-right"><span class="key">Esc</span><br/>rapid zoom out</td>
                    <td class="text-right">three-finger pinch</td>
                    <td>unexpose and close all groups, reset zoom factor</td>
                  </tr>
                </tbody>
              </table>

              <p>
                You can use the <a href="#hints">interaction hints utility</a> to display a simple
                interaction guide for the users. If needed, you can <a href="#changing-event-mappings">change
                the default interaction mappings</a>.
              </p>
            </section>
          </section>

          <section id="basic-usage">
            <div class="page-header"><h1>Basic usage</h1></div>

            <section id="embedding">
              <h3>Embedding</h3>

              <p>
                Before FoamTree can display anything, it needs to be embedded in your HTML page.
                To embed FoamTree, your page needs to:
              </p>

              <ol>
                <li>
                  Load <code>carrotsearch.foamtree.js</code>, which contains FoamTree implementation.
                  You will usually use a dedicated <code>script</code> tag for this, but you can also
                  concatenate FoamTree code with some other JavaScript on your page to speed up page loading.
                </li>

                <li>
                  Define the HTML element that will contain FoamTree visualization. FoamTree will occupy the
                  full width and height of the element.
                </li>

                <li>
                  Inspect the static <code>supported</code> property of the visualization class to make sure
                  the browser supports FoamTree.
                </li>

                <li>
                  <p>
                    Initialize FoamTree by calling the <code>CarrotSearchFoamTree</code> constructor and providing
                    the options object as a parameter. The only required option during initialization is
                    the <code>id</code> or the <code>element</code> option that need to point to the HTML
                    element you defined earlier. In most cases, you will be providing other options during
                    initialization as well, such as the <code>dataObject</code> to display or some visual
                    customizations. See the <a href="#options">options reference</a> for a complete list of options.
                  </p>
                </li>
              </ol>

              <div class="alert alert-info">
                <strong>Heads up!</strong>

                <p>
                  The element HTML needs to have non-zero dimensions at the time FoamTree initializes. In most
                  cases it is enough to initialize FoamTree once the DOM is ready. In certain cases, however,
                  especially when the page is accessed through the file:// protocol, the element will
                  receive its size a bit later. To avoid race conditions, you can initialize FoamTree in the
                  <code>onload</code> event.
                </p>

                <pre class="example">
&lt;script&gt;
window.addEventListener("load", function() {
  // Perform FoamTree embedding here
});
&lt;/script&gt;</pre>
              </div>

              <div class="alert alert-warning">
                <strong>Touch devices</strong>

                <p>
                  Support for touch-based interaction requires some extra embedding steps. Please see the
                  <a href="#touch-devices">touch devices</a> section for the details.
                </p>
              </div>


              <p>
                The following example shows typical embedding code with a minimal data model.
                This will also be our baseline for examples where the embedding isn't explicit.
              </p>

              <pre class="executable example">
if (CarrotSearchFoamTree.supported) {
  var foamtree = new CarrotSearchFoamTree({
    id: "visualization",
    dataObject: {
      groups: [
        { id: "1", label: "Group 1", groups: [
          { id: "1.1", label: "Group 1.1" },
          { id: "1.2", label: "Group 1.2" }
        ]},
        { id: "2", label: "Group 2", groups: [
          { id: "2.1", label: "Group 2.1" },
          { id: "2.2", label: "Group 2.2" }
        ]},
        { id: "3", label: "Group 3", groups: [
          { id: "3.1", label: "Group 3.1" },
          { id: "3.2", label: "Group 3.2" }
        ]},
        { id: "4", label: "Group 4", groups: [
          { id: "4.1", label: "Group 4.1" },
          { id: "4.2", label: "Group 4.2" }
        ]},
        { id: "5", label: "Group 5", groups: [
          { id: "5.1", label: "Group 5.1" },
          { id: "5.2", label: "Group 5.2" }
        ]}
      ]
    }
  });
} else {
  console.log("Visualization not supported.");
}</pre>

              <p>
                The reference to the returned instance (the <code>foamtree</code> variable)
                can be used to <a href="#changing-options">change options</a> of the visualization or
                <a href="#data-model">load new data model</a>. The instance is ready to handle method calls as
                soon as the constructor invocation returns.
              </p>

            </section>

            <section id="changing-options">
              <h3>Changing options</h3>

              <p>
                After FoamTree initializes you can still change the values of most options using the <code>set</code>
                method. Most commonly, you will be setting a new value for the <code>dataObject</code> option
                to visualize new data.
              </p>

              <p>
                The following example changes the <code>groupSelectionOutlineColor</code>
                to paint the outline in red. Run the example and select some groups to see the result.
              </p>

              <pre class="partial executable example">
foamtree.set("groupSelectionOutlineColor", "red");</pre>

              <div class="alert alert-info">
                <strong>Heads up!</strong>

                <p>
                  When changing certain visual properties using the <code>set</code> method,
                  for the changes to take effect, you will need to explicitly
                  instruct FoamTree to <code>redraw</code> the visualization.
                </p>

                <p>
                  The following code increases the group border and stroke widths.
                  We deliberately defer the call to call the <code>redraw</code> method to show that setting the
                  options alone does not update the visualization image and an explicit redraw is needed.
                </p>

                <!-- Used also in other examples! -->
                <pre class="hidden" id="clearTimeout">
window.clearTimeout(timeout);</pre>

                <pre class="partial executable example" data-runafter="clearTimeout">
var timeout;
timeout = window.setTimeout(function() {
  foamtree.set({
    groupBorderWidth: 20,
    groupInsetWidth: 40,
    groupStrokeWidth: 10
  });

  // Redraw after a while
  timeout = window.setTimeout(foamtree.redraw, 1000);
}, 500);</pre>
              </div>
            </section>

            <section id="data-model">
              <h3>Data model</h3>

              <p>
                A data model can be loaded, replacing the current model, by passing the
                <code>dataObject</code> parameter either during embedding or by calling the <code>set</code> method, as
                in the example below.
              </p>

              <pre class="partial empty executable example">
foamtree.set({
  dataObject: {
    groups: [
      { label:"Group 1", groups: [
        { label:"Group 1.1" },
        { label:"Group 1.2" },
        { label:"Group 1.3" }
      ]},
      { label:"Group 2", groups: [
        { label:"Group 2.1" },
        { label:"Group 2.2" }
      ]},
      { label:"Group 3" }
    ]
  }
});</pre>

              <p>
                If the data model is not in the format presented above, it needs to be converted prior to visualization. In this
                example we will load JSON data from USA Today API, convert it to FoamTree format and visualize. We use
                jQuery to make Ajax requests, but any other library should work equally well. Note how the model changes
                after a short pause (fetching model data dynamically, network connection is required).
              </p>

              <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [ { label: "loading..." }, { label: "Please wait" } ] },
  fadeDuration: 500
});

$.ajax({
  url: "http://api.usatoday.com/open/census/loc?api_key=nqjr52fpvsu8gs97tgnkyzfx",
  dataType: "jsonp",
  jsonpCallback: "callback",
  success: function(data) {
    var states = data.response;

    var races = [
      { label: "Hispanic", prop: "PctHisp" },
      { label: "White",    prop: "PctNonHispWhite" },
      { label: "Black",    prop: "PctBlack" },
      { label: "Indian",   prop: "PctAmInd" },
      { label: "Asian",    prop: "PctAsian" },
      { label: "Hawaiian", prop: "PctNatHawOth" }
    ];

    var popByRace = states.reduce(function (index, state) {
      races.forEach(function (spec) {
        var pop = state[spec.prop] * state.Pop;
        index[spec.prop].total += pop;
        index[spec.prop].min = Math.min(index[spec.prop].min, state[spec.prop]);
        index[spec.prop].max = Math.max(index[spec.prop].max, state[spec.prop]);
      });
      return index;
    }, races.reduce(function (index, spec) {
         index[spec.prop] = { total: 0, min: Number.MAX_VALUE, max: 0 };
         return index;
       }, { }));

    var groups = races.map(function(spec) {
      return {
        label: spec.label,
        weight: popByRace[spec.prop].total,
        groups: states.map(function(state) {
          return {
            label: state.Placename,
            weight: (state[spec.prop] - popByRace[spec.prop].min) /
                      popByRace[spec.prop].max
          };
        })
      };
    });

    foamtree.set({
      dataObject: { groups: groups },
      rolloutDuration: 3000
    });
  }
});</pre>

              <p>
                To clear the visualization, set a <code>null</code> <code>dataObject</code>. If you set any other options
                along with the new data object, the new options will apply both during the pullback
                of the current model and rollout of the new model. The example below clears the current model but also
                sets the duration of the pullback animation. As a result, the current model will disappear in an
                animated fashion.
              </p>

              <pre class="partial executable example" data-runafter="clearTimeout">
var timeout = window.setTimeout(function() {
  foamtree.set({
    pullbackDuration: 1000,
    dataObject: null
  });
}, 1000);</pre>
            </section>


            <section id="selection-opening-exposure">
              <h3>Selection, opening and exposure</h3>

              <p>
                Each group shown by FoamTree can get selected, opened or exposed either as a result of user's
                interactions or through an API call. You can get and set selection, open and exposure
                state in a number of ways.
              </p>


              <h4>Getting selection, opening and exposure</h4>

              <p>
                You can get information about the currently selected, open and exposed groups by getting
                the values of the <code>select</code>, <code>open</code> and <code>exposure</code>
                options, respectively. To get notified about the state changes right after they are made by the user,
                register listeners for the corresponding <a href="#visualization-events">events</a>.
              </p>


              <h4>Setting selection, opening and exposure</h4>

              <p>
                You can change selection, opening and exposure in three different ways:
              </p>

              <ul>
                <li>
                  By setting the <code>select</code>, <code>open</code> and <code>exposure</code> options.
                </li>

                <li>
                  <p>
                    By calling the <code>select</code>, <code>open</code> and <code>expose</code> methods. The
                    difference compared to setting options is that the methods return a <a href="#promise">promise</a>
                    that gets resolved when the animations related to the state change have completed.
                  </p>
                </li>

                <li>
                  <p>
                    By providing the initial group states in the data object using the
                    <code class="nolink">selected</code>, <code class="nolink">open</code>
                    and <code class="nolink">exposed</code> as in the example below.
                  </p>

                  <pre class="partial empty executable example" data-runafter="clearTimeout">
foamtree.set("groupSelectionOutlineColor", "#f00");
foamtree.set("dataObject", { groups: [
  {
    label: "Initially exposed, open & selected",
    exposed: true, open: true, selected: true, groups: [
      { label: "Initially selected", selected: true },
      { label: "Unselected" }
    ]
  },
  {
    label: "Initially open", open: true, groups: [
      { label: "Initially selected", selected: true },
      { label: "Unselected" }
    ]
  }
]});</pre>
                </li>
              </ul>

              <div class="alert alert-warning">
                <strong>Heads up!</strong>
                <p>
                  When group selection, opening or exposure is changed through an API call,
                  the relevant event listeners <strong>will not be called</strong>.
                  Please also see the <a href="#api-triggered-exposure-with-visible-releaxation">limitations
                  when relaxation is visible</a>.
                </p>
              </div>
            </section>


            <section id="visualization-events">
              <h3>Events</h3>

              <p>
                <a href="#event-listener">Event listeners</a> are functions invoked by the visualization code when certain
                conditions or triggers are met. Some of these callbacks are invoked only for user-related actions (for
                example <code>onGroupSelectionChanged</code>), others may be a result of internal state changes
                (like <code>onRolloutComplete</code>). Please see the <a href="#events">event reference</a>
                for a list of all available events.
              </p>

              <p>
                You can manage event listeners in two ways:
              </p>

              <ul>
                <li>
                  <p>
                    <strong>By getting or setting the related options</strong>, or, most commonly, by providing
                    the options during initial embedding. For each option, you can provide an individual function
                    or an array of functions. However, when you get the option value, always an array of functions
                    will be returned, even if there is only one function registered for a specific event.
                    Setting a new function for a specific event will remove all previously registered functions
                    for that event.
                  </p>

                  <p>
                    The example below initializes the visualization and registers for notifications about the changes 
                    of group selection and exposure.
                  </p>

                  <pre class="executable example">
var foamtree = new CarrotSearchFoamTree({
  id: "visualization",
  dataObject: {
    groups: [
      { label: "Try" }, { label: "Selecting" },
      { label: "Or" }, { label: "Exposing" },
      { label: "Some" }, { label: "Group" },
      { label: "And" }, { label: "Watch" },
      { label: "The" }, { label: "Console" }
    ]
  },
  onGroupSelectionChanged: function (info) {
    window.console.log("selected", info);
  },
  onGroupExposureChanged: [
    function(info) {
      window.console.log("exposed 1", info);
    },
    function(info) {
      window.console.log("exposed 2", info);
    }
  ]
});</pre>
                </li>

                <li>
                  <p>
                    <strong>By calling the <code>on</code> and <code>off</code> methods</strong>, to add and remove event listeners,
                    respectively. As opposed to using the <code>set</code> method, the <code>on</code> and <code>off</code>
                    methods preserve the previously registered listeners.
                  </p>

                  <p>
                    Both the <code>on</code> and <code>off</code> method takes two parameters: the type of the event
                    and the event listener to add or remove. The example code below adds group selection and exposure
                    listeners:
                  </p>

                  <pre class="executable example">
var foamtree = new CarrotSearchFoamTree({
  id: "visualization",
  dataObject: {
    groups: [
      { label: "Try" }, { label: "Selecting" },
      { label: "Or" }, { label: "Exposing" },
      { label: "Some" }, { label: "Group" },
      { label: "And" }, { label: "Watch" },
      { label: "The" }, { label: "Console" },
    ]
  }
});
foamtree.on("groupSelectionChanged", function (info) {
  window.console.log("selected", info);
});
foamtree.on("groupExposureChanged", function(info) {
  window.console.log("exposed 1", info);
});
foamtree.on("groupExposureChanged", function(info) {
  window.console.log("exposed 2", info);
});</pre>

                  <div class="alert alert-info">
                    <strong>Heads up!</strong>

                    <p>
                      To get the type string to use with the <code>on</code> / <code>off</code> method,
                      take the event option name, remove the leading "on" and lower-case the first letter, for example:
                    </p>

                    <table class="table">
                      <thead>
                        <tr>
                          <th>Option name for the <code>set</code> method</th>
                          <th>Event name for the <code>on</code> / <code>off</code> methods</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>onGroupSelectionChanged</td>
                          <td>groupSelectionChanged</td>
                        </tr>
                        <tr>
                          <td>onGroupExposureChanged</td>
                          <td>groupExposureChanged</td>
                        </tr>
                        <tr>
                          <td>onRolloutComplete</td>
                          <td>rolloutComplete</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </li>
              </ul>

              <p>
                For advanced topics related to event listeners, see <a href="#changing-event-mappings">changing
                event mapping</a> and <a href="#externally-triggered-interaction">externally triggered interaction</a>.
              </p>
            </section>


            <section id="resizing">
              <h3>Resizing</h3>
              <p>
                If the visualization container element changes its size, the visualization will be scaled proportionally.
                To redraw it from scratch taking the new size into consideration, you will need to explicitly call
                the <code>resize</code> method. Because resizing can be costly, the most common pattern is to listen to
                the window's <code class="nolink">resize</code> event and call FoamTree's <code>resize</code> method
                a while after resizing stops:
              </p>

              <pre class="example">
window.addEventListener("resize", (function() {
  var timeout;
  return function() {
    window.clearTimeout(timeout);
    timeout = window.setTimeout(foamtree.resize, 300);
  };
})());</pre>

              <!-- These hooks are used throughout the code! -->
              <pre class="hidden" id="installResizeHook">
window["_resizeHook"] = (function() {
  var timeout;
  return function() {
    window.clearTimeout(timeout);
    timeout = window.setTimeout(foamtree.resize, 300);
  };
})();
window.addEventListener("resize", window["_resizeHook"]);</pre>

              <pre class="hidden" id="removeResizeHook">
window.removeEventListener("resize", window["_resizeHook"]);
delete window["_resizeHook"];</pre>

              <p>To compare the behavior of visualization with and without the resize listener, resize the browser window once the example is visible.</p>

              <div class="row">
                <div class="col-sm-6">
                  <pre class="partial executable example" data-runbefore="installResizeHook" data-runafter="removeResizeHook">
// With the resize listener installed.
foamtree.on("relaxationStep", function() {
  console.log("Layout update");
});</pre>
                </div>
                <div class="col-sm-6">
                  <pre class="partial executable example">
// Without the resize listener.
foamtree.on("relaxationStep", function() {
  console.log("Layout update");
});</pre>
                </div>
              </div>

              <p>On mobile devices one should resize and redraw the visualization after the orientation of a mobile device changes:</p>

              <pre class="example">
window.addEventListener("orientationchange", function() {
  foamtree.resize();
});</pre>
            </section>


            <section id="image-data">
              <h3>Image data</h3>

              <p>
                You can get the current image of the visualization as a <a href="http://en.wikipedia.org/wiki/Data_URI_scheme">Data URI</a>
                by getting the <code>imageData</code> option. You can then display the image for the user, as show in
                the example below, or <a href="http://updates.html5rocks.com/2011/08/Downloading-resources-in-HTML5-a-download">let
                the user download the image</a>.
              </p>

              <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [
    { label: "Click me to get the image", trigger: true, weight: 5 },
    { label: "Group 1" },
    { label: "Group 2" },
    { label: "Group 3" },
    { label: "Group 3" }
  ]},
  onGroupClick: function (event) {
    if (event.group.trigger) {
      event.preventDefault();
      window.open(foamtree.get("imageData", {
        format: "image/png"
      }));
    }
  }
});</pre>
            </section>


            <section id="printing">
              <h3>Printing</h3>

              <p>
                FoamTree is a regular printable element of the page. You may want to customize the printing style sheets
                to hide non-relevant elements. To get a higher-resolution bitmap for printing, you can increase the
                resolution of the <code>imageData</code> by providing the <code class="nolink">pixelRatio</code>
                parameter:
              </p>

              <pre class="partial executable example">
window.open(foamtree.get("imageData", {
  format: "image/png",
  pixelRatio: 1.5
}));</pre>
            </section>


            <section id="debugging">
              <h3>Debugging</h3>

              <p>
                To minimize the size of the code required at runtime, FoamTree does not verify whether input options
                are valid. During development, however, it is strongly recommended to turn on assertions by including
                the <code>carrotsearch.foamtree.html5.asserts.js</code> file. This will automatically enable assertion
                checking for options passed to the visualization via the <code>set</code> method.
              </p>

              <p>The example below shows invalid values of certain options and how they result in console warnings.</p>
              <pre class="partial executable example">
foamtree.set({
  id: undefined,
  onGroupClick: "fooBar",
  imageData: "newImage.png",
  showZeroWeightGroups: "true",
  groupFillType: "invalid-value",
  unknownOption: 1
});</pre>
            </section>


            <section id="carrot2-models">
              <h3>Carrot<sup>2</sup> data models</h3>

              <p>
                If you are using Carrot<sup>2</sup> or Lingo3G clustering engine, you can convert the JSON and XML data formats
                using the following jQuery snippet.
              </p>

              <pre class="partial executable example requireshttp">
// Convert clusters to groups from Carrot2/Lingo3G JSON format.
function convert(clusters) {
  return clusters.map(function(cluster) {
    return {
      id:     cluster.id,
      label:  cluster.phrases.join(", "),
      weight: cluster.attributes && cluster.attributes["other-topics"] ? 0 : cluster.size,
      groups: cluster.clusters ? convert(cluster.clusters) : []
    }
  });
};

// Clear the previous model.
foamtree.set("dataObject", null);

// Load Carrot2 JSON clusters.
$.ajax({
  url: "../demos/assets/data/carrot2/ben-and-jerry.json",
  dataType: "json",
  success: function(data) {
    foamtree.set({
      dataObject: {
        groups: convert(data.clusters)
      }
    });
  }
});</pre>

              <p>And a similar conversion from the XML format.</p>

              <pre class="partial executable example requireshttp">
// Convert clusters to groups from Carrot2/Lingo3G XML format.
function convert(clusters) {
  return $(clusters).map(function(index, cluster) {
    cluster = $(cluster).detach(); // destroys the model, simplifies processing.
    var subgroups = cluster.children("group").size() > 0 ? convert(cluster.children("group")) : [];
    return {
      id:     cluster.attr("id"),
      label:  cluster.find("group &gt; title &gt; phrase").map(asText).toArray().join(", "),
      weight: cluster.attr("score") ? cluster.attr("score") : 0,
      groups: subgroups
    }
  }).toArray();
};

// Convert a node to text.
function asText(i, e) { return $(e).text(); }

// Clear the previous model.
foamtree.set("dataObject", null);

// Load Carrot2 JSON clusters.

$.ajax({
  url: "../demos/assets/data/carrot2/ben-and-jerry.xml",
  dataType: "xml",
  success: function(data) {
    foamtree.set({
      dataObject: {
        groups: convert($(data).find("searchresult &gt; group"))
      }
    });
  }
});</pre>
            </section>


            <section id="touch-devices">
              <h3>Touch devices</h3>

              <p>
                FoamTree core does not contain support for detecting touch-based events, but delegates this
                to a specialized library. This kind of decoupling allows improvements and bug fixes related to
                touch event  detection to happen independently of FoamTree releases.
              </p>

              <p>
                There are two ways to enable touch device support in FoamTree:
              </p>

              <ul>
                <li>
                  <strong>Include the <a href="http://eightmedia.github.io/hammer.js/" target="_blank">Hammer.js</a>
                  library</strong>. If FoamTree detects that Hammer.js is available,
                  it will use it to detect touch events and trigger the appropriate actions. Use Hammer.js version
                  1.0.6, 1.0.7, 1.0.8 or 1.0.9. FoamTree currently does not support Hammer.js 1.1.x and 2.x lines,
                  but you can use them in the <a href="#externally-triggered-interaction">externally triggered
                  interaction</a> mode.
                </li>

                <li>
                  <strong>Externally triggered interaction</strong>. If you'd like to use a different touch event
                  detection library or your own code, your code can directly
                  <a href="#externally-triggered-interaction">trigger the appropriate events</a>.
                </li>
              </ul>
            </section>
          </section>


          <section id="advanced-use">
            <h1>Advanced usage</h1>

            <section id="default-colors">
              <h3>Default colors</h3>

              <p>
                The default way of assigning colors to groups and labels in a model is the "rainbow" color model.
                The model assigns colors to the first-level groups from the range of hue values defined by the
                <code>rainbowStartColor</code> and <code>rainbowEndColor</code> options. Depending on the value of the
                <code>rainbowColorDistribution</code> options, the colors will be distributed radially or linearly across
                the whole visualization area.
              </p>

              <p>The example below shows a set of groups covering the full spectrum of hues (angles between 0 and 360).</p>
              <pre class="partial executable example">
foamtree.set({
  rainbowStartColor: "hsla(  0, 100%, 50%, 1)",
  rainbowEndColor:   "hsla(360, 100%, 50%, 1)",
  dataObject: {
    groups: (function() {
      var arr = [];
      for (var i = 0; i &lt; 100; i++) {
        arr.push({label: ""});
      }
      return arr;
    })()
  }
});</pre>

              <p>
                Child groups are recursively assigned with colors that introduce a gradient to the
                lightness components of their parent's color, as demonstrated in the example below,
                which shows HSL color values assigned to each group.
              </p>

              <pre class="partial executable example">
function modelGen(subgroups) {
  var arr = [];
  var i;
  for (i = subgroups.pop(); i > 0; i--) {
    arr.push({label: ""});
  }
  if (subgroups.length > 0) {
    for (i = arr.length; --i >= 0;) {
      arr[i].groups = modelGen(subgroups.slice());
    }
  }
  return arr;
}

foamtree.set({
  rainbowStartColor: "hsla(  0, 100%, 50%, 1)",
  rainbowEndColor:   "hsla(360, 100%, 50%, 1)",
  groupColorDecorator: function(opts, params, vars) {
    params.group.label = "" +
              Math.round(vars.groupColor.h) + ", " +
              Math.round(vars.groupColor.s) + "%, " +
              Math.round(vars.groupColor.l) + "%";
  },
    dataObject: modelGen([3, 5, 10, 1])[0]
});</pre>

              <p>
                If the default color model does not suit your needs you can customize group colors to your liking by using
                the <code>groupColorDecorator</code> callback.
              </p>
            </section>


            <section id="custom-colors">
              <h3>Custom colors</h3>

              <p>
                Varying the polygon's color based on some property of the corresponding group can help
                to convey some more information about the data set. For the sake of example, let us
                revisit the visualization of USA Today census data introduced in the
                <a href="#data-model">data model section</a>. The original code used the size (weight)
                of the groups to show how large is the specific ethnic group in the corresponding state.
                The example below additionally visualizes the USA Today diversity index using
                the lightness of the polygon -- the lower the diversity index, the darker the color.
              </p>

              <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [ { label: "loading..." }, { label: "Please wait" } ] },
  fadeDuration: 500
});

$.ajax({
  url: "http://api.usatoday.com/open/census/loc?api_key=nqjr52fpvsu8gs97tgnkyzfx",
  dataType: "jsonp",
  jsonpCallback: "callback",
  success: function(data) {
    var states = data.response;

    var races = [
      { label: "Hispanic", prop: "PctHisp" },
      { label: "White",    prop: "PctNonHispWhite" },
      { label: "Black",    prop: "PctBlack" },
      { label: "Indian",   prop: "PctAmInd" },
      { label: "Asian",    prop: "PctAsian" },
      { label: "Hawaiian", prop: "PctNatHawOth" }
    ];

    var popByRace = states.reduce(function (index, state) {
      races.forEach(function (spec) {
        var pop = state[spec.prop] * state.Pop;
        index[spec.prop].total += pop;
        index[spec.prop].min = Math.min(index[spec.prop].min, state[spec.prop]);
        index[spec.prop].max = Math.max(index[spec.prop].max, state[spec.prop]);
      });
      return index;
    }, races.reduce(function (index, spec) {
         index[spec.prop] = { total: 0, min: Number.MAX_VALUE, max: 0 };
         return index;
       }, { }));

    var groups = races.map(function(spec) {
      return {
        label: spec.label,
        weight: popByRace[spec.prop].total,
        groups: states.map(function(state) {
          return {
            label: state.Placename,
            weight: (state[spec.prop] - popByRace[spec.prop].min) /
                      popByRace[spec.prop].max,

            // Pass the diversity index as an extra property
            diversity: state.USATDiversityIndex
          };
        })
      };
    });

    foamtree.set({
      dataObject: { groups: groups },
      rolloutDuration: 3000,
      groupColorDecorator: function (opts, props, vars) {
        var diversity = props.group.diversity;
        if (diversity) {
          // If diversity is available, use it to
          // vary the lightness of the group.
          // We assume the diversity is in the 0..1 range.
          vars.groupColor.l = diversity * 100;
        }
      }
    });
  }
});</pre>

              <p>
                Please see the documentation of the <code>groupColorDecorator</code> option for more
                color customization examples.
              </p>
            </section>

            <section id="custom-content">
              <h3>Custom content</h3>

              <p>
                If needed, you can draw custom content in each FoamTree polygon. Please see
                the <code>groupContentDecorator</code> option for details and examples. Additionally,
                the <a href="../demos/images.html" target="_blank">images demo</a> shows how to render
                SVG images inside FoamTree polygons and the <a href="../demos/github.html" target="_blank">GitHub
                search demo</a> demonstrates some more advanced custom content layout and rendering.
              </p>
            </section>

            <section id="layout-types">
              <h3>Choosing layout type</h3>

              <p>
                As of version <span class="label label-default">3.3.0</span>, FoamTree can produce both the
                organic-looking polygonal layouts and the traditional rectangular layouts. While the polygon-based
                layout is the default, the rectangular layouts may sometimes be useful. The documentation for
                the <code>layout</code> option summarizes the available arrangements and highlights the possible use
                cases.
              </p>
            </section>

            <section id="large-data-sets">
              <h3>Visualizing large data sets</h3>

              <p>
                Since version <span class="label label-default">3.2.0</span>, FoamTree should be able to <a target="_blank" href="../demos/large.html">visualize
                hierarchies of 100k+ groups with 100+ levels</a> on recent hardware. As of version
                <span class="label label-default">3.3.0</span>, FoamTree can also generate
                <a href="../demos/rectangular.html" target="_blank">traditional rectangular</a>
                treemaps which are significantly faster to compute than the default polygon-based layout.
                The following subsections discuss the performance and visual aspects involved.
              </p>

              <section id="layout-computation-performance" class="notoc">
                <h4>Visualization layout computation performance</h4>

                <p>
                  Before FoamTree can draw anything, it needs to compute the layout based on the input data.
                  An important component of the layout algorithm is determining the positions and areas of polygons
                  in such a way that the areas correspond to group's weights as closely as possible. To achieve
                  a decent representation accuracy, FoamTree needs to iteratively update positions of all polygons
                  until the accuracy reaches the required level. We call this process <em>relaxation</em>.
                </p>

                <div class="alert alert-info">
                  <strong>For the curious</strong>
                  <p>
                    By default, FoamTree performs relaxation off-screen and does not show the intermediate positions of the
                    polygons. To observe what relaxation looks like, you can set the <code>relaxationVisible</code>
                    option to <code>true</code>:
                  </p>

                  <pre class="partial empty executable example">
foamtree.set({
  fadeDuration: 1500,
  dataObject: {
    groups: (function() {
      var arr = [];
      for (var i = 0; i < 80; i++) {
        arr.push({
          label: "",
          weight: Math.pow(Math.random(), 5) +
                  (Math.random() < 0.1 ? Math.random() * 2 : 0)
        });
      }
      return arr;
    })()
  },

  // Show the relaxation
  relaxationVisible: true,

  // Make the relaxation last longer
  relaxationQualityThreshold: 0,
  relaxationMaxDuration: 15000,

  // For faster rendering
  groupFillType: "plain"
});</pre>
                </div>

                <p>
                  To make it possible to browse very large hierarchies, since version 3.2.0 FoamTree defers laying out
                  a group's children until the child groups need to be drawn. With the default value of the
                  <code>maxGroupLevelsDrawn</code> option, FoamTree will eagerly compute the layout for the first
                  4 levels of the hierarchy. Further layouts will be computed on demand as the user opens the top-level
                  groups.
                </p>

                <p>
                  The on-demand computation of layout works very well when the large number of input groups is
                  spread over a balanced tree of a sufficient number of level. If, however, there are individual
                  groups with large numbers of child groups, the layout computation can still take some significant
                  time. You can try some of the following tuning tips to improve the performance in such cases:
                </p>

                <ul>
                  <li>
                    <span class="label label-default">Since 3.2.0</span> <strong>Decrease
                    <code>maxGroupLevelsDrawn</code></strong>. With a lower number of layouts computed up-front, the
                    initial rendering as well as group opening time should be much lower.
                  </li>

                  <li>
                    <strong>Increase <code>relaxationQualityThreshold</code></strong>. Try a number of values, starting from
                    <code>0.5</code> through <code>1.0</code> up to <code>10</code> or so. This will cause FoamTree
                    to perform fewer relaxation iterations and thus improve the layout calculation time. The
                    down side of this kind of optimization is less appealing layout, with a large number of
                    elongated polygons. In extreme cases, you can also try setting <code>relaxationQualityThreshold</code>
                    to <code>Number.MAX_VALUE</code>. In this case, relaxation will be completely disabled. This may be the only
                    way to proceed with very large data sets.
                  </li>

                  <li>
                    <strong>Set <code>relaxationInitializer</code> to <code>ordered</code> or <code>squarified</code></strong>.
                    The treemap-initialized layouts are slightly faster to relax and also lead to more pleasing shapes
                    when the number of relaxation iterations is low or when there is no relaxation at all.
                  </li>

                  <li>
                    <strong>Show relaxation to the user</strong>. In addition to the above tuning, you may want to show
                    the relaxation process to the users, so that they don't see the blank screen while waiting for the
                    visualization to settle. You can do that by setting <code>relaxationVisible</code> to <code>true</code>.
                    Additionally, you can cap the total relaxation time using the <code>relaxationMaxDuration</code>
                    option. The total duration of the relaxation in this mode (assuming there is no cap on duration) will
                    be larger compared to the invisible relaxation mode due to a slightly different relaxation algorithm
                    and time spent on drawing intermediate layouts. However, you will be able to deliver some image to the
                    users more quickly.
                  </li>

                  <li>
                    <strong>Disable rollout and pullback animations.</strong> As the pullback animations move each
                    group in separation, animating thousands will significantly degrade the performance. If your data
                    contains groups with more than several hundreds direct child groups, consider setting
                    <code>rolloutDuration</code> and <code>pullbackDuration</code> to <code>0</code>, which will apply
                    simple fade-in and fade-out effects.
                  </li>

                  <li>
                    <span class="label label-default">Since 3.2.0</span> <strong>Use rectangular layout</strong> by
                    setting <code>layout</code> to <code>ordered</code> or <code>squarified</code>. The rectangular
                    layouts do not need preform relaxation and are therefore much faster to compute.
                  </li>
                </ul>

                <p>
                  The following examples show a 1000-group data set visualized with polygonal and rectangular layouts.

                </p>

                <div class="row">
                  <div class="col-sm-6">
                    <p>
                      Polygonal layout with the squarified treemap initializer and a minimum amount of relaxation.
                    </p>

                <pre class="partial empty executable example">
var time;
foamtree.set({
  fadeDuration: 1500,
  dataObject: {
    groups: randomGroups(1000)
  },

  relaxationInitializer: "squarified",
  relaxationQualityThreshold: 6,

  groupBorderWidth: 2,

  // Measure and report layout time
  onModelChanging: function() {
    time = Date.now();
  },
  onRolloutStart: function() {
    console.log("Polygonal layout took " +
      (Date.now() - time) + " ms.");
  }
});</pre>
                  </div>

                  <div class="col-sm-6">
                    <p>
                      Rectangular layout using the squarified treemap algorithm, relaxation is not performed
                      in this case.
                    </p>

                <pre class="partial empty executable example">
var time;
foamtree.set({
  fadeDuration: 1500,
  dataObject: {
    groups: randomGroups(1000)
  },

  layout: "squarified",
  // relaxation qualiti does not apply here

  groupBorderWidth: 2,

  // Measure and report layout time
  onModelChanging: function() {
    time = Date.now();
  },
  onRolloutStart: function() {
    console.log("Rectangular layout took " +
      (Date.now() - time) + " ms.");
  }
});</pre>
                  </div>
                </div>

              </section>

              <section id="rendering-performance" class="notoc">
                <h4>Visualization rendering performance</h4>

                <p>
                  Another important performance factor is the actual drawing of the visualization image. To achieve
                  highest rendering speeds, FoamTree employs a number of optimizations:
                </p>

                <ul>
                  <li>
                    <p>
                      <span class="label label-default">Since 3.2.0</span> <strong>Drawing only the specified number of
                      group levels</strong>. With a very deeply nested hierarchy and the default value of the <code>parentFillOpacity</code>
                      option only a small number of top layers would be visible. Taking advantage of this, FoamTree does
                      not draw the lower levels of groups until some of their parents gets open for browsing. You can
                      use the <code>maxGroupLevelsDrawn</code> and <code>maxGroupLabelLevelsDrawn</code> options to
                      customize how many levels of group polygons and labels should be drawn.
                    </p>
                  </li>

                  <li>
                    <p>
                      <strong>Incremental updates</strong>. When only part of the visualization image needs to be
                      updated, for example on group hover or selection change, FoamTree tries to perform an
                      <em>incremental redraw</em> in which only the affected area is cleared and drawn again.
                      This significantly speeds up redrawing the visualization, especially for large data sets.
                    </p>

                    <div class="alert alert-warning">
                      <strong>Heads up!</strong>

                      <p>
                        In certain cases, incremental updates are not possible:
                      </p>

                      <ul>
                        <li>when some groups are currently exposed</li>
                        <li>when <code>groupBorderWidth</code> is <code>0</code></li>
                        <li>when <code>groupBorderWidth</code> is less than <code>groupStrokeWidth</code><code>/ 2 + 0.5</code></li>
                        <li>
                          when any group is selected and <code>groupBorderWidth</code> is less than
                          <code>groupSelectionOutlineWidth</code><code>/ 2 + 0.5 +</code><code>groupSelectionOutlineShadowSize</code>
                        </li>
                      </ul>

                      <p>
                        To find out whether the redraw operation was incremental or not, check the first
                        parameter passed to the <code>onRedraw</code> event listener, if the parameter is <code>true</code>,
                        the last rendering operation was an incremental one.
                      </p>

                      <p>
                        The following example sets up the <code>onRedraw</code> listener to report on the type of redraws
                        FoamTree is performing. Try interacting with the visualization and watch the console to see
                        when incremental redraws are possible.
                      </p>

                      <pre class="partial empty executable example">
foamtree.set({
  groupBorderRadius: 0,
  dataObject: { groups: [
    {
      label: "Click to unexpose and reset options\
              [will enable incremental draws]",
      action: "reset"
    },
    {
      label: "Click to expose\
              [will disable incremental draws]",
      action: "expose"
    },
    {
      label: "Click to set groupBorderWidth to 0\
              [will disable incremental draws]",
      action: "border-width"
    },
    {
      label: "Click to set groupStrokeWidth to 10\
              [will disable incremental draws]",
      action: "stroke-width"
    }
  ]},
  onRedraw: function (incremental) {
    console.log((incremental ? "Incremental" : "Full") + " redraw");
  },
  onGroupDoubleClick: function(event) {
    event.preventDefault();
  },
  onGroupClick: function (event) {
    var action = event.group.action;
    if (action) {
      event.preventDefault();
      switch (action) {
      case "reset":
        foamtree.expose([]).then(function() {
          foamtree.set({
            groupBorderWidth: 4,
            groupStrokeWidth: 1.5
          });
          foamtree.redraw();
        });
        break;

      case "expose":
        foamtree.expose(event.group);
        break;

      case "border-width":
        foamtree.set("groupBorderWidth", 0);
        foamtree.redraw();
        break;

      case "stroke-width":
        foamtree.set("groupStrokeWidth", 10);
        foamtree.redraw();
        break;
      }
    }
  }
});</pre>
                    </div>
                  </li>

                  <li>
                    <p>
                      <strong><em>Wireframe</em> and <em>final</em> rendering quality</strong>.
                      When animating the visualization, either during rollout or in response to user
                      actions, FoamTree will switch to the <em>wireframe</em> rendering mode. Depending
                      on the size of the data set, wireframe rendering may disable certain expensive to draw
                      elements, such as group gradients, shadows, stokes or labels.
                      As soon as the animation stops, FoamTree will switch back to the <em>final</em> rendering quality
                      and show the visualization with all the details.
                    </p>

                    <p>
                      You can influence the amount of details drawn in both modes by changing the
                      <code>wireframeDrawMaxDuration</code>, <code>finalCompleteDrawMaxDuration</code> and
                      <code>finalIncrementalDrawMaxDuration</code> options. On high-DPI displays, you can also
                      set separate pixel densities for the final and wireframe images using the
                      <code>pixelRatio</code> and <code>wireframePixelRatio</code> options, respectively.
                    </p>
                  </li>

                  <li>
                    <p>
                      <strong>Caching of geometry information</strong>. If the geometry of the layout has not changed
                      between redraws, which is the case when zooming and panning, FoamTree will be able to e.g. avoid
                      re-fitting of the label's text into the polygon.
                    </p>
                  </li>
                </ul>

                <p>
                  While FoamTree tries to automatically adjust the level of detail to match the size of the data
                  set and the device speed, you can apply some of tuning described below to further improve
                  the animation smoothness and rendering time:
                </p>

                <ul>
                  <li>
                    Decrease <code>maxGroupLevelsDrawn</code> and <code>maxGroupLabelLevelsDrawn</code>.
                  </li>

                  <li>
                    Decrease the values of the <code>wireframeDrawMaxDuration</code>,
                    <code>finalCompleteDrawMaxDuration</code> and <code>finalIncrementalDrawMaxDuration</code> options,
                    possibly to zero.
                  </li>

                  <li>
                    Set <code>groupFillType</code> to <code>plain</code>.
                  </li>

                  <li>
                    Set <code>groupStrokeType</code> to <code>none</code>.
                  </li>

                  <li>
                    Set <code>wireframeLabelDrawing</code> to <code>never</code>.
                  </li>
                </ul>
              </section>

              <section id="deep-hierarchies" class="notoc">
                <h4>Visualizing very deep hierarchies</h4>

                <p>
                  When visualizing hierarchies with 5 or more levels with default option values it may happen
                  that lower-level groups or branches are not rendered at all because there is not enough space
                  in the parent group's polygons. The following tips will help you to ensure that as many groups
                  as possible are rendered:
                </p>

                <ul>
                  <li>
                   Decrease <code>groupMinDiameter</code> to <code>0</code>, so that FoamTree keeps
                    laying out child groups until the floating point computation precision limit is reached.
                  </li>

                  <li>
                    Decrease <code>groupBorderWidth</code> and <code>groupInsetWidth</code> to allow
                    more space for the child groups.
                  </li>

                  <li>
                    Set <code>groupBorderRadius</code> to <code>0</code>, for deeply-nested hierarchies
                    rounded borders may look distorted.
                  </li>
                </ul>
              </section>
            </section>


            <section id="lazy-loading">
              <h3>Lazy loading</h3>

              <p>
                With FoamTree 3.2.0 and later it is possible to defer the loading of data for lower levels
                of the hierarchy until the user opens the corresponding parent group. The <a
                href="../demos/lazy-loading.html" target="_blank">lazy loading code example</a> demonstrates this approach.
              </p>
            </section>

            <section id="changing-event-mappings">
              <h3>Changing default event mappings</h3>

              <p>
                If you would like to change the <a href="#interaction">default event to action mappings</a>,
                you can do so by registering a listener for the appropriate low-level event, such as
                <code>onGroupClick</code>, that would prevent the default behavior and perform the desired one.
              </p>


              <p>
                The following example restores the FoamTree 2.0.x default double click interaction, which
                was to open the group on double click or <span class="key">Shift</span> + click and
                close the group on <span class="key">Ctrl</span> + <span class="key">Shift</span> + click.
              </p>

              <pre class="partial executable example">
foamtree.set("onGroupDoubleClick", function(event) {
  event.preventDefault();
  this.open(event.group);
});

foamtree.set("onGroupClick", function(event) {
  if (event.shiftKey) {
    event.preventDefault();
    this.open({
      groups: event.ctrlKey ? event.bottommostOpenGroup : event.group,
      open: !event.ctrlKey
    });
  }
});</pre>

              <p>
                The following example shows how to prevent the visualization from resetting
                the view when the <span class="key">Esc</span> key is pressed.
              </p>

              <pre class="partial executable example">
foamtree.set("onKeyUp", function(event) {
  if (event.keyCode === 27) {
    event.preventDefault();
  }
});</pre>

              <p>
                Finally, the example below exposes the group the user is hovering on rather than
                simply highlighting it. The example changes the exposure parameters a little
                to make the interaction smoother.
              </p>

              <pre class="partial empty executable example">
foamtree.set({
  onGroupHover: (function() {
    var timeout;
    return function(event) {
      event.preventDefault();
      window.clearTimeout(timeout);
      timeout = window.setTimeout(function() {
        foamtree.expose(event.group);
      }, 500);
    };
  })(),
  exposeDuration: 500,
  groupExposureScale: 1.1,
  groupExposureZoomMargin: 0.4,

  fadeDuration: 1500,
  dataObject: {
    groups: (function() {
      var arr = [];
      for (var i = 0; i < 100; i++) {
        arr.push({
          label: "",
          weight: 0.1 + Math.random() +
                  (Math.random() < 0.2 ? Math.random() * 3 : 0)
        });
      }
      return arr;
    })()
  }
});</pre>
            </section>


            <section id="externally-triggered-interaction">
              <h3>Externally triggered interaction</h3>

              <p>
                You can completely override FoamTree's internal
                event capture layer and substitute it with your own code if needed.
                One typical use case is when you need to support a non-standard
                mobile device for which FoamTree's internal event capture
                does not work very well.
              </p>

              <p>
                The general pattern for externally triggered interaction is to set the
                <code>interactionHandler</code> option to <code>external</code>, set up
                your own event capture code (using some of the available libraries, such
                as <a href="http://eightmedia.github.io/hammer.js/">Hammer.js</a> or
                <a href="https://github.com/mudcube/Event.js">Event.js</a> and trigger
                the appropriate FoamTree actions using the <code>trigger</code> method.
                Please see the <a href="../demos/external-interaction.html">external-interaction.html</a>
                demo for a complete example.
              </p>
            </section>
          </section>


          <section id="utilities">
            <h1>Utilities</h1>

            <p>
              FoamTree comes with a number of utility scripts that add some extra functionality
              to the core library. The utilities come as Apache License 2.0 source code, feel free
              to modify the code to suit your needs. If you don't need to use the utilities, you can still
              take a look at the source code for some examples of advanced usage of FoamTree API.
            </p>

            <section id="loading-indicator">
              <h2>Loading indicator</h2>

              <p>
                Loading of data for the visualization but also computation of the
                diagram can take a while for larger data sets. You can use the
                <code>carrotsearch.foamtree.util.loading.js</code> utility to show a simple
                <em>Loading...</em> message to the user. Please see the source code of the
                <a href="../demos/loading.html" target="_blank">loading.html</a> example page for
                usage information.
              </p>
            </section>

            <section id="hints">
              <h2>Interaction hints and guide</h2>

              <p>
                To help the users to discover all the ways in which they can interact
                with FoamTree, you can use the <code>carrotsearch.foamtree.util.hints.js</code>
                utility. It will show contextual suggestions on
                how to browse the data (only on desktop browser) and also a guide to all
                possible interactions and keyboard bindings. Please see the source code of the
                <a href="../demos/hints.html" target="_blank">hints.html</a> example page for
                usage information.
              </p>
            </section>

            <section id="relaxation-progress-indicator">
              <h2>Relaxation progress indicator</h2>

              <p>
                If FoamTree is set to show layout relaxation using the
                <code>relaxationVisible</code> option, you can use the
                <code>carrotsearch.foamtree.util.relaxationprogress.js</code> utility to
                show the progress of the process. Please see the source code of the
                <a href="../demos/relaxation-progress.html" target="_blank">relaxation-progress.html</a>
                example page for usage information.
              </p>
            </section>
          </section>


          <section id="data-structures">
            <div class="page-header"><h1>Data structures</h1></div>

            <p>
              Certain data structures listed below are common to many methods and options of FoamTree API.
            </p>

            <section id="individual-group-selector">
              <h2>Individual group selector</h2>

              <p>
                Resolves to one and only one of the groups provided in the <code>dataObject</code>. A number
                of read-only options, such as <code>geometry</code>, require an individual group selector
                as an argument.
              </p>

              <p>
                Individual groups can be designated by:
              </p>

              <ul>
                <li>
                  <p>
                    <strong>Group identifier</strong>, but only if identifiers are provided in the <code>dataObject</code>:
                  </p>

                  <pre class="partial executable example">
console.log(foamtree.get("geometry", "1"));</pre>
                </li>

                <li>
                  <p>
                    <strong>Group object reference</strong>:
                  </p>

                  <pre class="partial executable example">
var groups = foamtree.get("dataObject").groups;
console.log(foamtree.get("geometry", groups[0]));</pre>
                </li>
              </ul>
            </section>

            <section id="multiple-group-selector" style="margin-top: 40px">
              <h2>Multiple group selector</h2>

              <p>
                Resolves to zero or more of the groups provided in the <code>dataObject</code>. Many options
                and methods, such as <code>selection</code>, require a multiple group selector as a value.
              </p>

              <p>
                Multiple groups can be designated by:
              </p>

              <ul>
                <li>
                  <p>
                    <strong>Individual group selector</strong>:
                  </p>

                  <pre class="partial executable example">
foamtree.set("selection", "1");</pre>
                </li>

                <li>
                  <p>
                    <strong>Array of individual group selectors</strong>. Both id- and reference-based
                    selectors can be mixed in one array:
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline">
var groups = foamtree.get("dataObject").groups;
foamtree.set("selection", [ "1", groups[1] ]);</pre>
                </li>

                <li>
                  <p>
                    <strong>Object</strong> with the <code>groups</code> property containing an individual group
                    selector or an array of selectors. Certain methods, such as <code>select</code>, use a
                    number of additional properties provided in the object, such as <code>selected</code> or
                    <code>keepPrevious</code>.
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline" data-runafter="clearTimeout">
foamtree.set("selection", { groups: "1" });
var timeout = window.setTimeout(function() {
  foamtree.set("selection", { groups: "2", keepPrevious: true });
}, 1500);</pre>
                </li>

                <li>
                  <p>
                    <strong>Special object</strong> <code>{ all: true }</code> that resolves to
                    all groups from the <code>dataObject</code>:
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline">
foamtree.set("selection", { all: true });</pre>

                  <p>
                    Also the special object can contain additional properties interpreted by specific methods:
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline">
foamtree.set("selection", { groups: "1" });
var timeout = window.setTimeout(function() {
  foamtree.set("selection", { all: true, selected: false });
}, 1500);</pre>
                </li>

                <li>
                  <p>
                    The <strong>null</strong> or <strong>undefined</strong> value that resolve to an empty group array.
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline">
foamtree.set("exposure", { groups: "1" });
var timeout = window.setTimeout(function() {
  foamtree.set("exposure", null);
}, 1500);</pre>
                </li>
              </ul>
            </section>

            <section id="event-listener">
              <h2>Event listener function</h2>

              <p>
                You can <a href="#visualization-events">register listener functions</a> to receive notifications of
                various FoamTree events. Depending on the type of the listener, the function may be called with one
                or more parameters. Please see the documentation for the specific event for a list of parameters.
              </p>

              <p>
                In case of low-level interaction events, such as <code>onGroupClick</code>, the listener will be
                called with one parameter &ndash; the <a href="#event-details">event details object</a>.
                It is possible to prevent the default behaviour associated with that interaction (group selection
                in case of the <code>onGroupClick</code> event). To prevent the default behaviour,
                return <code>false</code> or call the <code>event.preventDefault()</code> method in any of the
                listeners registered for the event.
              </p>

              <p>
                In the context of all listeners, the <code>this</code> variable is a reference to the involved
                FoamTree instance.
              </p>
            </section>

            <section id="event-details">
              <h2>Event details object</h2>

              <p>
                Low-level interaction events, such as <code>onGroupClick</code>, will receive an event object
                as the first parameter. The object contains the following properties:
              </p>

              <dl class="dl-horizontal x-wide">
                <dt>type</dt>
                <dd>
                  the type of the event, such as <code>click</code> or <code>dragstart</code>
                </dd>

                <dt>group</dt>
                <dd>
                  a reference to the data object corresponding to the
                  group over which the event was triggered
                </dd>

                <dt>topmostClosedGroup</dt>
                <dd>
                  an alias to the <code>group</code> property
                </dd>

                <dt>bottommostOpenGroup</dt>
                <dd>
                  a reference to the data object corresponding
                  to the closest open parent of the group over which the event was triggered
                </dd>

                <dt>x, y</dt>
                <dd>
                  coordinates of the point over which the event was triggered. The coordinates
                  are <strong>relative to the visualization container element</strong>.
                </dd>

                <dt>secondary</dt>
                <dd>
                  <code>true</code> if the event was triggered by the right mouse button
                  or a two-finger gesture on touch devices.
                </dd>

                <dt>touches</dt>
                <dd>
                  the number of touches involved in the gesture. On non-touch devices,
                  always equal to <code>1</code>.
                </dd>

                <dt>scale</dt>
                <dd>
                  the scale factor associated with the event. Meaningful only for the
                  <code>onGroupTransform</code> and <code>onGroupTransformEnd</code> events, for
                  other events the scale is <code>1</code>.
                </dd>

                <dt>delta</dt>
                <dd>
                  the direction in which the mouse wheel was rotated. Positive values
                  mean the upwards rotation, negative values mean downwards rotation.
                  Meaningful only for the <code>onGroupMouseWheel</code> event, equal to
                  <code>0</code> for other events.
                </dd>

                <dt>ctrlKey</dt>
                <dd><code>true</code> if the Ctrl key was pressed during the event</dd>

                <dt>altKey</dt>
                <dd><code>true</code> if the Alt key was pressed during the event</dd>

                <dt>metaKey</dt>
                <dd><code>true</code> if the meta key was pressed during the event</dd>

                <dt>shiftKey</dt>
                <dd><code>true</code> if the Shift key was pressed during the event</dd>

                <dt id="preventDefault">preventDefault</dt>
                <dd>
                  a function that can be called to prevent the
                  default FoamTree action, such as group selection on mouse click,
                  associated with the event.
                </dd>

                <dt id="preventOriginalEventDefault">preventOriginalEventDefault</dt>
                <dd>
                  a function that can be called to prevent the
                  default browser's action, such as page scrolling on mouse wheel,
                  associated with the original event.
                </dd>

                <dt id="allowOriginalEventDefault">allowOriginalEventDefault</dt>
                <dd>
                  a function that can be called to allow the
                  default browser's action associated with the original event. The default
                  behaviour of FoamTree is to prevent browser's actions for the
                  mouse wheel and touch events to make it possible to use them
                  for visualization interactions. You can restore the default browser's
                  actions by calling this method as shown in the
                  <a href="../demos/scrolling.html">scrollable content example</a>.
                </dd>
              </dl>

              <p>
                For the description of the event objects of non-low-level events, please see the documentation
                of the specific event.
              </p>
            </section>

            <section id="promise">
              <h2>Promise</h2>

              <p>
                JavaScript promises are an elegant way of getting access to the result of an action that completes
                asynchronously at some point in future. A very simple example of such a result is the animation
                completing a certain time after it was initiated.
              </p>

              <p>
                FoamTree methods that complete asynchronously, such as <code>expose</code>, return a
                <em>promise</em>: a JavaScript object with the <code>then</code> method. Using that method you
                can register one or more callbacks that will be called when the future action completes.
              </p>

              <p>
                For examples of promises in use, please see the descriptions of the <code>open</code> and
                <code>expose</code> methods.
              </p>
            </section>
          </section>


          <section id="methods">
            <div class="page-header"><h1>Methods</h1></div>

            <section id="get" class="api" data-since="3.0.0">
              <h3>get(*)</h3>

              <dl class="dl-horizontal">
                <dt>get()</dt>
                <dd>
                  <p>
                    Returns an object containing current values of all options. Properties of the returned object
                    correspond to option names, values are option values.
                  </p>

                  <pre class="partial executable example">
console.log(foamtree.get());</pre>
                </dd>

                <dt>get(option)</dt>
                <dd>
                  <p>
                    Returns the current value of the requested <code>option</code>. If the provided
                    string does not correspond to any option name, the result is undefined.
                  </p>

                  <pre class="partial executable example">
console.log(foamtree.get("dataObject"));</pre>
                </dd>

                <dt>get(option, args...)</dt>
                <dd>
                  <p>
                    Returns the current value of the requested read-only <code>option</code>, parameterized by the
                    provided <code>args</code>. The example below retrieves information about the <code>geometry</code>
                    of the group with id <code>1</code>. The second argument causes FoamTree to return full
                    geometry data, including coordinates of the polygon's vertices.
                  </p>

                  <pre class="partial executable example">
console.log(foamtree.get("geometry", "1", true));</pre>
                </dd>
              </dl>
            </section>

            <section id="set" class="api" data-since="3.0.0">
              <h3>set(*)</h3>

              <dl class="dl-horizontal">
                <dt>set(option, value)</dt>
                <dd>
                  <p>
                    Sets the provided <code>option</code> to the desired <code>value</code>. If the provided
                    <code>option</code> string does not correspond to any option, the call is ignored.
                  </p>

                  <pre class="partial executable example">
foamtree.set("exposure", "1");</pre>
                </dd>

                <dt>set(options)</dt>
                <dd>
                  <p>
                    Sets new values for all options included in the provided <code>options</code> object.
                    Properties of the object should correspond to attribute names, values of the object
                    will be treated as values to set. Any properties of the options object that do
                    not correspond to any attributes of the visualization will be ignored.
                  </p>

                  <pre class="partial executable example">
foamtree.set({
  exposure: "1",
  selection: "1",
  groupSelectionOutlineColor: "red"
});</pre>
                </dd>
              </dl>

              <div class="alert alert-info">
                <strong>Heads up!</strong>

                <p>
                  For the changes of visual options to take effect, you will need to explicitly
                  call the <code>redraw</code> method:
                </p>

                <pre class="partial executable example">
foamtree.set({
  rainbowStartColor: "#f00",
  rainbowEndColor: "#aa0"
});
foamtree.redraw();</pre>
              </div>
            </section>

            <section id="on" class="api" data-since="3.0.0">
              <h3 data-alt="on()">on(type, listener)</h3>

              <p>
                Registers a listener for a FoamTree <a href="#events">event</a>.  As opposed to using the <code>set</code> method,
                the <code>on</code> method preserves the previously registered listeners.
              </p>

              <p>
                The <code>on</code> method requires two parameters:
              </p>

              <dl class="dl-horizontal">
                <dt>type</dt>
                <dd>
                  <p>
                    A string that specifies which event to listen to. To get type string to use with
                    this method, take the event option name, remove the leading "on" and lower-case the first letter.
                    For example, the type string corresponding to the <code>onGroupSelectionChanged</code> event is
                    <code>groupSelectionChanged</code>.
                  </p>
                </dd>

                <dt>listener</dt>
                <dd>
                  <p>
                    The <a href="#event-listener">event listener function</a> to invoke when the event is triggered.
                  </p>
                </dd>
              </dl>

              <p>
                The following examples registers to receive selection events and exposes the groups
                that have just been selected. Additionally, the code registers another listener that prevents
                the default interaction (expose) on double click. Notice that the <code>this</code> variable is a reference
                to the FoamTree instance inside the callback function and can be used to invoke other methods.
              </p>

              <pre class="partial executable example">
foamtree.on("groupSelectionChanged", function (event) {
  // "this" is the reference to FoamTree instance here.
  // Expose the groups that have just been selected.
  this.expose(event.groups);
});

// Prevent the default action (expose) on double click
foamtree.on("groupDoubleClick", function (event) {
  event.preventDefault();
});</pre>

              <p>
                Please see the <a href="#visualization-events">Visualization events</a> section for more code examples
                and the <a href="#event">Events</a> section for a list of all available events.
              </p>
            </section>

            <section id="off" class="api" data-since="3.0.0">
              <h3 data-alt="off()">off(type, listener)</h3>

              <p>
                Removes the requested <code>listener</code> from the list of listeners of the specified <code>type</code>.
                As opposed to using the <code>set</code> method, this method will preserve the other listeners
                registered for the event.
              </p>

              <p>
                The <code>off</code> method requires two parameters:
              </p>

              <dl class="dl-horizontal">
                <dt>type</dt>
                <dd>
                  <p>
                    A string that specifies which event to remove the listener from. To get type string to use with
                    this method, take the event option name, remove the leading "on" and lower-case the first letter.
                    For example, the type string corresponding to the <code>onGroupSelectionChanged</code> event is
                    <code>groupSelectionChanged</code>.
                  </p>
                </dd>

                <dt>listener</dt>
                <dd>
                  <p>
                    The <a href="#event-listener">event listener function</a> to remove.
                  </p>
                </dd>
              </dl>

              <p>
                The following example defines the <code>once</code> function that notifies the listener
                only about the first occurrence of the event. After the listener gets called, the function
                removes itself from the list of listeners using the <code>off</code> method, so that
                the listener is not called when further events of this type get triggered. Notice how the
                selection change listener registered using the <code>once</code> function gets called only
                for the first selection change.
              </p>

              <pre class="partial executable example">
var once = function (type, listener) {
  foamtree.on(type, function onceListener() {
    this.off(type, onceListener);
    return listener.apply(this, arguments);
  });
};

once("groupSelectionChanged", function (event) {
  window.console.log("Selection changed for the first time. Further selection changes will not call this function.")
});</pre>
            </section>

            <section id="redraw" class="api" data-since="3.0.0">
              <h3>redraw(animated, groups)</h3>

              <p>
                Triggers a complete redraw of the visualization. If one or more visual options of the
                visualization have been changed using the <code>set</code> method, the changes will not
                be visible until the visualization is redrawn, either explicitly using this method or
                in response to user actions.
              </p>

              <p>
                This method accepts the following parameters:
              </p>

              <dl class="dl-horizontal">
                <dt>animated</dt>
                <dd>
                  (optional) if <code>true</code>, FoamTree will assume that this redraw is part of an animation and may
                  be followed by further redraws. In such cases, depending on the size of the data, FoamTree may
                  switch to the wireframe rendering mode. The default value of this parameter is <code>false</code>.
                </dd>

                <dt>groups</dt>
                <dd>
                  <span class="label label-default">Since 3.1.0</span> (optional) a suggestion which groups need redrawing. If defined, instead of redrawing all groups,
                  FoamTree may redraw only the groups indicated by the provided <a href="#individual-group-selector">individual</a>
                  or <a href="#multiple-group-selector">multiple groups selector</a>. Please note that in certain cases,
                  such as when the layout of the groups changes, FoamTree may still redraw all groups and not just
                  the ones provided in this parameters. Default value of this parameter is <code>undefined</code>, which
                  means FoamTree will always redraw all groups.
                </dd>
              </dl>

              <p>
                The cost of the redraw operation depends on the size of the model and the specific values
                of certain options. Please see the <a href="#rendering-performance">Visualization rendering performance</a>
                section for more details.
              </p>
            </section>

            <section id="resize" class="api" data-since="3.0.0">
              <h3>resize()</h3>

              <p>
                If the size of the HTML container element has changed, resizes and redraws the visualization to
                accommodate to the new size. See the <a href="#resizing">Resizing</a> section for code
                snippets related to this function.
              </p>

              <p>
                If the <code>relaxationVisible</code> option is set to <code>true</code>,
                calling this method will trigger a complete relaxation of the layout to accommodate it
                to the new container dimensions. As with the initial relaxation, the resize-triggered relaxation
                follows the settings provided by the <code>relaxationMaxDuration</code> and <code>relaxationQualityThreshold</code>
                options.
              </p>

              <p>
                The following example makes the relaxation visible, try resizing the browser window
                to see how relaxation is started again after the container dimensions change.
              </p>

              <pre class="partial empty executable example" data-runbefore="installResizeHook" data-runafter="removeResizeHook">
foamtree.set({
  fadeDuration: 1500,
  dataObject: {
    groups: (function() {
      var arr = [];
      for (var i = 0; i < 100; i++) {
        arr.push({
          label: "",
          weight: 0.1 + Math.random() +
                  (Math.random() < 0.2 ? Math.random() * 3 : 0)
        });
      }
      return arr;
    })()
  },

  relaxationInitializer: "random",
  relaxationVisible: true,
  relaxationQualityThreshold: 0,
  relaxationMaxDuration: 8000
});</pre>
            </section>

            <section id="update" class="api" data-since="3.1.0">
              <h3>update()</h3>

              <p>
                Updates the visualization to reflect changes in group weights. If you change the values of the
                <code>weight</code> property of some group, you need to call this method to see the updated
                visualization.
              </p>

              <p>
                While updating the visualization, FoamTree will respect the relaxation and weight growing options.
                For example, to see the process of visualization update, you can set <code>relaxationVisible</code>
                to <code>true</code>. Additionally, you ma want to set <code>groupGrowingDuration</code> to
                a non-zero value to animate the weight transition.
              </p>

              <p>
                <strong>Note: </strong> currently, only updating weights of existing groups is supported. Hierarchy
                changes, such as adding or removing groups, cannot be performed using this method.
                The only way to visualize an updated hierarchy is to set a new value for the <code>dataObject</code>
                option.
              </p>

              <p>
                The following example increases a group's weight on left-click and decreases the weight on right-click.
                Additionally, the example sets <code>relaxationVisible</code> to <code>true</code> and
                <code>groupGrowingDuration</code> to <code>1000</code> to animate the weight transitions.
              </p>

              <pre class="partial empty executable example" data-runbefore="installResizeHook"
                   data-runafter="removeResizeHook">
foamtree.set({
  fadeDuration: 1500,
  dataObject: largeDataSet,

  // Make relaxation and group size changes animated
  relaxationVisible: true,
  relaxationQualityThreshold: 0.5,
  relaxationMaxDuration: 8000,
  groupGrowingDuration: 1000,

  // Modify group's weight on click
  onGroupClick: function (e) {
    e.preventDefault();

    // On left-click, increase the weight,
    // decrease on right click.
    e.group.weight *= (e.secondary ? 0.5 : 1.5);

    // Update the visualization
    foamtree.update();
  }
});</pre>
            </section>

            <section id="select" class="api" data-since="3.0.0">
              <h3 data-alt="select()">select(groups)</h3>

              <p>
                Changes the group selection. The <code>groups</code> parameter must be a
                <a href="#multiple-group-selector">multiple group selector</a> designating the groups to select or
                deselect:
              </p>

              <ul>
                <li>
                  <p>
                    If the selector is an <strong>individual selector</strong> or an <strong>array of individual
                    selectors</strong>, the designated groups will be selected, the selection of other groups
                    will remain unaffected.
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline" data-runafter="clearTimeout">
foamtree.select("1");
var timeout = window.setTimeout(function() {
  foamtree.select("2");
}, 1500);</pre>
                </li>

                <li>
                  <p>
                    If the <strong>selector is an object</strong>, two additional properties are supported, apart from the common
                    <code>groups</code> and <code>all</code> properties:
                  </p>

                  <dl class="dl-horizontal">
                    <dt>selected</dt>
                    <dd>
                      If <code>true</code> or not provided, the designated groups will get selected.
                      If <code>false</code>, the designated groups will be deselected.
                    </dd>

                    <dt>keepPrevious</dt>
                    <dd>
                      If <code>true</code> or not provided, only the selection of the designated groups will be altered.
                      If <code>false</code>, the selection of the designated groups will be altered,
                      the other groups will get unselected.
                    </dd>
                  </dl>

                  <p>
                    There are two ways to clear the selection:
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline" data-runafter="clearTimeout">
foamtree.select(["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.select({ groups: [], keepPrevious: false });
}, 2000);</pre>

                  <p>
                    or:
                  </p>

                  <pre class="partial executable example" data-runbefore="redSelectionOutline" data-runafter="clearTimeout">
foamtree.select(["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.select({ all: true, selected: false });
}, 2000);</pre>
                </li>
              </ul>

              <p>
                <strong>Note: </strong> when selection is changed using this method, the event listeners
                will not be called.
              </p>
            </section>

            <section id="expose" class="api" data-since="3.0.0">
              <h3 data-alt="expose()">expose(groups)</h3>

              <p>
                Changes the set of exposed groups. The <code>groups</code> parameter must be a
                <a href="#multiple-group-selector">multiple group selector</a> designating the groups to expose or unexpose:
              </p>

              <ul>
                <li>
                  <p>
                    If the selector is an <strong>individual selector</strong> or an <strong>array of individual
                    selectors</strong>, the designated groups will be exposed, all other groups will get unexposed.
                  </p>

                  <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.expose("1");
var timeout = window.setTimeout(function() {
  foamtree.expose("2");
}, 2000);</pre>

                  <p>
                    The following example shows how to unexpose all groups.
                  </p>

                  <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.expose(["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.expose([]);
}, 2000);</pre>

                  <p>
                    A similar effect could be achieved using the <code>reset</code> method.
                  </p>
                </li>

                <li>
                  <p>
                    If the <strong>selector is an object</strong>, two additional properties are supported, apart from the common
                    <code>groups</code> and <code>all</code> properties:
                  </p>

                  <dl class="dl-horizontal">
                    <dt>exposed</dt>
                    <dd>
                      If <code>true</code> or not provided, the designated groups will get exposed.
                      If <code>false</code>, the designated groups will be unexposed.
                    </dd>

                    <dt>keepPrevious</dt>
                    <dd>
                      If <code>true</code>, only the exposure of the designated groups will be altered.
                      If <code>false</code> or not provided, the exposure of the designated groups will be altered,
                      the other groups will get unexposed.
                    </dd>
                  </dl>

                  <p>
                    The following example uses the <code>keepExpose</code> property of the group selector
                    to expose one more group in addition to the already exposed ones. Notice that if the parent
                    group of the group to be exposed is closed (groups 3 and 4 in the example), the parents will
                    be automatically opened as part of the exposure process.
                  </p>

                  <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.expose(["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.expose({ groups: ["3.1", "4.1"], keepPrevious: true });
}, 2000);</pre>
                </li>
              </ul>

              <p>
                The expose method returns a <a href="#promise">promise</a> that gets resolved when
                the exposure animation completes.
                The following example exposes one of the groups by calling the <code>expose</code> method
                and registers two callbacks to be notified when the animation completes. To make the result
                easier to observe, we increase the duration of the expose animation a bit.
              </p>

              <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("exposeDuration", 2000);
var timeout = window.setTimeout(function() {
  foamtree.expose(foamtree.get("dataObject").groups[0])
    .then(function () {
      window.console.log("Expose animation complete");
    })
    .then(function () {
      window.console.log("Another callback");
    });
}, 1000);</pre>

              <p>
                <strong>Note: </strong> when exposure is changed using this method, the event listeners
                will not be called.
              </p>

              <p>
                <strong>Note: </strong> there are some <a href="#api-triggered-exposure-with-visible-releaxation">limitations
                when relaxation is visible</a>.
              </p>
            </section>

            <section id="open_method" class="api" data-since="3.0.0">
              <h3 data-alt="open()">open(groups)</h3>

              <p>
                Changes the set of open groups. The <code>groups</code> parameter must be a
                <a href="#multiple-group-selector">multiple group selector</a> designating the groups to open or close:
              </p>

              <ul>
                <li>
                  <p>
                    If the selector is an <strong>individual selector</strong> or an <strong>array of individual
                    selectors</strong>, the designated groups will get open, the state of the other groups
                    will remain unchanged.
                  </p>

                  <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.open("1");
var timeout = window.setTimeout(function() {
  foamtree.open("2");
}, 2000);</pre>
                </li>

                <li>
                  <p>
                    If the <strong>selector is an object</strong>, two additional properties are supported, apart from the common
                    <code>groups</code> and <code>all</code> properties:
                  </p>

                  <dl class="dl-horizontal">
                    <dt>open</dt>
                    <dd>
                      If <code>true</code> or not provided, the designated groups will get open.
                      If <code>false</code>, the designated groups will be closed.
                    </dd>

                    <dt>keepPrevious</dt>
                    <dd>
                      If <code>true</code> or not provided, only the state of the designated groups will be altered.
                      If <code>false</code>, the state of the designated groups will be altered,
                      the other groups will get closed.
                    </dd>
                  </dl>

                  <p>
                    To close all groups, you can use the selector with the <code>all</code> property:
                  </p>

                  <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.open(["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.open({ all: true, open: false });
}, 2000);</pre>
                </li>
              </ul>

              <p>
                The <code>open</code> method returns a <a href="#promise">promise</a> that gets resolved when
                the state transition animation completes.
                The following example opens one of the groups by calling the <code>open</code> method
                and registers two callbacks to be notified when the animation completes. To make the result
                easier to observe, we increase the duration of the opening animation a bit.
              </p>

              <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("openCloseDuration", 2000);
var timeout = window.setTimeout(function() {
  foamtree.open(foamtree.get("dataObject").groups[0])
    .then(function () {
      window.console.log("Open animation complete");
    })
    .then(function () {
      window.console.log("Another callback");
    });
}, 1000);</pre>

              <p>
                <strong>Note: </strong> when open state is changed using this method, the event listeners
                will not be called.
              </p>
            </section>

            <section id="zoom" class="api" data-since="3.2.0">
              <h3 data-alt="zoom()">zoom(group)</h3>

              <p>
                Zooms the visualization to show the specified group. The <code>group</code> parameter must be an
                <a href="#individual-group-selector">individual group selector</a> designating the group to zoom to.
                You can also zoom to the <code>dataObject</code> group, in which case the whole visualization area
                will be shown.
              </p>

              <p>
                The speed and easing of the zoom transition are controlled by the
                <code>zoomMouseWheelDuration</code> and <code>zoomMouseWheelEasing</code> options.
                The <code>zoom</code> method returns a <a href="#promise">promise</a> that gets resolved
                when the zooming animation completes.
              </p>

              <p>
                The following example replaces the default action performed on double click (expose) with
                plain zooming into the group.
              </p>

              <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(50) },
  relaxationVisible: true,
  fadeDuration: 1000,
  onGroupDoubleClick: function(event) {
    event.preventDefault();
    this.zoom(event.secondary ? this.get("dataObject") : event.group);
  }
});</pre>
            </section>

            <section id="reset" class="api" data-since="3.0.0">
              <h3>reset()</h3>

              <p>
                Resets the visualization view back to the initial state, which includes: unexposing and closing
                all groups, resetting the zoom factor to make the whole visualization area visible. The selection
                state is not affected by this method.
              </p>


              <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.select([ "1", "2" ]);
foamtree.expose([ "3", "4" ]);
foamtree.open([ "2", "3" ]);
var timeout = window.setTimeout(function() {
  foamtree.reset();
}, 3000);</pre>
            </section>

            <section id="trigger" class="api" data-since="3.0.0">
              <h3 data-alt="trigger()">trigger(type, event)</h3>

              <p>
                Triggers the FoamTree action associated with the event of the provided type. The most common use
                case for this method is <a href="#externally-triggered-interaction">replacing FoamTree's built-in
                touch event detection infrastructure</a> with the code of your own.
              </p>

              <p>
                The <code>trigger</code> method requires two parameters:
              </p>

              <dl class="dl-horizontal">
                <dt>type</dt>
                <dd>
                  <p>
                    string identifier of the event to trigger. Below is a list of supported events
                    along with the FoamTree actions they trigger:
                  </p>

                  <dl class="dl-horizontal">
                    <dt>click</dt>
                    <dd>
                      a single mouse click event, selects or deselects a group
                    </dd>

                    <dt>doubleclick</dt>
                    <dd>
                      a double mouse click event, exposes or unexposes a group
                    </dd>

                    <dt>hold</dt>
                    <dd>
                      click-and-hold event, opens or closes a group
                    </dd>

                    <dt>mousedown</dt>
                    <dd>
                      stops zoomed visualization panning
                    </dd>

                    <dt>mousewheel</dt>
                    <dd>
                      turning of the mouse wheel up or down, zooms in or out the visualization
                    </dd>

                    <dt>hover</dt>
                    <dd>
                      hovering with the mouse pointer over the group, highlights the group
                    </dd>

                    <dt>dragstart</dt>
                    <dd>
                      starts panning the zoomed visualization
                    </dd>

                    <dt>drag</dt>
                    <dd>
                      pans the zoomed visualization
                    </dd>

                    <dt>dragend</dt>
                    <dd>
                      depending on the speed of panning: continues panning of the visualization or
                      stops panning and corrects the view port in such a way that the edge of the
                      visualization touches the edge of the viewport.
                    </dd>

                    <dt>transformstart</dt>
                    <dd>
                      starts the touch-based zooming of the visualization
                    </dd>

                    <dt>transform</dt>
                    <dd>
                      touch-based zooming of the visualization
                    </dd>

                    <dt>transformend</dt>
                    <dd>
                      completes the touch-based zooming of the visualization, corrects the view port in
                      such a way that the edge of the visualization touches the edge of the viewport.
                      If the last transformation scale was lower than 0.8 and the zooming was performed
                      with three or more fingers, triggers <code>reset</code> of the visualization view.
                    </dd>
                  </dl>
                </dd>

                <dt>event</dt>
                <dd>
                  the details of the event to trigger. The object must contain all the properties
                  of the <a href="#event-details">low-level event</a>, apart from the
                  <code>preventDefault()</code> method.
                </dd>
              </dl>

              <div class="alert alert-warning">
                <strong>Heads up!</strong>

                <p>
                  Initiating events using the <code>trigger</code> method will notify all the involved
                  event listeners. For example, triggering the <code>click</code> event will invoke the
                  <code>onGroupClick</code> listeners and, if the default action is not prevented by that
                  listener, the <code>onGroupSelectionChanging</code> and the <code>onGroupSelectionChanged</code>
                  events.
                </p>

                <p>
                  For this reason, calling the <code>trigger</code> method in event listeners <strong>may
                  lead to the visualization falling in an endless loop</strong>.
                </p>
              </div>
            </section>

            <section id="dispose" class="api" data-since="3.0.0">
              <h3>dispose()</h3>

              <p>
                Stops all running animations and removes all HTML event listeners registered by FoamTree.
                If you are repeatedly instantiating and disposing of FoamTree instances on the same page,
                make sure you call the <code>dispose</code> method when appropriate. Otherwise, dangling
                event listeners will prevent large chunks of memory from being garbage-collected.
              </p>
            </section>
          </section>


          <section id="options">
            <div class="page-header"><h1>Options</h1></div>

            <section id="options-embedding" class="api-group">
              <h2>Embedding</h2>

              <section id="supported" class="api">
                <h3 class="nodefault">supported</h3>

                <p>
                  A static property on <code>CarrotSearchFoamTree</code> equal to <code>true</code> if visualization
                  is supported on the current browser environment.
                </p>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>
                  <p>
                    This property is static and must be accessed directly on <code>CarrotSearchFoamTree</code> class,
                    as shown in this example:
                  </p>
                  <pre class="executable example nooverlay">
if (CarrotSearchFoamTree.supported) {
  // Put embedding code here.
  console.log("Visualization supported.");
} else {
  // Display a warning or skip visualization.
  console.log("Visualization not supported.");
}</pre>
                </div>
              </section>

              <section id="id" class="api">
                <h3>id</h3>

                <p>
                  Identifier of the DOM element into which the visualization is to be embedded.
                </p>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>
                  <p>
                    The DOM element must have a non-zero width and height before embedding. The visualization
                    will allocate a canvas of exactly the same size (client size) and will stretch proportionally
                    when the element's size changes. The visualization must be resized manually
                    (see <code>resize</code> method) to update to new element's dimensions.
                  </p>
                </div>
              </section>

              <section id="element" class="api">
                <h3>element</h3>

                <p>
                  The DOM element into which the visualization is to be embedded. Please see the <code>id</code>
                  option for additional considerations.
                </p>
              </section>
            </section>

            <section id="options-data" class="api-group">
              <h2>Data</h2>

              <section id="dataObject" class="api">
                <h3>dataObject</h3>

                <p>
                  The data to visualize. The provided value must be an object or <code>null</code> / <code>undefined</code>.
                  The object will be  assumed to represent the root group and must contain a non-empty <code>groups</code> property
                  pointing to an array of objects representing individual first-level groups. A <code>null</code>
                  or <code>undefined</code> object clears the visualization.
                </p>

                <p>Each group can contain the following properties:</p>

                <dl class="dl-horizontal">
                  <dt>id</dt>
                  <dd>
                    (optional, String) unique identifier of the group. Group
                    identifiers are required only for programmatic changes of certain
                    group attributes such as <code>selection</code>, <code>exposure</code>
                    or <code>open</code> state.
                  </dd>

                  <dt>label</dt>
                  <dd>
                    <p>
                      (required, String) textual description of the group. For best results, use short labels.
                    </p>

                    <p>
                      FoamTree will handle the following special unicode characters in the label text:
                    </p>

                    <dl class="dl-horizontal wide" id="special-characters-in-labels">
                      <dt>Unbreakable space (\u00a0)</dt>
                      <dd>line breaks will not be made on the unbreakable space character</dd>

                      <dt>Soft hyphen (\u00ad)</dt>
                      <dd>
                        <p>
                          when label needs to be broken into multiple lines, soft hyphen will allow
                          a line break, generating the hyphen character at the end of the line.
                          A soft hyphen will not add any spacing between the characters that surround it.
                        </p>

                        <p>
                          If you'd like to have your labels hyphenated, you can use an external hyphenation
                          utility, such as <a href="https://code.google.com/p/hyphenator/">Hyphenator.js</a>
                          to insert soft hyphens into your labels.
                        </p>
                      </dd>

                      <dt>Zero-width space (\u200b)</dt>
                      <dd>
                        when label needs to be broken into multiple lines, zero-width space will allow
                        a line break. A zero-width space will not add any spacing between the characters
                        that surround it.
                      </dd>
                    </dl>
                  </dd>

                  <dt>weight</dt>
                  <dd>
                    <p>
                      (optional, Number >= 0) weight of the group relative
                      to other groups. The larger the weight, the more space the group's
                      polygon will occupy on the screen. Good values for the weight property
                      could be e.g. the number of documents in a cluster or the score of
                      the cluster.
                    </p>
                    <p>
                      Group weights must be non-negative. Zero-weight groups can receive
                      special treatment, see the <code>showZeroWeightGroups</code> option.
                      If a group's weight is not specified, FoamTree will assume the weight
                      is <code>1.0</code>.
                    </p>
                  </dd>

                  <dt>groups</dt>
                  <dd>(optional, Array) an array of subgroups of the group.</dd>

                  <dt>open</dt>
                  <dd>
                    (optional, boolean) if <code>true</code>, the group will get open right after the new data is set.
                  </dd>

                  <dt>exposed</dt>
                  <dd>
                    (optional, boolean) if <code>true</code>, the group will get exposed right after the new data is set.
                    This can be useful to visually highlight a certain group (or groups) as the data is loaded.
                    Please note the <a href="#api-triggered-exposure-with-visible-releaxation">limitations when
                    relaxation is visible</a>.
                  </dd>

                  <dt>selected</dt>
                  <dd>
                    (optional, boolean) if <code>true</code>, the group will get selected right after the new data is set.
                  </dd>
                </dl>

                <p>
                  The data object (and groups) can contain custom properties, not required or interpreted by the
                  visualization. These properties may be used for color model tuning, for example.
                  The following example shows a data object with various values of the above properties.
                </p>

                <pre class="partial executable example">
foamtree.set({
  dataObject: {
    groups: [
      { label: "Bad news", open: true, groups: [
        { label: "Last penny lost", sentiment: -0.5 },
        { label: "Bazinga doomed",  sentiment: -1 }
        ]},
      { label: "Good news", exposed: true, selected: true, groups: [
        { label: "iPads under $100",      sentiment: 0.5, selected: true },
        { label: "Martians are friendly", sentiment: 1 }
        ]},
      { label: "Other news", groups: [
        { label: "Vampires on the loose",     sentiment: -2 },
        { label: "Van Helsing to the rescue", sentiment: -3 }
        ]}
    ]
  }
});</pre>

                <p>
                  See the <a href="#data-model">Data model</a> and <a href="#carrot2-models">Carrot<sup>2</sup> models</a>
                  sections for examples of how to convert data that is not in FoamTree format.
                </p>
              </section>

              <section id="hierarchy" class="api">
                <h3>hierarchy</h3>

                <p>
                  Returns hierarchy-related information about a group. The returned object contains the following
                  properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>group</dt>
                  <dd>a reference to the data object representing the related group</dd>

                  <dt>parent</dt>
                  <dd>
                    a reference to the data object representing the immediate parent of the group
                    or <code>null</code>
                  </dd>

                  <dt>level</dt>
                  <dd>the nesting level of the group. Level numbers start at 0.</dd>

                  <dt>index</dt>
                  <dd>the position of the group relative to its siblings in the input data object. Position indices start at 0.</dd>

                  <dt>siblingCount</dt>
                  <dd>the number of immediate siblings of the group</dd>

                  <dt>hasChildren</dt>
                  <dd><code>true</code> if the group has any child groups</dd>

                  <dt>weightNormalized</dt>
                  <dd>
                    the weight of the group normalized to the 0..1 range in relation the group's siblings. The raw
                    weight of the group can be retrieved from the original data model if it was present there.
                  </dd>

                  <dt>indexByWeight</dt>
                  <dd>
                    <span class="label label-default">Since 3.0.2</span> the position of the group relative to its siblings in the decreasing weight order, 0
                    index corresponds to the highest-weight group.
                  </dd>

                  <dt>attribution</dt>
                  <dd>
                    <span class="label label-default">Since 3.3.1</span> <code>true</code> if the group is
                    the attribution group.
                  </dd>
                </dl>

                <p>
                  To retrieve the information about a group, provide the <a href="#individual-group-selector">individual
                  group selector</a> as the second parameter of the <code>get</code> method:
                </p>

                <pre class="partial executable example">
console.log(foamtree.get("hierarchy", "1"));</pre>
              </section>
            </section>


            <section id="options-layout" class="api-group">
              <h2>Layout</h2>

              <p>
                Options described in this section determine the arrangement of polygons generated by FoamTree.
              </p>

              <section id="layout" class="api">
                <h3>layout</h3>

                <p>
                  Determines the general type of layout to generate. Depending on this option, FoamTree will produce
                  polygon-based organic-looking visualization or the traditional rectangular tree map.
                </p>

                <p>
                  The following values are supported:
                </p>

                <dl class="dl-horizontal">
                  <dt>relaxed</dt>
                  <dd>
                    produces polygonal organic-looking arrangements based on Voronoi diagrams. This type of layout
                    tends to visualize groups as near-round polygons leaving plenty of space for the
                    group's label and content. A potential downside of this layout is that it may not very
                    well preserve the original order of groups provided in the data object. See the
                    <code>relaxationInitializer</code> option for various possible representations of the group order
                    in the relaxed layout.
                  </dd>

                  <dt>ordered</dt>
                  <dd>
                    produces the traditional rectangular treemap using the <em>strip</em> algorithm. The advantage of
                    this layout is that, if <code>layoutByWeightOrder</code> is <code>false</code>, it will arrange
                    groups in the left-to-right top-to-bottom fashion according to the order they were provided in the
                    data object. One disadvantage of this algorithm is that certain groups may be visualized as
                    high-aspect-ratio rectangles, which will leave little useful space for the label and contents of the
                    group. You can use the <code>rectangleAspectRatioPreference</code> option to tune the aspect
                    ratios of the rectangles to some extent.
                  </dd>

                  <dt>squarified</dt>
                  <dd>
                    produces the traditional treemap using the <em>squarified</em> algorithm. This layout arranges
                    groups along the diagonal of the container. Aspect ratios of the rectangles produced by this
                    method tend to be lower than the ones from the <code>ordered</code> layout. The squarified
                    algorithm, however, does not lay out groups in the left-to-right fashion.
                  </dd>
                </dl>

                <p>
                  The following table summarizes the possible use cases for the specific layouts.
                </p>

                <table class="table">
                  <thead>
                    <tr>
                      <th style="width: 40%">Requirement</th>
                      <th>Layout</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Organic-looking layout is required.</td>
                      <td>
                        Use the <code>relaxed</code> layout, customize the the <code>relaxationInitializer</code> to
                        choose the arrangement of polygons.
                      </td>
                    </tr>

                    <tr>
                      <td>Traditional rectangular treemap is required.</td>
                      <td>
                        Use the <code>ordered</code> or <code>squarified</code> layout, customize
                        <code>rectangleAspectRatioPreference</code> if needed.
                      </td>
                    </tr>

                    <tr>
                      <td>
                        The left-to-right order of groups <em>should ideally</em> correspond to the order in the
                        <code>dataObject</code>.
                      </td>
                      <td>
                        Use the <code>relaxed</code> layout, set <code>relaxationInitializer</code> to
                        <code>ordered</code>.
                      </td>
                    </tr>

                    <tr>
                      <td>
                        The left-to-right order of groups <em>must</em> correspond to the order in the
                        <code>dataObject</code>.
                      </td>
                      <td>
                        Use the <code>ordered</code> layout, set <code>layoutByWeightOrder</code> to <code>false</code>,
                        customize <code>rectangleAspectRatioPreference</code> if needed.
                      </td>
                    </tr>

                    <tr>
                      <td>
                        Close-to-round group shapes are preferred.
                      </td>
                      <td>
                        Use the <code>relaxed</code> layout for a polygonal diagram or the <code>squarified</code> layout
                        for a rectangular diagram.
                      </td>
                    </tr>
                  </tbody>
                </table>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>

                  <p>
                    Certain other options are applicable only when a specific layout is used. For example, the
                    <code>relaxationInitializer</code>, <code>relaxationVisible</code> and other relaxation-related
                    options are only meaningful when <code>layout</code> is set to <code>relaxed</code>.
                  </p>
                </div>
              </section>

              <section id="layoutByWeightOrder" class="api">
                <h3>layoutByWeightOrder</h3>

                <p>
                  When <code>true</code>, FoamTree will lay out the groups in the order of decreasing weight.
                  When <code>false</code>, FoamTree will lay out the groups in the order they were provided
                  in the <code>dataObject</code>.
                </p>

                <p>
                  Please see the <code>layout</code> option for information about
                  how the order of groups can translate into their position in the visualization.
                </p>
              </section>

              <section id="showZeroWeightGroups" class="api">
                <h3>showZeroWeightGroups</h3>

                <p>
                  If <code>true</code>, groups whose weight is zero will be visible, with their
                  weight slightly smaller than the smallest non-zero weight of the sibling groups.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                    <pre class="partial executable example">
foamtree.set({
  showZeroWeightGroups: true,
  dataObject: {
    groups: [
      { label: "Group 1", weight: 1 },
      { label: "Group 2", weight: 1 },
      { label: "Group 3", weight: 1 },
      { label: "Group 4", weight: 0 }
    ]
  }
});</pre>
                  </div>
                  <div class="col-sm-6">
                    <pre class="partial executable example">
foamtree.set({
  showZeroWeightGroups: false,
  dataObject: {
    groups: [
      { label: "Group 1", weight: 1 },
      { label: "Group 2", weight: 1 },
      { label: "Group 3", weight: 1 },
      { label: "Group 4", weight: 0 }
    ]
  }
});</pre>
                  </div>
                </div>
              </section>

              <section id="groupMinDiameter" class="api">
                <h3>groupMinDiameter</h3>

                <p>
                  Minimum estimated diameter child groups must have in order to be drawn. To avoid illegible small
                  labels and to speed up the rendering, FoamTree can be set to skip drawing child groups if their
                  estimated diameter is smaller than <code>groupMinDiameter</code>. Setting the minimum group diameter to 0 will
                  cause FoamTree to draw as many groups as possible groups given the <code>maxGroups</code> limit and
                  the available floating point precision.
                </p>

                <p>
                  The following example sets a very large value for the <code>groupMinDiameter</code> option after
                  a short delay. Observe that once the change is applied, the child groups disappear &ndash; their
                  diameters were smaller than the threshold.
                </p>

                <pre class="partial executable example" data-runafter="clearTimeout">
var timeout = setTimeout(function() {
  foamtree.set({
    groupMinDiameter: 500,

    // Set the data object again to apply the change
    dataObject: foamtree.get("dataObject")
  });
}, 2000);</pre>
              </section>

              <section id="maxGroups" class="api">
                <h3>maxGroups</h3>

                <p>
                  The hard limit on the number of groups FoamTree will attempt to include in a single visualization.
                  The limit is there to prevent excessive memory usage when browsing very deep hierarchies.
                  The limit is applied in a breadth-first fashion, which means that if FoamTree needs to skip
                  groups that do not fit within the limit, it will skip the groups at lower levels of the hierarchy.
                </p>
              </section>

              <section id="rectangleAspectRatioPreference" class="api">
                <h3>rectangleAspectRatioPreference</h3>

                <p>
                  <strong>Note: </strong> applicable only when <code>layout</code> is set to  <code>ordered</code> or
                  <code>squarified</code>.
                </p>

                <p>
                  Determines the desired aspect ratio of rectangles produced in the <code>ordered</code> and
                  <code>squarified</code> layouts.
                </p>

                <dl class="dl-horizontal">
                  <dt>option value &lt; 0</dt>
                  <dd>
                    FoamTree will try to produce rectangles whose width is larger than the height. Such arrangement will
                    make it slightly easier to fit labels into small rectangular groups.
                  </dd>

                  <dt>option value &gt; 0</dt>
                  <dd>
                    FoamTree will prefer rectangles whose width is smaller than the height.
                  </dd>

                  <dt>option value == 0</dt>
                  <dd>
                    FoamTree will prefer rectangles of equal width and height.
                  </dd>
                </dl>
              </section>

              <section id="geometry" class="api">
                <h3>geometry</h3>

                <p>
                  Returns information about the geometry of the polygon representing a group or <code>null</code> if the
                  group's polygon is not drawn. The returned object contains the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>polygonCenterX</dt>
                  <dd>
                    the X coordinate of the group's polygon. The coordinate is absolute, it does not take into account
                    the transformations resulting from zooming, panning and exposure.
                  </dd>

                  <dt>polygonCenterY</dt>
                  <dd>the Y coordinate of the group's polygon, absolute</dd>

                  <dt>polygonArea</dt>
                  <dd>the area of the group's polygon, absolute</dd>

                  <dt>boxLeft</dt>
                  <dd>the X coordinate of the top-left corner of the group polygon's bounding box, absolute</dd>

                  <dt>boxTop</dt>
                  <dd>the Y coordinate of the top-left corner of the group polygon's bounding box, absolute</dd>

                  <dt>boxWidth</dt>
                  <dd>width of the group polygon's bounding box, absolute</dd>

                  <dt>boxHeight</dt>
                  <dd>height of the group polygon's bounding box, absolute</dd>

                  <dt id="geometry-polygon">polygon</dt>
                  <dd>
                    an array of objects containing the X and Y coordinates of the groups polygon, in the clockwise order.
                    All polygons produced by FoamTree are convex. The array is only returned if <code>true</code> is
                    passed as the third parameter of the <code>get</code> method.
                  </dd>
                </dl>

                <p>
                  To retrieve the information about a group, provide the <a href="#individual-group-selector">individual
                  group selector</a> as the second parameter of the <code>get</code> method.
                </p>

                <pre class="partial executable example">
console.log(foamtree.get("geometry", "1"));</pre>

                <p>
                  To retrieve the full geometry information, including coordinates of the polygon's vertices,
                  pass <code>true</code> as the third parameter of the <code>get</code> method:
                </p>

                <pre class="partial executable example">
console.log(foamtree.get("geometry", "1", true));</pre>

                <p>
                  Please see the <a href="../demos/accuracy.html" target="_blank">accuracy.html</a> demo for an advanced code example
                  that uses the geometry information to compute the accuracy with which polygon's areas correspond
                  to the group's weights.
                </p>
              </section>
            </section>

            <section id="options-relaxation" class="api-group">
              <h2>Relaxation</h2>

              <p>
                Options described in this section determine how FoamTree refines the initial polygon arrangement
                to arrive at a visually pleasing result. Options in this section are only applicable when
                <code>layout</code> is set to <code>relaxed</code>.
              </p>

              <section id="relaxationInitializer" class="api">
                <h3>relaxationInitializer</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  Determines the initial layout of groups' polygons. The following values are supported:
                </p>

                <dl class="dl-horizontal">
                  <dt>fisheye</dt>
                  <dd>puts large groups in the center of the visualization area and the smaller groups towards the corners</dd>

                  <dt>blackhole</dt>
                  <dd>puts small groups in the center of the visualization and the larger groups towards the corners</dd>

                  <dt>ordered</dt>
                  <dd>
                    <span class="label label-default">Since 3.3.0</span> lays out the groups in a left-to-right lines,
                    in the order the groups were specified in the data object. This initializer creates layouts most
                    similar to the ones generated by FoamTree 2.0.x.
                  </dd>

                  <dt>squarified</dt>
                  <dd>
                    puts large groups close to the top-left corner of the visualization and the small groups
                    close to the bottom-right corner.
                  </dd>

                  <dt>random</dt>
                  <dd>puts groups at random positions</dd>
                </dl>

                <p>
                  The example below demonstrates the available initializers. Note that in order to apply
                  a new initializer to the currently visible data, you need to set the <code>dataObject</code>
                  option to trigger the layout update.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: {
    groups: (function () {
      var arr = [
        { label: "fisheye", weight: 7 }, { label: "blackhole", weight: 6 },
        { label: "ordered", weight: 5 }, { label: "squarified", weight: 5 },
        { label: "random", weight: 4 }
      ];
      for (var i = 0; i < 100; i++) {
        arr.push({
          label: "",
          weight: 0.1 + Math.random() +
            (Math.random() < 0.2 ? Math.random() * 3 : 0)
        });
      }
      return arr;
    })()
  },

  relaxationVisible: true,         // show relaxation
  wireframeLabelDrawing: "always", // show labels during relaxation

  onGroupClick: function (event) {
    event.preventDefault();
    if (event.group.label) {
      this.set("relaxationInitializer", event.group.label);

      // Set the data object again to trigger layout update
      this.set("dataObject", this.get("dataObject"));
    }
  }
});</pre>

                <p id="initializer-per-group">
                  <span class="label label-default">Since 3.1.0</span> You can also specify different layout initializers
                  for each parent group separately by passing the initializer type in the <code>relaxationInitializer</code> property
                  of the group's data object.
                </p>

                <p>
                  The following example demonstrates all of the available initializers in one visualization.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: {
    groups: (function () {
      var initializers = [ "fisheye", "random", "ordered", "squarified", "blackhole" ];
      return initializers.map(function (i) {
        return {
          relaxationInitializer: i, // pass the initializer to use for this group
          label: i,
          groups: randomGroups(40)
        }
      });
    })()
  },

  relaxationVisible: true,         // show relaxation
  relaxationMaxDuration: 6000,     // make relaxation last longer
  relaxationQualityThreshold: 0.1,
  fadeDuration: 2000,              // use a simple fade-in
  rolloutDuration: 0,
  pullbackDuration: 0,
  wireframeLabelDrawing: "always"  // show labels during animation
});</pre>
              </section>

              <section id="relaxationVisible" class="api">
                <h3>relaxationVisible</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  When set to <code>true</code>, FoamTree will show the intermediate steps of layout relaxation.
                  For large data sets, when layout computation may take a few seconds, you may want to show the
                  relaxation process to the users, so that they don't see the blank screen while waiting
                  for the final visualization to be computed.
                </p>

                <p>
                  Layout relaxation and rollout animation can run in parallel. Alternatively, to let the user
                  watch the layout stabilize, you may want to disable the rollout by setting <code>rolloutDuration</code>
                  to <code>0</code> and fading in the visualization container by setting <code>fadeDuration</code>
                  to <code>1000</code>, for example.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: {
    groups: (function () {
      var arr = [];
      for (var i = 0; i < 100; i++) {
        arr.push({
          label: "",
          weight: 0.1 + Math.random() +
            (Math.random() < 0.2 ? Math.random() * 3 : 0)
        });
      }
      return arr;
    })()
  },

  relaxationInitializer: "random",
  relaxationVisible: true,
  fadeDuration: 1000
});</pre>

                <p>
                  When relaxation is visible, you can report the progress of the process to the user using the
                  <a href="#relaxation-progress-indicator">relaxation progress utility</a>.
                </p>

                <div class="alert alert-warning" id="api-triggered-exposure-with-visible-releaxation">
                  <strong>Heads up!</strong>

                  <p>
                    When relaxation process is visible, the API-triggered exposure changes of a group will
                    be ignored until the polygon corresponding to that group is computed. In particular,
                    when <code>relaxationVisible</code> is <code>true</code>, the initial exposure state provided
                    in the <code>dataObject</code> will be ignored. As a workaround, you can expose the requested
                    sites when the rollout completes as shown in the following example.
                  </p>

                  <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(20) },
  relaxationVisible: true,
  fadeDuration: 1000,
  onRolloutComplete: function(progress, complete) {
    foamtree.expose(foamtree.get("dataObject").groups[0]);
  }
});</pre>
                </div>
              </section>

              <section id="relaxationMaxDuration" class="api">
                <h3>relaxationMaxDuration</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  Determines the maximum duration of relaxation, in milliseconds. Depending on the complexity of the
                  data set and the <code>relaxationQualityThreshold</code>, the relaxation may or may not complete
                  before the specified timeout. If FoamTree needs to stop the relaxation because the alloted time
                  has been exceeded, the quality of the layout may be lowered.
                </p>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>

                  <p>
                    Currently, the <code>relaxationMaxDuration</code> is enforced only if <code>relaxationVisible</code>
                    is set to <code>true</code>.
                  </p>
                </div>

                <p>
                  The following example sets a fairly short maximum relaxation duration. Observe how this lowers
                  the quality of the layout by creating non-round, elongated polygons.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: {
    groups: (function () {
      var arr = [];
      for (var i = 0; i < 100; i++) {
        arr.push({
          label: "",
          weight: 0.1 + Math.random() +
            (Math.random() < 0.2 ? Math.random() * 3 : 0)
        });
      }
      return arr;
    })()
  },

  relaxationInitializer: "random",
  relaxationVisible: true,
  relaxationMaxDuration: 100
});</pre>
              </section>

              <section id="relaxationQualityThreshold" class="api">
                <h3>relaxationQualityThreshold</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  The desired layout quality to achieve during relaxation. High-quality layouts will consist of "round"
                  polygons, lower-quality layouts will tend to contain more elongated, irregular shapes. The lower the
                  value of the threshold, the higher the quality of the layout and the longer the layout computation
                  time. If <code>relaxationVisible</code> is <code>true</code>, the desired quality level may not be
                  achieved if the <code>relaxationMaxDuration</code> timeout is exceeded.
                </p>

                <p>
                  Setting <code>relaxationQualityThreshold</code> to <code>0</code> and <code>relaxationMaxDuration</code>
                  to <code>Number.MAX_VALUE</code> will create the highest-quality layout possible, at the cost
                  of long relaxation time. Setting <code>relaxationQualityThreshold</code>, regardless of the relaxation
                  duration timeout will disable the relaxation leading to lower-quality layout, but faster computation.
                  The following examples demonstrate the two opposite situations.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                      <pre class="partial executable example">
foamtree.set({
  dataObject: { groups: randomGroups(80) },
  relaxationInitializer: "fisheye",
  relaxationVisible: true,
  relaxationQualityThreshold: Number.MAX_VALUE
});</pre>
                  </div>
                  <div class="col-sm-6">
                      <pre class="partial executable example">
foamtree.set({
  dataObject: { groups: randomGroups(80) },
  relaxationInitializer: "fisheye",
  relaxationVisible: true,
  relaxationMaxDuration: Number.MAX_VALUE,
  relaxationQualityThreshold: 0
});</pre>
                  </div>
                </div>
              </section>

              <section id="groupGrowingDuration" class="api">
                <h3>groupGrowingDuration</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  The duration of the animation that grows the group to its final weight, in milliseconds.
                  Applicable only when <code>relaxationVisible</code> is <code>true</code>.
                </p>

                <pre class="partial executable example">
foamtree.set({
  dataObject: { groups: randomGroups(80) },
  relaxationInitializer: "fisheye",
  relaxationVisible: true,
  groupGrowingDuration: 3000
});</pre>
              </section>

              <section id="groupGrowingEasing" class="api">
                <h3>groupGrowingEasing</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  The easing function to use to grow group's weights. Meaningful only when
                  <code>groupGrowingDuration</code> is larger than <code>0</code>.
                </p>
              </section>

              <section id="groupGrowingDrag" class="api">
                <h3>groupGrowingDrag</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  The amount of delay to apply when growing subsequent groups on the same level of hierarchy. The delay
                  will be computed by multiplying <code>groupGrowingDuration</code> by the value of this option.
                  The first child group will start growing immediately, the second one after the computed delay, the
                  third group will start growing after twice the delay and so on.
                </p>

                <pre class="partial executable example">
foamtree.set({
  dataObject: { groups: randomGroups(80) },
  relaxationInitializer: "fisheye",
  relaxationVisible: true,
  groupGrowingDuration: 2000,
  groupGrowingDrag: 0.2
});</pre>
              </section>

              <section id="groupResizingBudget" class="api">
                <h3>groupResizingBudget</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  Determines how many times FoamTree should attempt to set the desired size for the groups polygon.
                  Depending on the characteristics of the input data, FoamTree may not be able to set the desired
                  sizes of the polygons right away. Depending on the <code>groupResizingBudget</code> value, FoamTree
                  will make several attempts to set the desired size during the course of relaxation.
                </p>

                <p>
                  Setting this option to <code>0</code> may cause large-weight groups to be rendered smaller than
                  desired. Setting a large value of this option may lead to "jumpy" and time-consuming relaxation.
                </p>
              </section>
            </section>

            <section id="options-group-borders" class="api-group">
              <h2>Group borders</h2>

              <p>
                Options in this section determine the spacing between group's polygons.
              </p>

              <section id="groupBorderRadius" class="api">
                <h3>groupBorderRadius</h3>

                <p>
                  Determines the amount of rounding to apply to polygon corners. Setting group border radius to
                  <code>0</code> will produce straight corners, the value of <code>1.0</code> will produce
                  near-to-oval shapes.
                </p>
              </section>

              <section id="groupBorderWidth" class="api">
                <h3>groupBorderWidth</h3>

                <p>
                  Determines the width of the empty space between the
                  <a href="#group-decorations">sibling group polygons</a>, in pixels.
                </p>

                <div class="alert alert-warning">
                  <strong>Heads up!</strong>

                  <p>
                    Setting <code>groupBorderWidth</code> to a value smaller than
                    <code>groupStrokeWidth</code><code> / 2 + 0.5</code> will prevent FoamTree from using incremental
                    drawing routines and therefore slow down visualization updates during hover, opening and
                    selection changes.
                  </p>
                </div>
              </section>

              <section id="groupBorderWidthScaling" class="api">
                <h3>groupBorderWidthScaling</h3>

                <p>
                  The scaling factor to apply when drawing borders of child groups. Border with of a child group will be
                  <code>groupBorderWidthScaling</code> smaller than the border width of the immediate parent group.
                  Setting <code>groupBorderWidthScaling</code> to 1.0 will draw borders of equal widths on all levels
                  of the group hierarchy.
                </p>
              </section>

              <section id="groupInsetWidth" class="api">
                <h3>groupInsetWidth</h3>

                <p>
                  Determines the width of the empty space between the
                  <a href="#group-decorations">parent group's edge and its child groups' edges</a>, in pixels.
                </p>
              </section>

              <section id="groupBorderRadiusCorrection" class="api">
                <h3>groupBorderRadiusCorrection</h3>

                <p>
                  The correction factor that ensures that the rounded parent group polygon covers all child group's
                  polygons. For large <code>groupBorderRadius</code> values, it may sometimes happen that certain
                  child polygons "stick out" of their parent group. In such cases, you can increase the
                  <code>groupBorderRadiusCorrection</code> value to ensure proper rendering.
                </p>
              </section>
            </section>

            <section id="options-group-fill" class="api-group">
              <h2>Group fill</h2>

              <p>
                Options documented in this section determine how FoamTree will fill the polygons.
              </p>

              <section id="groupFillType" class="api">
                <h3>groupFillType</h3>

                <p>
                  Determines the way the group polygons should be filled. The following values are possible:
                </p>

                <dl class="dl-horizontal">
                  <dt>none</dt>
                  <dd>the polygons will not be filled at all</dd>

                  <dt>plain</dt>
                  <dd>the polygons will be filled with one color; fast to render</dd>

                  <dt>gradient</dt>
                  <dd>the polygons will be filled with a two-color radial gradient; slower to render</dd>
                </dl>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>

                  <p>
                    On slower devices and/or larger data sets, FoamTree may automatically disable rendering of gradients
                    to improve the rendering performance. To force the rendering of gradients in such cases,
                    increase <code>wireframeDrawMaxDuration</code>, <code>finalCompleteDrawMaxDuration</code> and
                    <code>finalIncrementalDrawMaxDuration</code>.
                  </p>
                </div>
              </section>

              <section id="groupFillGradientRadius" class="api">
                <h3>groupFillGradientRadius</h3>

                <p>
                  Determines the radius of the group-filling gradient.
                </p>
              </section>

              <section id="groupFillGradientCenterHueShift" class="api">
                <h3>groupFillGradientCenterHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base group color hue to create
                  the polygon-center end of the fill gradient.
                </p>
              </section>

              <section id="groupFillGradientCenterSaturationShift" class="api">
                <h3>groupFillGradientCenterSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base group color saturation to create
                  the polygon-center end of the fill gradient.
                </p>
              </section>

              <section id="groupFillGradientCenterLightnessShift" class="api">
                <h3>groupFillGradientCenterLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base group color lightness to create
                  the polygon-center end of the fill gradient.
                </p>
              </section>

              <section id="groupFillGradientRimHueShift" class="api">
                <h3>groupFillGradientRimHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base group color hue to create
                  the polygon-edge end of the fill gradient.
                </p>
              </section>

              <section id="groupFillGradientRimSaturationShift" class="api">
                <h3>groupFillGradientRimSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base group color saturation to create
                  the polygon-edge end of the fill gradient.
                </p>
              </section>

              <section id="groupFillGradientRimLightnessShift" class="api">
                <h3>groupFillGradientRimLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base group color lightness to create
                  the polygon-edge end of the fill gradient.
                </p>
              </section>
            </section>
            
            <section id="options-group-stroke" class="api-group">
              <h2>Group stroke</h2>

              <p>
                Options documented in this section determine how FoamTree will draw the edges of the polygons.
              </p>

              <section id="groupStrokeType" class="api">
                <h3>groupStrokeType</h3>

                <p>
                  Determines the way the group polygons edges should be drawn. The following values are possible:
                </p>

                <dl class="dl-horizontal">
                  <dt>none</dt>
                  <dd>the edges will not be drawn at all; fastest to render</dd>

                  <dt>plain</dt>
                  <dd>the edges will be drawn using one color; slower to render</dd>

                  <dt>gradient</dt>
                  <dd>the edges will be drawn using a two-color linear gradient; slowest to render</dd>
                </dl>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>

                  <p>
                    On slower devices and/or larger data sets, FoamTree may automatically disable rendering of edges
                    to improve the rendering performance. To force the rendering of gradients in such cases,
                    increase <code>wireframeDrawMaxDuration</code>, <code>finalCompleteDrawMaxDuration</code> and
                    <code>finalIncrementalDrawMaxDuration</code>.
                  </p>
                </div>
              </section>

              <section id="groupStrokeWidth" class="api">
                <h3>groupStrokeWidth</h3>

                <p>
                  Determines the <a href="#group-decorations">width of the group's edge</a>, in pixels.
                </p>

                <div class="alert alert-warning">
                  <strong>Heads up!</strong>

                  <p>
                    Setting <code>groupStrokeWidth</code> to a value larger than
                    <code>(</code><code>groupBorderWidth</code><code> - 0.5) * 2</code> will prevent FoamTree from
                    using incremental drawing routines and therefore slow down visualization updates during hover,
                    opening and selection changes.
                  </p>
                </div>
              </section>

              <section id="groupStrokePlainHueShift" class="api">
                <h3>groupStrokePlainHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base group color hue to create
                  the color used for drawing the plain group's edge.
                </p>
              </section>

              <section id="groupStrokePlainSaturationShift" class="api">
                <h3>groupStrokePlainSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base group color saturation to create
                  the color used for drawing the plain group's edge.
                </p>
              </section>

              <section id="groupStrokePlainLightnessShift" class="api">
                <h3>groupStrokePlainLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base group color lightness to create
                  the color used for drawing the plain group's edge.
                </p>
              </section>

              <section id="groupStrokeGradientRadius" class="api">
                <h3>groupStrokeGradientRadius</h3>

                <p>
                  The size of the linear gradient used to draw the polygon's edges, in relation to the polygon's size.
                </p>
              </section>

              <section id="groupStrokeGradientAngle" class="api">
                <h3>groupStrokeGradientAngle</h3>

                <p>
                  The angle of the linear gradient used to draw the polygon's edges.
                </p>
              </section>

              <section id="groupStrokeGradientUpperHueShift" class="api">
                <h3>groupStrokeGradientUpperHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base group color hue to create
                  the upper-end color of the polygon edge's gradient.
                </p>
              </section>

              <section id="groupStrokeGradientUpperSaturationShift" class="api">
                <h3>groupStrokeGradientUpperSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base group color saturation to create
                  the upper-end color of the polygon edge's gradient.
                </p>
              </section>

              <section id="groupStrokeGradientUpperLightnessShift" class="api">
                <h3>groupStrokeGradientUpperLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base group color lightness to create
                  the upper-end color of the polygon edge's gradient.
                </p>
              </section>

              <section id="groupStrokeGradientLowerHueShift" class="api">
                <h3>groupStrokeGradientLowerHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base group color hue to create
                  the lower-end color of the polygon edge's gradient.
                </p>
              </section>

              <section id="groupStrokeGradientLowerSaturationShift" class="api">
                <h3>groupStrokeGradientLowerSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base group color saturation to create
                  the lower-end color of the polygon edge's gradient.
                </p>
              </section>

              <section id="groupStrokeGradientLowerLightnessShift" class="api">
                <h3>groupStrokeGradientLowerLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base group color lightness to create
                  the lower-end color of the polygon edge's gradient.
                </p>
              </section>
            </section>
              
            <section id="options-group-selection" class="api-group">
              <h2>Group selection</h2>

              <p>
                Options documented in this section determine how FoamTree will draw and decorate the selected groups.
              </p>

              <section id="groupSelectionOutlineColor" class="api">
                <h3>groupSelectionOutlineColor</h3>

                <p>Color of the outline stroke for the selected groups.</p>
              </section>

              <section id="groupSelectionOutlineWidth" class="api">
                <h3>groupSelectionOutlineWidth</h3>

                <p>
                  Width of the <a href="#group-decorations">selection outline</a> to draw
                  around selected groups.
                </p>

                <div class="alert alert-warning">
                  <strong>Heads up!</strong>

                  <p>
                    Setting <code>groupSelectionOutlineWidth</code> to a value larger than
                  </p>

                  <p>
                    <code>(</code><code>groupBorderWidth</code><code>-</code><code>groupSelectionOutlineShadowSize</code><code> - 0.5) * 2</code>
                  </p>
                  <p>
                    will prevent FoamTree from using incremental drawing routines and therefore slow down visualization
                    updates during hover, opening and selection changes <strong>when one ore more groups are selected</strong>.
                  </p>
                </div>
              </section>

              <section id="groupSelectionOutlineShadowSize" class="api">
                <h3>groupSelectionOutlineShadowSize</h3>

                <p>
                  The size of the drop shadow to apply to the selection outline.
                </p>


                <div class="alert alert-warning">
                  <strong>Heads up!</strong>

                  <p>
                    Setting <code>groupSelectionOutlineShadowSize</code> to a value larger than
                  </p>

                  <p>
                    <code>(</code><code>groupBorderWidth</code><code>-</code><code>groupSelectionOutlineWidth</code><code> - 0.5) * 2</code>
                  </p>
                  <p>
                    will prevent FoamTree from using incremental drawing routines and therefore slow down visualization
                    updates during hover, opening and selection changes <strong>when one ore more groups are selected</strong>.
                  </p>
                </div>
              </section>

              <section id="groupSelectionOutlineShadowColor" class="api">
                <h3>groupSelectionOutlineShadowColor</h3>

                <p>
                  The color of the selection outline shadow.
                </p>
              </section>

              <section id="groupSelectionFillHueShift" class="api">
                <h3>groupSelectionFillHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base fill color hue when the group is selected.
                </p>
              </section>

              <section id="groupSelectionFillSaturationShift" class="api">
                <h3>groupSelectionFillSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base fill color saturation when the
                  group is selected.
                </p>
              </section>

              <section id="groupSelectionFillLightnessShift" class="api">
                <h3>groupSelectionFillLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base fill color lightness when the
                  group is selected.
                </p>
              </section>

              <section id="groupSelectionStrokeHueShift" class="api">
                <h3>groupSelectionStrokeHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base stroke color hue when the group is selected.
                </p>
              </section>

              <section id="groupSelectionStrokeSaturationShift" class="api">
                <h3>groupSelectionStrokeSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base stroke color saturation when the
                  group is selected.
                </p>
              </section>

              <section id="groupSelectionStrokeLightnessShift" class="api">
                <h3>groupSelectionStrokeLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base stroke color lightness when the
                  group is selected.
                </p>
              </section>
            </section>

            <section id="options-group-hover" class="api-group">
              <h2>Group hover</h2>

              <p>
                Options documented in this section determine how FoamTree will highlight the hovered-on groups.
              </p>

              <section id="groupHoverFillHueShift" class="api">
                <h3>groupHoverFillHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base fill color hue when the group is hovered on.
                </p>
              </section>

              <section id="groupHoverFillSaturationShift" class="api">
                <h3>groupHoverFillSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base fill color saturation when the
                  group is hovered on.
                </p>
              </section>

              <section id="groupHoverFillLightnessShift" class="api">
                <h3>groupHoverFillLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base fill color lightness when the
                  group is hovered on.
                </p>
              </section>

              <section id="groupHoverStrokeHueShift" class="api">
                <h3>groupHoverStrokeHueShift</h3>

                <p>
                  The amount of hue to add or subtract from the base stroke color hue when the group is hovered on.
                </p>
              </section>

              <section id="groupHoverStrokeSaturationShift" class="api">
                <h3>groupHoverStrokeSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the base stroke color saturation when the
                  group is hovered on.
                </p>
              </section>

              <section id="groupHoverStrokeLightnessShift" class="api">
                <h3>groupHoverStrokeLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the base stroke color lightness when the
                  group is hovered on.
                </p>
              </section>
            </section>

            <section id="options-group-labels" class="api-group">
              <h2>Group labels</h2>

              <p>
                Options documented in this section determine how FoamTree will lay out and draw group labels.
              </p>

              <section id="groupLabelFontFamily" class="api">
                <h3>groupLabelFontFamily</h3>

                <p>
                  Font family to use for drawing group labels. CSS-compliant font family specifications
                  are supported, including webfonts imported using the <code>@font-face</code> syntax.
                </p>
              </section>

              <section id="groupLabelFontStyle" class="api">
                <h3>groupLabelFontStyle</h3>

                <p>
                  Font style to use for drawing group labels. All CSS-compliant font styles are allowed,
                  such as <code>italic</code>.
                </p>
              </section>

              <section id="groupLabelFontWeight" class="api">
                <h3>groupLabelFontWeight</h3>

                <p>
                  Font weight to use for drawing group labels. All CSS-compliant font weights are allowed,
                  such as <code>bold</code>.
                </p>
              </section>

              <section id="groupLabelFontVariant" class="api">
                <h3>groupLabelFontVariant</h3>

                <p>
                  Font variant to use for drawing group labels. All CSS-compliant font variants are allowed,
                  such as <code>small-caps</code>.
                </p>
              </section>

              <section id="groupLabelMinFontSize" class="api">
                <h3>groupLabelMinFontSize</h3>

                <p>Minimum font size used for drawing group labels, in pixels.</p>

                <p>
                  Note that setting minimum font size to a large value may result in many labels being replaced
                  with an ellipsis ("dots"), as in this example:
                </p>

                <pre class="partial executable example">
foamtree.set({
  dataObject: largeDataSet,
  groupLabelMinFontSize: 30,
  groupLabelMaxFontSize: 40
});</pre>

                <p>
                  To force FoamTree to draw labels for all groups, set <code>groupLabelMinFontSize</code> to <code>0</code>.
                  This setting, however, may significantly slow down visualization rendering.
                </p>
              </section>

              <section id="groupLabelMaxFontSize" class="api">
                <h3>groupLabelMaxFontSize</h3>

                <p>
                  Maximum font size used for drawing group labels. See the
                  <code>groupLabelMaxFontSize</code> attribute for details.
                </p>
              </section>

              <section id="groupLabelDecorator" class="api">
                <h3>groupLabelDecorator</h3>

                <p>
                  Allows to customize or completely replace the default text of group labels. When labels are drawn,
                  FoamTree will call the provided function once for each group (parent groups will be processed before
                  children groups). The task of the function is to modify or completely replace the default label text.
                  The custom label text will most likely be based on custom properties passed along with the data model.
                </p>

                <p>
                  The signature of the decorator callback should be the following:
                </p>

                <p>
                  <code>function (options, properties, variables)</code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>options</dt>
                  <dd>all current visualization options (keys and values).</dd>

                  <dt>properties</dt>
                  <dd>
                    <p>
                      an object with properties describing the group being decorated. The object will be a union of
                      objects retrieved from the <code>hierarchy</code>, <code>state</code> and <code>geometry</code>
                      options.
                    </p>
                  </dd>

                  <dt>variables</dt>
                  <dd>
                    <p>
                      object with label-related variables this function can change.
                    </p>

                    <p>
                      The following variables are available:
                    </p>

                    <dl class="dl-horizontal narrow">
                      <dt>labelText</dt>
                      <dd>the default text of the label, equal to the <code>label</code> property of the group's data object.</dd>
                    </dl>
                  </dd>
                </dl>

                <p>
                  The following example upper cases all group and adds angle quotes around them. Note how the quotes
                  are separated from the main label by the non-breakable space unicode to ensure the quotes are not left
                  as the only characters in the line. See the documentation for the <code>dataObject</code> option
                  for a list of other special characters supported by FoamTree.
                </p>
                <pre class="partial executable example">
foamtree.set({
  groupLabelDecorator: function(opts, props, vars) {
    vars.labelText = "\u00a0" + vars.labelText.toLocaleUpperCase() + "\u00a0";
  }
});</pre>
              </section>

              <section id="groupLabelLineHeight" class="api">
                <h3>groupLabelLineHeight</h3>

                <p>
                  The line height to use when rendering labels in multiple lines.
                </p>
              </section>

              <section id="groupLabelHorizontalPadding" class="api">
                <h3>groupLabelHorizontalPadding</h3>

                <p>
                  The padding to add on the left and right of the label, in current font size unit.
                </p>
              </section>

              <section id="groupLabelVerticalPadding" class="api">
                <h3>groupLabelVerticalPadding</h3>

                <p>
                  The padding to add on the top and bottom of the label, in current font size unit.
                </p>
              </section>

              <section id="groupLabelMaxTotalHeight" class="api">
                <h3>groupLabelMaxTotalHeight</h3>

                <p>
                  The maximum total height of the label in relation to the height of the group's polygon.
                </p>
              </section>

              <section id="groupLabelUpdateThreshold" class="api">
                <h3>groupLabelUpdateThreshold</h3>

                <p>
                  Every time the geometry of the group's polygon changes, FoamTree needs to decide whether to
                  re-layout the label text. The <code>groupLabelUpdateThreshold</code> determines how much must
                  the area of the polygon change for FoamTree to re-layout the label. For example, if the value
                  of the threshold is <code>0.05</code>, FoamTree will re-layout the label when the area of the
                  polygon is larger or smaller by 5% or more.
                </p>

                <p>
                  Setting <code>groupLabelUpdateThreshold</code> to <code>0</code> will cause FoamTree to re-layout
                  the label on every group polygon change. Depending on the size of the data set, it may significantly
                  slow down visualization rendering when <code>relaxationVisible</code> is <code>true</code>.
                </p>
              </section>

              <section id="groupLabelColorThreshold" class="api">
                <h3>groupLabelColorThreshold</h3>

                <p>
                  Picks the label color automatically depending on the group's color brightness. If the
                  brightness is below this threshold <code>groupLabelLightColor</code> is used, otherwise
                  <code>groupLabelDarkColor</code> is used. Setting the threshold to either 0 or 1 will pick
                  dark or light labels, correspondingly.
                </p>

                <p>
                  Automatic choice of label colors is also provided as part of <code>groupColorDecorator</code>'s
                  functionality.
                </p>
              </section>

              <section id="groupLabelDarkColor" class="api">
                <h3>groupLabelDarkColor</h3>

                <p>The label color to use on bright groups (see <code>groupLabelColorThreshold</code>).</p>
              </section>

              <section id="groupLabelLightColor" class="api">
                <h3>groupLabelLightColor</h3>

                <p>The label color to use on dark groups (see <code>groupLabelColorThreshold</code>).</p>
              </section>
            </section>

            <section id="options-group-exposure" class="api-group">
              <h2>Group exposure</h2>

              <p>
                Options described in this section determine how FoamTree draws and decorates exposed groups.
              </p>

              <section id="groupExposureScale" class="api">
                <h3>groupExposureScale</h3>

                <p>
                  The magnification scale at which exposed groups will be drawn. If you set <code>groupExposureScale</code>
                  to <code>1.0</code>, exposed groups will be drawn at the same scale as the unexposed groups.
                </p>
              </section>

              <section id="groupExposureShadowColor" class="api">
                <h3>groupExposureShadowColor</h3>

                <p>
                  The color of drop shadow to apply to exposed groups.
                </p>
              </section>

              <section id="groupExposureShadowSize" class="api">
                <h3>groupExposureShadowSize</h3>

                <p>
                  The size of drop shadow to apply to exposed groups, in pixels.
                </p>
              </section>

              <section id="groupExposureZoomMargin" class="api">
                <h3>groupExposureZoomMargin</h3>

                <p>
                  The margin size to apply when zooming to the exposed group, relative to the group polygon's bounding
                  box dimensions. If <code>groupExposureZoomMargin</code> is <code>0</code>, the exposed group will
                  occupy the full height / width of the view port. For larger values, a zoom margin will be added
                  around the exposed group. The larger the value, the larger margin will be applied.
                </p>
              </section>

              <section id="groupUnexposureLightnessShift" class="api">
                <h3>groupUnexposureLightnessShift</h3>

                <p>
                  The amount of lightness to add or subtract from the groups base color's lightness when
                  the group is unexposed.
                </p>
              </section>

              <section id="groupUnexposureSaturationShift" class="api">
                <h3>groupUnexposureSaturationShift</h3>

                <p>
                  The amount of saturation to add or subtract from the groups base color's saturation when
                  the group is unexposed.
                </p>
              </section>

              <section id="groupUnexposureLabelColorThreshold" class="api">
                <h3>groupUnexposureLabelColorThreshold</h3>

                <p>
                  The <code>labelColorThreshold</code> value to use for unexposed groups. When the colors of
                  unexposed groups are significantly modified using the <code>groupUnexposureLightnessShift</code>
                  and <code>groupUnexposureSaturationShift</code> options, you may want to modify this threshold to,
                  for example, always draw the labels of unexposed groups in the dark color.
                </p>
              </section>

              <section id="exposeDuration" class="api">
                <h3>exposeDuration</h3>

                <p>
                  The duration of the group exposure and unexposure animation.
                </p>
              </section>

              <section id="exposeEasing" class="api">
                <h3>exposeEasing</h3>

                <p>
                  The easing function to use during group exposure and unexposure animations. Meaningful only when
                  <code>exposeDuration</code> is larger than <code>0</code>.
                </p>
              </section>
            </section>


            <section id="options-group-opening-closing" class="api-group">
              <h2>Group opening/closing</h2>

              <section id="openCloseDuration" class="api">
                <h3>openCloseDuration</h3>

                <p>
                  The duration of the group opening or closing animation.
                </p>
              </section>
            </section>


            <section id="options-group-hierarchy" class="api-group">
              <h2>Group hierarchy</h2>

              <p>
                Options in this group determine how the stacked polygons representing the hierarchy of groups will be
                drawn.
              </p>

              <section id="parentFillOpacity" class="api">
                <h3>parentFillOpacity</h3>

                <p>
                  The opacity to use when filling groups that have child groups. By default, the parent group
                  is drawn semi-transparent to indicate that the group has child groups that can be
                  browsed. If you set <code>parentFillOpacity</code> to <code>1.0</code>, the parent group will
                  be fully opaque and the child groups will not be visible until the group gets open. If you set
                  <code>parentFillOpacity</code> to <code>0.0</code>, the parent group's polygon will not be filled
                  at all and the child groups will be fully visible at all times.
                </p>
              </section>

              <section id="parentStrokeOpacity" class="api">
                <h3>parentStrokeOpacity</h3>

                <p>
                  The opacity to use when drawing strokes of groups that have child groups.
                </p>
              </section>

              <section id="parentLabelOpacity" class="api">
                <h3>parentLabelOpacity</h3>

                <p>
                  The opacity to use when drawing labels of groups that have child groups.
                </p>
              </section>

              <section id="parentOpacityBalancing" class="api">
                <h3>parentOpacityBalancing</h3>

                <p>
                  When set to <code>true</code>, FoamTree will try to equalize the opacity of groups' polygons, so
                  that the aggregated opacity of, for example, a group with 3 levels of child groups and a group
                  without child groups will be roughly the same. Opacity equalization will usually lead to a more
                  uniform look of the whole visualization area.
                </p>

                <p>
                  Opacity balancing will only be applied when the base color of the group
                  is not fully opaque, that is when its alpha component is less than 1.
                </p>
              </section>
            </section>


            <section id="options-group-colors" class="api-group">
              <h2>Group colors</h2>

              <p>
                This section describes options that determine the base colors assigned for groups.
              </p>

              <section id="rainbowStartColor" class="api">
                <h3>rainbowStartColor</h3>

                <p>
                  Start color to use if rainbow color model is used for coloring groups. The rainbow color model
                  will radially or linearly spread the color hue among top-level groups, starting at <code>rainbowStartColor</code>
                  and ending at <code>rainbowEndColor</code>. Sub-groups will be painted with the parent group's hue
                  but with varying degrees of saturation and lightness.
                </p>

                <p>For custom coloring of groups, use <code>groupColorDecorator</code>.</p>
              </section>

              <section id="rainbowEndColor" class="api">
                <h3>rainbowEndColor</h3>
                <p>
                  End color to use if rainbow color model is used for coloring groups. See <code>rainbowStartColor</code>
                  for a description of how the rainbow color model works.
                </p>
              </section>

              <section id="rainbowColorDistribution" class="api">
                <h3>rainbowColorDistribution</h3>

                <p>
                  Determines how the rainbow colors will be distributed. You can use one of the following values:
                </p>

                <dl class="dl-horizontal">
                  <dt>radial</dt>
                  <dd>distributes the colors radially around the center of the visualization area</dd>

                  <dt>linear</dt>
                  <dd>distributes the colors linearly across the whole visualization area</dd>
                </dl>

                <p>
                  You can use the <code>rainbowColorDistributionAngle</code> option to further tune the color distribution.
                </p>
              </section>

              <section id="rainbowColorDistributionAngle" class="api">
                <h3>rainbowColorDistributionAngle</h3>

                <p>
                  When <code>rainbowColorDistribution</code> is <code>radial</code>, determines the angle at which
                  the rainbow color will start. Change the the values of this option, to rotate the rainbow around the
                  central point of the visualization area.
                </p>

                <p>
                  When <code>rainbowColorDistribution</code> is <code>linear</code>, determines the angle of the
                  linear gradient formed by the rainbow color transition.
                </p>
              </section>

              <section id="rainbowLightnessDistributionAngle" class="api">
                <h3>rainbowLightnessDistributionAngle</h3>

                <p>
                  Determines the angle of the linear gradient formed by the color lightness variations created
                  for lower-level groups.
                </p>
              </section>

              <section id="rainbowSaturationCorrection" class="api">
                <h3>rainbowSaturationCorrection</h3>

                <p>
                  When <code>rainbowColorDistribution</code> is <code>radial</code>, FoamTree can desaturate
                  colors of the polygons lying close to the center of the visualization area to make the
                  color transitions smoother.
                </p>

                <p>
                  You can use the <code>rainbowLightnessCorrection</code> option to vary the strength of this correction.
                  The value of <code>0</code> will moderately decrease the saturation, the value of <code>-1</code>
                  will strongly desaturate the center groups. Finally, set the correction to <code>1</code> to disable
                  correction decreases completely.
                </p>
              </section>

              <section id="rainbowLightnessCorrection" class="api">
                <h3>rainbowLightnessCorrection</h3>

                <p>
                  When <code>rainbowColorDistribution</code> is <code>radial</code>, FoamTree can adjust the lightness
                  of colors of the polygons lying close to the center of the visualization area to make the
                  color transitions smoother.
                </p>

                <p>
                  You can use the <code>rainbowLightnessCorrection</code> option to vary the strength of this
                  adjustment. The value of <code>0</code> means no adjustment. The value of <code>-1</code>
                  will strongly decrease the lightness of the center groups. Finally, the value of <code>1</code>
                  will strongly increase the lightness of the central groups.
                </p>
              </section>

              <section id="rainbowLightnessShift" class="api">
                <h3>rainbowLightnessShift</h3>

                <p>
                  Determines the strength of the color lightness variations applied to lower-level groups.
                </p>
              </section>

              <section id="rainbowLightnessShiftCenter" class="api">
                <h3>rainbowLightnessShiftCenter</h3>

                <p>
                  Determines the central lightness value around which the lightness variations will be applied
                  for the lower-level groups.
                </p>
              </section>

              <section id="groupColorDecorator" class="api">
                <h3>groupColorDecorator</h3>

                <p>
                  A callback function you can use to customize or completely replace the default rainbow color model for
                  groups. During each redraw, the visualization code will call the provided function once for each
                  group. The task of the function is to modify or completely replace the default color of the group and
                  its label. New colors can be derived from various properties of the group, such as its nesting level,
                  number of siblings, or custom properties passed along with the data model.
                </p>

                <p>
                  The signature of the decorator callback should be the following:
                </p>

                <p>
                  <code>function (options, properties, variables)</code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>options</dt>
                  <dd>all current visualization options (keys and values).</dd>

                  <dt>properties</dt>
                  <dd>
                    an object with properties describing the group being decorated. The object will be a union of
                    objects retrieved from the <code>hierarchy</code>, <code>state</code> and <code>geometry</code>
                    options.
                  </dd>

                  <dt>variables</dt>
                  <dd>
                    <p>
                      an object with two properties: <code>groupColor</code>, containing the group color computed by the
                      default rainbow color model, and <code>labelColor</code> always equal to <code>auto</code>. The
                      callback function can either change some of the properties of <code>groupColor</code> or replace
                      any of the colors with a new object representing the color to use.
                    </p>

                    <p>
                      The callback function can replace these values with a CSS3 color string (<code>hsl</code>,
                      <code>hsla</code>, <code>rgb</code> or <code>rgba</code> color specification)
                      or an object containing the following properties:
                    </p>

                    <ul>
                      <li>
                        <code>model</code>: <code>rgba</code> for the RGBA model, <code>hsla</code> for the HSLA model.
                        When adding or changing the values of other properties, it is important to
                        set this property to reflect the desired color model.
                      </li>

                      <li>
                        <code>r</code>, <code>g</code>, <code>b</code>, <code>a</code>: RGBA values (integers in the 0..255 range).
                      </li>

                      <li>
                        <code>h</code>, <code>s</code>, <code>l</code>, <code>a</code>: HSLA values, hue is an angle (0..359), saturation
                        and lightness are percentages (0..100) and transparency is a range between 0 and 1.
                      </li>
                    </ul>

                    <p>
                      The default values computed by the rainbow color model are always passed to the callback
                      in the HSLA format described above.
                    </p>

                    <p>
                      The <code>labelColor</code> variable can be set to a string value of <code>auto</code> which will
                      recompute the label color again depending on the updated <code>groupColor</code> and
                      visualization options controlling dark/ light label colors: <code>labelColorThreshold</code>,
                      <code>labelLightColor</code> and <code>labelDarkColor</code>.
                    </p>
                  </dd>
                </dl>

                <h4>Colors defined in the data model</h4>
                <p>The simplest color model could just use explicit color values provided as part of the data model.</p>
                <pre class="partial executable example">
foamtree.set({
  dataObject: {
    groups: [
      { label: "C", color: "#00aeef" },
      { label: "M", color: "#ec008c" },
      { label: "Y", color: "#fff200" },
      { label: "K", color: "#231f20" }
    ]
  },
  groupColorDecorator: function (opts, params, vars) {
    vars.groupColor = params.group.color;
    vars.labelColor = "auto";
  }
});</pre>

                <h4>Colors depending on group state</h4>
                <p>
                  By default, FoamTree modifies the base group color depending on the state of the group. This
                  behaviour is determined by such properties as <code>groupSelectionStrokeLightnessShift</code> or
                  <code>groupHoverFillLightnessShift</code> and usually makes the selected or hovered-on group lighter.
                  To achieve even greater customization, you can use the group state information in the
                  decorator:
                </p>
                <pre class="partial executable example">
foamtree.set({
  dataObject: {
    groups: [
      { label: "C", color: "#00aeef" },
      { label: "M", color: "#ec008c" },
      { label: "Y", color: "#fff200" },
      { label: "K", color: "#231f20" }
    ]
  },
  groupColorDecorator: function (opts, params, vars) {
    if (params.selected) {
      vars.groupColor = "#fff";
      vars.labelColor = params.group.color;
    } else {
      vars.groupColor = params.group.color;
      vars.labelColor = "#fff";
    }
  }
});</pre>

                <h4>Colors derived from custom properties of the data model</h4>
                <p>
                  Most commonly, polygon colors will depend on some domain-specific properties of the groups.
                  For instance, if FoamTree is used to visualize a group of news stories and each story
                  has been tagged with sentiment information (positive, negative, neutral), the color could reflect the
                  sentiment. In the example shown below, we draw positive news in green, negative in red
                  and neutral in grey.
                </p>

                <pre class="partial executable example">
foamtree.set({
  groupColorDecorator: function(opts, params, vars) {
    // Sentiment is a custom property with values in the -1..+1 range.
    // -1 means negative sentiment, +1 -- positive, 0 -- neutral.
    var sentiment = params.group.sentiment;
    if (sentiment === undefined) {
      // Make neutral groups grey
      vars.groupColor.s = 0;
      vars.groupColor.l = 0;
      vars.groupColor.a = 0.2;
    } else {
      if (sentiment > 0) {
        // Make positive groups green
        vars.groupColor.h = 120;
      } else {
        // Make negative groups red
        vars.groupColor.h = 0;
      }

      // Make saturation and lightness depend on
      // the strength of the sentiment.
      vars.groupColor.s = 50 * (1 + Math.abs(sentiment));
      vars.groupColor.l = Math.abs(60 * sentiment);
      vars.groupColor.a = 0.5;
    }
    // Indicate that we use the HSLA model
    vars.groupColor.model = "hsla";
  },
  dataObject: {
    groups: [
      { label: "Bad news", groups: [
        { label: "Last penny lost", sentiment: -0.5 },
        { label: "Bazinga doomed",  sentiment: -1 }
        ]},
      { label: "Good news", groups: [
        { label: "iPads under $100",      sentiment: 0.5 },
        { label: "Martians are friendly", sentiment: 1 }
        ]},
      { label: "Other news", groups: [
        { label: "Vampires on the loose", sentiment: 0 },
        { label: "Van Helsing to the rescue", sentiment: 0 }
        ]}
    ]
  }
});</pre>

                <h4>Animated colors</h4>

                <p>
                  Finally, you can create an animated color model by making the color decorator a
                  time-dependant function and periodically redrawing the visualization using the <code>redraw</code>
                  method. The example below creates a simple radar-like animation. For faster drawing,
                  we set <code>groupFillType</code> to <code>plain</code> and <code>groupStrokeType</code>
                  to <code>none</code>.
                </p>
                <pre class="hidden" id="stopAnimation">
running = false;</pre>
                <pre class="partial empty executable example" data-runafter="stopAnimation">
var frame = 0;
var running = true;
foamtree.set({
  groupColorDecorator: function(opts, params, vars) {
    // We change the color only for top-level groups. For child groups,
    // FoamTree will generate brightness variations of the parent group's color.
    if (params.level == 0) {
      var delay = 5;
      var count = 3;
      var frameDiv = Math.floor(frame / delay);
      var mod = frameDiv % params.siblingCount;
      var diff = (mod - params.index + params.siblingCount)
                   % params.siblingCount;
      if (diff < count) {
        vars.groupColor.g = 255 *
          (1 - ((diff * delay + frame % delay) / (delay * count)));
      } else {
        vars.groupColor.g = 40;
      }
      vars.groupColor.r = 40;
      vars.groupColor.b = 40;
      vars.groupColor.model = "rgb";
    }
  },
  dataObject: {
    groups: (function() {
      var arr = [];
      for (var i = 0; i < 50; i++) {
        arr.push({
          label: "",
          weight: Math.pow(Math.random(), 3) * 0.8 + 0.2,
          groups: [ { label: "" }, { label: "" }, { label: "" }]
        });
      }
      return arr;
    })()
  },
  groupFillType: "plain",
  groupStrokeType: "none"
});

// Redraw the visualization periodically. Although we use setTimeout()
// here, use the requestAnimationFrame() when possible.
setTimeout(function redraw() {
  if (!running) { // stopped?
    return;
  }
  foamtree.redraw(true);
  frame++;
  setTimeout(redraw, 16); // next frame
}, 16);</pre>
              </section>
            </section>


            <section id="options-rollout" class="api-group">
              <h2>Rollout</h2>

              <p>
                You can use options described in this section to change the animation FoamTree uses to show
                a new data set. By changing various rollout properties you can create many different animation styles.
              </p>

              <section id="rolloutStartPoint" class="api">
                <h3>rolloutStartPoint</h3>

                <p>
                  The point in the visualization container area at which the rollout will start. The following start
                  point values are allowed:
                </p>

                <dl class="dl-horizontal">
                  <dt>center</dt>
                  <dd>rollout will start from the group lying closest to the center of the visualization container</dd>

                  <dt>topleft</dt>
                  <dd>rollout will start from the group lying closest to the top-left corner of the visualization container</dd>

                  <dt>bottomright</dt>
                  <dd>rollout will start from the group lying closest to the bottom-right corner of the visualization container</dd>

                  <dt>random</dt>
                  <dd>rollout will start from a random group</dd>
                </dl>
              </section>

              <section id="rolloutMethod" class="api">
                <h3>rolloutMethod</h3>

                <p>
                  FoamTree will start the rollout animation from the group determined using the <code>rolloutStartPoint</code>
                  option. Then, further polygons will be included in the animation, depending on the value of this option:
                </p>

                <dl class="dl-horizontal">
                  <dt>groups</dt>
                  <dd>
                    <p>
                      on each animation step, all neighbors of the groups already being animated will be included in
                      the animation, which will create a sort of ripple effect as shown in the following example.
                    </p>

                    <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(200) },

  // Roll out in groups
  rolloutMethod: "groups",

  // Create a gentle scaling effect
  rolloutDuration: 6000,
  rolloutEasing: "bounce",
  rolloutScalingStrength: -0.4,
  rolloutRotationStrength: 0,
  rolloutPolygonDrag: 0.08
});</pre>
                  </dd>

                  <dt>individual</dt>
                  <dd>
                    <p>
                      on each animation step only one neighbor of the groups already being animated will be included in
                      the animation. When using this rollout method, you may want to decrease <code>rolloutPolygonDrag</code>
                      to make the animation progress smoother.
                    </p>
                    <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(200) },

  // Roll out each group individually
  rolloutMethod: "individual",

  // Create a gentle scaling effect
  rolloutDuration: 4000,
  rolloutEasing: "bounce",
  rolloutScalingStrength: -0.4,
  rolloutRotationStrength: 0,
  rolloutPolygonDrag: 0.015
});</pre>
                  </dd>
                </dl>
              </section>

              <section id="rolloutDuration" class="api">
                <h3>rolloutDuration</h3>

                <p>
                  The duration of the rollout animation at one level of the hierarchy, in milliseconds. The duration of the complete
                  animation is variable and depends on the number of hierarchy levels and the <code>rolloutChildGroupsDrag</code>
                  and <code>rolloutChildGroupsDelay</code> options.
                </p>
              </section>

              <section id="rolloutEasing" class="api">
                <h3>rolloutEasing</h3>

                <p>
                  The animation easing function to use during rollout animation.
                </p>
              </section>

              <section id="rolloutScalingStrength" class="api">
                <h3>rolloutScalingStrength</h3>

                <p>
                  Determines the initial scale to set for each polygon at the start of the rollout. During the rollout
                  animation the initial scale will be transitioned to the neutral value.
                </p>

                <p>
                  When <code>rolloutScalingStrength</code> is <code>-1</code>, the initial scale will be minus infinity
                  making the polygon appear at infinite distance in front of the user. When <code>rolloutScalingStrength</code>
                  is <code>1</code>, the initial scale will be plus infinity making the polygon appear at infinite
                  distance behind the user. All intermediate values are allowed and will set the initial scale to the
                  appropriate proportion between the extremes. When <code>rolloutScalingStrength</code> is <code>0</code>,
                  the initial scale will be equal to the neutral scale.
                </p>

                <p>
                  The following examples demonstrate the rollout animation for negative and positive values of the
                  <code>rolloutScalingStrength</code> option. Both examples set <code>rolloutTransformationCenter</code>
                  to <code>0</code> so that the origin of the scaling is the center of the visualization container.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                    <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(100) },

  rolloutScalingStrength: -0.5,

  rolloutDuration: 4000,
  rolloutRotationStrength: 0,
  rolloutTransformationCenter: 0
});</pre>
                  </div>

                  <div class="col-sm-6">
                    <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(100) },

  rolloutScalingStrength: 1,

  rolloutDuration: 4000,
  rolloutRotationStrength: 0,
  rolloutTransformationCenter: 0
});</pre>
                  </div>
                </div>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>

                  <p>
                    When visualizing hierarchical models, setting a positive <code>rolloutScalingStrength</code>
                    may create unpleasant effects because child groups will be drawn on top of their parents
                    during the animation as shown in the following example. For this reason, you may want to
                    use negative scaling strengths for hierarchical data.
                  </p>


                  <pre class="partial empty executable example">
foamtree.set({
  dataObject: largeDataSet,

  rolloutScalingStrength: 0.5,

  rolloutDuration: 4000,
  rolloutRotationStrength: 0,
  rolloutTransformationCenter: 0
});</pre>
                </div>
              </section>

              <section id="rolloutTranslationXStrength" class="api">
                <h3>rolloutTranslationXStrength</h3>

                <p>
                  Determines the initial horizontal translation to apply to each polygon at the start of the rollout.
                  The rollout animation will transition the initial translation to the neutral value. The unit of the
                  translation is the width of the parent polygon's bounding box. Fox example, the value of <code>-0.5</code>
                  means the translation to the left by half of the width of the parent box.
                </p>
              </section>

              <section id="rolloutTranslationYStrength" class="api">
                <h3>rolloutTranslationYStrength</h3>

                <p>
                  Determines the initial vertical translation to apply to each polygon at the start of the rollout.
                  The rollout animation will transition the initial translation to the neutral value. The unit of the
                  translation is the height of the parent polygon's bounding box. Fox example, the value of <code>0.5</code>
                  means the translation to the bottom by half of the height of the parent box.
                </p>
              </section>

              <section id="rolloutRotationStrength" class="api">
                <h3>rolloutRotationStrength</h3>

                <p>
                  Determines the initial rotation to apply to each polygon at the start of the rollout.
                  The rollout animation will transition the initial rotation to the neutral value. Rotation of
                  <code>1.0</code> means 180 degrees clockwise.
                </p>
              </section>

              <section id="rolloutTransformationCenter" class="api">
                <h3>rolloutTransformationCenter</h3>

                <p>
                  Determines the point relative to which the rollout transformations will be taken. The value of
                  <code>0.0</code> means the center of the parent group's polygon, <code>1.0</code> means the
                  center of the currently animated polygon. Intermediate values set the transformation center
                  at the appropriate linear combination of the above extremes.
                </p>

                <p>
                  The following examples demonstrate the difference between the <code>rolloutTransformationCenter</code>
                  extremes.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                    <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(100) },

  rolloutTransformationCenter: 0,

  rolloutDuration: 4000,
  rolloutRotationStrength: -0.3,
  rolloutScalingStrength: 0,
  rolloutEasing: "squareInOut"
});</pre>
                  </div>

                  <div class="col-sm-6">
                    <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(100) },

  rolloutTransformationCenter: 1,

  rolloutDuration: 4000,
  rolloutRotationStrength: -0.3,
  rolloutScalingStrength: 0,
  rolloutEasing: "squareInOut"
});</pre>
                  </div>
                </div>
              </section>

              <section id="rolloutPolygonDrag" class="api">
                <h3>rolloutPolygonDrag</h3>

                <p>
                  The amount of delay to apply before starting the rollout of subsequent groups on the same level of
                  hierarchy. The delay will be computed by multiplying <code>rolloutDuration</code> by the value of
                  this option.
                </p>
              </section>

              <section id="rolloutPolygonDuration" class="api">
                <h3>rolloutPolygonDuration</h3>

                <p>
                  Determines the duration of the polygon rollout animation, as a fraction of
                  <code>rolloutDuration</code>.
                </p>
              </section>

              <section id="rolloutLabelDelay" class="api">
                <h3>rolloutLabelDelay</h3>

                <p>
                  Determines the delay to apply before showing the group's label during rollout, as a fraction of
                  <code>rolloutDuration</code>.
                </p>

                <p>
                  Note that when <code>wireframeLabelDrawing</code> is set to <code>never</code>, group labels will not
                  be drawn at all during rollout. When <code>wireframeLabelDrawing</code> is set to <code>auto</code>,
                  labels may or may not be drawn during the rollout, depending on the performance of the device and the
                  size of the data set. To force FoamTree to draw labels during the rollout animation, set <code>wireframeLabelDrawing</code>
                  to <code>always</code>.
                </p>
              </section>

              <section id="rolloutLabelDrag" class="api">
                <h3>rolloutLabelDrag</h3>

                <p>
                  The amount of delay to apply before revealing the labels of subsequent groups on the same level of
                  hierarchy. The delay will be computed by multiplying <code>rolloutDuration</code> by the value of
                  this option.
                </p>
              </section>

              <section id="rolloutLabelDuration" class="api">
                <h3>rolloutLabelDuration</h3>

                <p>
                  Determines the duration of the label fading-in animation, as a fraction of
                  <code>rolloutDuration</code>.
                </p>
              </section>

              <section id="rolloutChildGroupsDelay" class="api">
                <h3>rolloutChildGroupsDelay</h3>

                <p>
                  The amount of delay to apply before starting the rollout of child groups of a parent group,
                  as a fraction of <code>rolloutDuration</code>. If you set <code>rolloutChildGroupsDelay</code>
                  to <code>0</code>, groups at all levels will start their rollout animations at the same time.
                </p>
              </section>

              <section id="rolloutChildGroupsDrag" class="api">
                <h3>rolloutChildGroupsDrag</h3>

                <p>
                  The amount of delay to apply before starting the rollout of child groups of subsequent parent groups
                  groups on the same level of hierarchy. The delay will be computed by multiplying
                  <code>rolloutDuration</code> by the value of this option.
                </p>
              </section>
            </section>

            <section id="options-pullback" class="api-group">
              <h2>Pullback</h2>

              <p>
                You can use options described in this section to change the animation FoamTree uses to hide the current
                data set before showing a new one. By changing various rollout properties you can create many different
                animation styles. Many of the pullback options are similar to their <a href="#options-rollout">rollout</a>
                counterparts.
              </p>


              <section id="pullbackStartPoint" class="api">
                <h3>pullbackStartPoint</h3>

                <p>
                  The point in the visualization container area at which the pullback will start. The following start
                  point values are allowed:
                </p>

                <dl class="dl-horizontal">
                  <dt>center</dt>
                  <dd>pullback will start from the group lying closest to the center of the visualization container</dd>

                  <dt>topleft</dt>
                  <dd>pullback will start from the group lying closest to the top-left corner of the visualization container</dd>

                  <dt>bottomright</dt>
                  <dd>pullback will start from the group lying closest to the bottom-right corner of the visualization container</dd>

                  <dt>random</dt>
                  <dd>pullback will start from a random group</dd>
                </dl>
              </section>

              <section id="pullbackMethod" class="api">
                <h3>pullbackMethod</h3>

                <p>
                  FoamTree will start the pullback animation from the group determined using the <code>pullbackStartPoint</code>
                  option. Then, further polygons will be included in the animation, depending on the value of this option:
                </p>

                <dl class="dl-horizontal">
                  <dt>groups</dt>
                  <dd>
                    <p>
                      on each animation step, all neighbors of the groups already being animated will be included in
                      the animation, which will create a sort of ripple effect as shown in the following example.
                    </p>

                    <pre class="partial empty executable example" data-runafter="clearTimeout">
// Set initial data
foamtree.set({
  dataObject: { groups: randomGroups(200) }
});

// Pull back after a while
var timeout = setTimeout(function() {
  foamtree.set({
    dataObject: null,

    // Roll out in groups
    pullbackMethod: "groups",

    // Create a gentle scaling effect
    pullbackDuration: 3000,
    pullbackEasing: "quadOut",
    pullbackScalingStrength: -0.4,
    pullbackRotationStrength: 0,
    pullbackPolygonDrag: 0.08
  });
}, 1000);</pre>
                  </dd>

                  <dt>individual</dt>
                  <dd>
                    <p>
                      on each animation step only one neighbor of the groups already being animated will be included in
                      the animation. When using this rollout method, you may want to decrease <code>rolloutPolygonDrag</code>
                      to make the animation progress smoother.
                    </p>
                    <pre class="partial empty executable example" data-runafter="clearTimeout">
// Set initial data
foamtree.set({
  dataObject: { groups: randomGroups(200) }
});

// Pull back after a while
var timeout = setTimeout(function() {
  foamtree.set({
    dataObject: null,

    // Roll out in groups
    pullbackMethod: "individual",

    // Create a gentle scaling effect
    pullbackDuration: 3000,
    pullbackEasing: "quadOut",
    pullbackScalingStrength: -0.4,
    pullbackRotationStrength: 0,
    pullbackPolygonDrag: 0.015
  });
}, 1000);</pre>
                  </dd>
                </dl>
              </section>

              <section id="pullbackDuration" class="api">
                <h3>pullbackDuration</h3>

                <p>
                  The duration of the pullback animation, in milliseconds.
                </p>
              </section>

              <section id="pullbackEasing" class="api">
                <h3>pullbackEasing</h3>

                <p>
                  The animation easing function to use during pullback animation.
                </p>
              </section>

              <section id="pullbackScalingStrength" class="api">
                <h3>pullbackScalingStrength</h3>

                <p>
                  Determines the target scale for each polygon to achieve at the end of the pullback animation.
                </p>

                <p>
                  When <code>pullbackScalingStrength</code> is <code>-1</code>, the target scale will be minus infinity
                  making the polygon appear at infinite distance in front of the user. When <code>pullbackScalingStrength</code>
                  is <code>1</code>, the target scale will be plus infinity making the polygon appear at infinite
                  distance behind the user. All intermediate values are allowed and will set the target scale to the
                  appropriate proportion between the extremes. When <code>pullbackScalingStrength</code> is <code>0</code>,
                  the target scale will be equal to the neutral scale.
                </p>

                <p>
                  The following examples demonstrate the pullback animation for negative and positive values of the
                  <code>pullbackScalingStrength</code> option. Both examples set <code>pullbackTransformationCenter</code>
                  to <code>0</code> so that the origin of the scaling is the center of the visualization container.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                    <pre class="partial empty executable example" data-runafter="clearTimeout">
// Set initial data
foamtree.set({
  dataObject: { groups: randomGroups(200) }
});

// Pull back after a while
var timeout = setTimeout(function() {
  foamtree.set({
    dataObject: null,

    pullbackScalingStrength: -0.5,
  
    pullbackDuration: 2500,
    pullbackEasing: "quadIn",
    pullbackRotationStrength: 0,
    pullbackTransformationCenter: 0
  });
}, 1000);</pre>
                  </div>

                  <div class="col-sm-6">
                    <pre class="partial empty executable example" data-runafter="clearTimeout">
// Set initial data
foamtree.set({
  dataObject: { groups: randomGroups(200) }
});

// Pull back after a while
var timeout = setTimeout(function() {
  foamtree.set({
    dataObject: null,

    pullbackScalingStrength: 0.5,

    pullbackDuration: 2500,
    pullbackEasing: "quadOut",
    pullbackRotationStrength: 0,
    pullbackTransformationCenter: 0
  });
}, 1000);</pre>
                  </div>
                </div>
              </section>

              <section id="pullbackTranslationXStrength" class="api">
                <h3>pullbackTranslationXStrength</h3>

                <p>
                  Determines the target horizontal translation for each polygon to achieve at the end of the pullback
                  animation. The unit of the translation is the width of the parent polygon's bounding box. Fox example,
                  the value of <code>-0.5</code> means the translation to the left by half of the width of the parent
                  box.
                </p>
              </section>

              <section id="pullbackTranslationYStrength" class="api">
                <h3>pullbackTranslationYStrength</h3>

                <p>
                  Determines the target vertical translation for each polygon to achieve at the end of the pullback
                  animation. The unit of the translation is the height of the parent polygon's bounding box. Fox example,
                  the value of <code>0.5</code> means the translation to the bottom by half of the height of the parent
                  box.
                </p>
              </section>

              <section id="pullbackRotationStrength" class="api">
                <h3>pullbackRotationStrength</h3>

                <p>
                  Determines the target rotation for each polygon to achieve at the end of the pullback
                  animation. Rotation of <code>1.0</code> means 180 degrees clockwise.
                </p>
              </section>

              <section id="pullbackTransformationCenter" class="api">
                <h3>pullbackTransformationCenter</h3>

                <p>
                  Determines the point relative to which the pullback transformations will be taken. The value of
                  <code>0.0</code> means the center of the parent group's polygon, <code>1.0</code> means the
                  center of the currently animated polygon. Intermediate values set the transformation center
                  at the appropriate linear combination of the above extremes.
                </p>

                <p>
                  The following examples demonstrate the difference between the <code>pullbackTransformationCenter</code>
                  extremes.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                    <pre class="partial empty executable example" data-runafter="clearTimeout">
// Set initial data
foamtree.set({
  dataObject: { groups: randomGroups(100) }
});

// Pull back after a while
var timeout = setTimeout(function() {
  foamtree.set({
    dataObject: null,

    pullbackTransformationCenter: 0,
  
    pullbackDuration: 4000,
    pullbackRotationStrength: -0.3,
    pullbackScalingStrength: 0,
    pullbackEasing: "cubicInOut"
  });
}, 1000);</pre>
                  </div>

                  <div class="col-sm-6">
                    <pre class="partial empty executable example" data-runafter="clearTimeout">
// Set initial data
foamtree.set({
  dataObject: { groups: randomGroups(100) }
});

// Pull back after a while
var timeout = setTimeout(function() {
  foamtree.set({
    dataObject: null,

    pullbackTransformationCenter: 1,

    pullbackDuration: 4000,
    pullbackRotationStrength: -0.3,
    pullbackScalingStrength: 0,
    pullbackEasing: "cubicInOut"
  });
}, 1000);</pre>
                  </div>
                </div>
              </section>

              <section id="pullbackPolygonDelay" class="api">
                <h3>pullbackPolygonDelay</h3>

                <p>
                  The pullback animation will first start hiding groups labels and after a delay the hiding of the
                  polygons will start. This option determines the delay to apply before hiding of the polygons starts.
                  The delay is specified as a fraction of <code>pullbackDuration</code>.
                </p>
              </section>

              <section id="pullbackPolygonDrag" class="api">
                <h3>pullbackPolygonDrag</h3>

                <p>
                  The amount of delay to apply before starting the pullback of subsequent groups on the same level of
                  hierarchy. The delay will be computed by multiplying <code>pullbackDuration</code> by the value of
                  this option.
                </p>
              </section>

              <section id="pullbackPolygonDuration" class="api">
                <h3>pullbackPolygonDuration</h3>

                <p>
                  Determines the duration of the polygon pullback animation, as a fraction of
                  <code>pullbackDuration</code>.
                </p>
              </section>

              <section id="pullbackLabelDelay" class="api">
                <h3>pullbackLabelDelay</h3>

                <p>
                  Determines the delay to apply before hiding group labels during pullback, as a fraction of
                  <code>pullbackDuration</code>.
                </p>
              </section>

              <section id="pullbackLabelDrag" class="api">
                <h3>pullbackLabelDrag</h3>

                <p>
                  The amount of delay to apply before hiding the labels of subsequent groups on the same level of
                  hierarchy. The delay will be computed by multiplying <code>pullbackDuration</code> by the value of
                  this option.
                </p>
              </section>

              <section id="pullbackLabelDuration" class="api">
                <h3>pullbackLabelDuration</h3>

                <p>
                  Determines the duration of the label fading-out animation, as a fraction of
                  <code>pullbackDuration</code>.
                </p>
              </section>

              <section id="pullbackChildGroupsDuration" class="api">
                <h3>pullbackChildGroupsDuration</h3>

                <p>
                  Determines the duration of the sub-group fading-out animation, as a fraction of
                  <code>pullbackDuration</code>.
                </p>
              </section>

              <section id="pullbackChildGroupsDelay" class="api">
                <h3>pullbackChildGroupsDelay</h3>

                <p>
                  Determines the delay to apply before hiding sub-groups during pullback, as a fraction of
                  <code>pullbackDuration</code>.
                </p>
              </section>

              <section id="pullbackChildGroupsDrag" class="api">
                <h3>pullbackChildGroupsDrag</h3>

                <p>
                  The amount of delay to apply before hiding the subgroups of subsequent parent groups on the same level of
                  hierarchy. The delay will be computed by multiplying <code>pullbackDuration</code> by the value of
                  this option.
                </p>
              </section>
            </section>
            
            <section id="options-fading" class="api-group">
              <h2>Fading</h2>

              <p>
                When <code>rolloutDuration</code> or <code>pullbackDuration</code> is <code>0</code>, FoamTree
                will use a simple fade in/out animation to show and hide the visualization. You can use options
                described in this section to customize the fading.
              </p>

              <section id="fadeDuration" class="api">
                <h3>fadeDuration</h3>

                <p>
                  The duration of the fade-in/out animation, in milliseconds. The fading in/out is applied
                  only when <code>rolloutDuration</code> / <code>pullbackDuration</code> is <code>0</code>,
                  otherwise the value of this option is ignored. Set this option to <code>0</code> to disable fading.
                </p>
              </section>

              <section id="fadeEasing" class="api">
                <h3>fadeEasing</h3>

                <p>
                  The easing function to use when performing the fading animation.
                </p>
              </section>
            </section>
            
            <section id="options-zoom" class="api-group">
              <h2>Zoom</h2>

              <p>
                Options in this section customize the way the visualization can be zoomed using the mouse wheel.
              </p>

              <section id="zoomMouseWheelFactor" class="api">
                <h3>zoomMouseWheelFactor</h3>

                <p>
                  The magnification factor to apply when the user zooms in using the mouse wheel. When zooming out,
                  the factor will be <code>1 /</code><code>zoomMouseWheelFactor</code>.
                </p>
              </section>

              <section id="zoomMouseWheelDuration" class="api">
                <h3>zoomMouseWheelDuration</h3>

                <p>
                  The duration of the zoom-in/out animation, in milliseconds.
                </p>
              </section>

              <section id="zoomMouseWheelEasing" class="api">
                <h3>zoomMouseWheelEasing</h3>

                <p>
                  The easing function to apply to the zoom animation.
                </p>
              </section>
            </section>
            
            <section id="options-title-bar" class="api-group">
              <h2>Title bar</h2>

              <section id="titleBarFontFamily" class="api">
                <h3>titleBarFontFamily</h3>

                <p>
                  Font family for the title bar, if shown. CSS-compliant font family specifications are supported,
                  including webfonts imported using the <code>@font-face</code> syntax. If not specified, the same font
                  as specified for the <code>groupLabelFontFamily</code> will be used.
                </p>

                <p>This example renders the title bar in monospace font.</p>
                <pre class="partial executable example">
foamtree.set({
  dataObject: { groups: [
    { label: "ABC123", selected: true },
    { label: "DEF456" }]},
  titleBar: "inscribed",
  titleBarFontFamily: "monospace",
  maxLabelSizeForTitleBar: Number.MAX_VALUE,
  groupLabelFontFamily: "Arial, sans-serif"
});</pre>
              </section>

              <section id="titleBarFontStyle" class="api">
                <h3>titleBarFontStyle</h3>

                <p>
                  Font style for the title bar, if shown. CSS-compliant font style specifications are supported,
                  such as <code>italic</code>. If not specified, <code>groupLabelFontStyle</code> will be used.
                </p>
              </section>

              <section id="titleBarFontWeight" class="api">
                <h3>titleBarFontWeight</h3>

                <p>
                  Font weight for the title bar, if shown. CSS-compliant font weight specifications are supported,
                  such as <code>bold</code>. If not specified, <code>groupLabelFontWeight</code> will be used.
                </p>
              </section>

              <section id="titleBarFontVariant" class="api">
                <h3>titleBarFontVariant</h3>

                <p>
                  Font variant for the title bar, if shown. CSS-compliant font variant specifications are supported,
                  such as <code>small-caps</code>. If not specified, <code>groupLabelFontVariant</code> will be used.
                </p>
              </section>

              <section id="titleBarMinFontSize" class="api">
                <h3>titleBarMinFontSize</h3>

                <p>
                  Minimum font size to use when drawing the title bar's label, in pixels.
                </p>

                <p>
                  Note that setting minimum font size to a large value may result in an empty title bar.
                </p>
              </section>

              <section id="titleBarMaxFontSize" class="api">
                <h3>titleBarMaxFontSize</h3>

                <p>
                  Maximum font size to draw the title bar's label, in pixels.
                </p>
              </section>

              <section id="titleBarBackgroundColor" class="api">
                <h3>titleBarBackgroundColor</h3>

                <p>The background color of the title bar area.</p>
              </section>

              <section id="titleBarTextColor" class="api">
                <h3>titleBarTextColor</h3>

                <p>The text color for drawing labels in the title bar area.</p>
              </section>

              <section id="titleBarTextPaddingLeftRight" class="api">
                <h3>titleBarTextPaddingLeftRight</h3>

                <p>Left and right (horizontal) padding to leave inside the title bar's area.</p>
              </section>

              <section id="titleBarTextPaddingTopBottom" class="api">
                <h3>titleBarTextPaddingTopBottom</h3>

                <p>Top and bottom (vertical) padding to leave inside the title bar's area.</p>
              </section>

              <section id="titleBarDecorator" class="api">
                <h3>titleBarDecorator</h3>

                <p>
                  Allows to customize or completely replace the text displayed in the title bar. By default, FoamTree
                  will display the group's label, but you can use this option to display a different text, e.g. some
                  more details related to the group.
                </p>

                <p>
                  The decorator will be called every time the user's pointer hovers over a group.
                  The signature of the decorator callback should be the following:
                </p>

                <p>
                  <code>function (options, properties, variables)</code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>options</dt>
                  <dd>all current visualization options (keys and values).</dd>

                  <dt>properties</dt>
                  <dd>
                    <p>
                      an object with properties describing the group the user is hovering over. The object will be a union of
                      objects retrieved from the <code>hierarchy</code>, <code>state</code> and <code>geometry</code>
                      options.
                    </p>

                    <p>
                      Additionally, the following title-bar-specific properties are available:
                    </p>

                    <dl class="dl-horizontal narrow">
                      <dt>titleBarWidth</dt>
                      <dd>the width of the title bar area, in pixels</dd>

                      <dt>titleBarHeight</dt>
                      <dd>the height of the title bar area, in pixels</dd>

                      <dt>labelFontSize</dt>
                      <dd>
                        the font size used to draw the actual group label or <code>0</code> if the label is not drawn
                      </dd>

                      <dt>viewportScale</dt>
                      <dd>
                        <span class="label label-default">Since 3.1.0</span> the current viewport scale. Values larger than
                        <code>1</code> mean the viewport is zoomed-in, values smaller than <code>1</code> mean the
                        viewport is zoomed-out, a value of <code>1</code> means the viewport is at its neutral zoom
                        level.
                      </dd>
                    </dl>
                  </dd>

                  <dt>variables</dt>
                  <dd>
                    <p>
                      object with title-bar-related variables this function can change.
                    </p>

                    <p>
                      The following variables are available:
                    </p>

                    <dl class="dl-horizontal">
                      <dt>titleBarText</dt>
                      <dd>
                        the default text for the title bar, equal to the label of the group. If changed to
                        <code>null</code> or <code>undefined</code>, the title bar will not be shown.
                      </dd>

                      <dt>titleBarShown</dt>
                      <dd>
                        <code>true</code> if the group's label is <a href="#maxLabelSizeForTitleBar">small enough</a>
                        for the title bar to show, <code>false</code> otherwise. You can change the value of
                        this variable to force showing or hiding of the title bar.
                      </dd>

                      <dt>titleBarMaxFontSize</dt>
                      <dd>
                        the maximum font size to be used for drawing text in the title bar, by default equal to
                        the <code>titleBarMaxFontSize</code> option. Change this variable to override the
                        the max font size for the currently rendered title bar.
                      </dd>
                    </dl>
                  </dd>
                </dl>

                <p>
                  The following example shows how to use the title bar decorator to display more details
                  about the group. A similar complete example can be found in
                  <a href="../demos/titlebar-details.html" target="_blank">titlebar-details.html</a>.
                </p>

                <pre class="partial executable example">
foamtree.set({
  maxLabelSizeForTitleBar: Number.MAX_VALUE,

  titleBarDecorator: function(options, parameters, variables) {
    variables.titleBarText = "More details about " + parameters.group.label;
  }
});</pre>

                <p>
                  The following example shows how to force showing of the title bar for specific groups.
                </p>

                <pre class="partial executable example">
foamtree.set({
  titleBarDecorator: function(options, parameters, variables) {
    var groupId = parameters.group.id;
    if (groupId === "1" || groupId === "2") {
      variables.titleBarShown = true;
    }
  }
});</pre>
              </section>

              <section id="maxLabelSizeForTitleBar" class="api">
                <h3>maxLabelSizeForTitleBar</h3>

                <p>
                  Maximum group label size in pixels whose label to show in the title bar. Small size of a group may
                  cause its label to be drawn in a small font and thus appear illegible. For this reason, when the user
                  hovers the mouse pointer over a group with a small label, the label can be shown in a dedicated title
                  bar.
                </p>

                <p>
                  The <code>maxLabelSizeForTitleBar</code> defines the threshold below which group labels will be shown
                  in the title bar. Setting <code>maxLabelSizeForTitleBar</code> to <code>0</code> will disable the
                  title bar completely. Setting the option to <code>Number.MAX_VALUE</code> will cause the title bar to
                  appear for all groups.
                </p>
              </section>
            </section>
            
            <section id="options-attribution" class="api-group">
              <h2>Attribution</h2>

              <section id="attributionText" class="api">
                <h3>attributionText</h3>

                <p>
                  The label of the attribution group. If <code>attributionText</code> or <code>attributionLogo</code> is
                  not empty, an extra group is added to the visualization with the provided text and logo. If
                  <code>attributionUrl</code> is not empty, clicking the attribution group will open the provided URL
                  in the browser.
                </p>

                <div class="alert alert-warning showInDemoVersion">
                  <strong>Heads up!</strong>

                  <p>
                    The limited demo version of FoamTree does not allow to disable or change the attribution
                    group. Please <a href="http://carrotsearch.com/foamtree-how-to-order">contact Carrot Search</a> for
                    licensing of a fully customizable distribution.
                  </p>
                </div>
              </section>

              <section id="attributionLogo" class="api">
                <h3>attributionLogo</h3>

                <p>
                  The image to display in the attribution group. The image can be specified
                  as a relative or absolute HTTP URL or a data URI. When using HTTP
                  URLs, the image should to be preloaded before visualization
                  is embedded, otherwise it may not be immediately visible. For this
                  reason, the data URIs are recommended. You can use services like
                  <a href="http://dataurl.net" target="_blank">dataurl.net</a> to convert
                  your images to data URIs.
                </p>

                <p>
                  Since version <span class="label label-default">3.3.1</span>, this option
                  also accepts the <code><a href="https://developer.mozilla.org/en/docs/Web/API/HTMLImageElement.Image">Image</a></code>
                  instances. With this enhancement, you can <a href="../demos/attribution.html" target="_blank">render an SVG
                  attribution logo</a> that will look well regardless of the zoom level.
                </p>

                <div class="alert alert-warning showInDemoVersion">
                  <strong>Heads up!</strong>

                  <p>
                    The limited demo version of FoamTree does not allow to disable or change the attribution
                    group. Please <a href="http://carrotsearch.com/foamtree-how-to-order">contact Carrot Search</a> for
                    licensing of a fully customizable distribution.
                  </p>
                </div>

                <pre class="partial executable example requiresFullVersion">
var logoImage = new Image();
logoImage.src = "../demos/assets/img/logo-stub.png";
logoImage.addEventListener("load", function() {
  // Trigger a reload to show the logo
  foamtree.set("attributionLogo", logoImage.src);
  foamtree.set("dataObject", foamtree.get("dataObject"));
});</pre>
              </section>

              <section id="attributionLogoScale" class="api">
                <h3>attributionLogoScale</h3>

                <p>
                  Determines the scale at which FoamTree should draw the attribution logo. The scale is relative
                  to the bounding box of the group's polygon. A scale of <code>1.0</code> means the logo will
                  take the whole available width or height.
                </p>

                <p>
                  The limited demo version of FoamTree does not allow to change the scale of the attribution group.
                  Please <a href="http://carrotsearch.com/foamtree-how-to-order">contact Carrot Search</a> for
                  licensing of a fully customizable distribution.
                </p>
              </section>

              <section id="attributionUrl" class="api">
                <h3>attributionUrl</h3>

                <p>The URL to open when the user clicks the attribution group, can be undefined.</p>

                <div class="alert alert-warning showInDemoVersion">
                  <strong>Heads up!</strong>

                  <p>
                    The limited demo version of FoamTree does not allow to disable or change the attribution
                    group. Please <a href="http://carrotsearch.com/foamtree-how-to-order">contact Carrot Search</a> for
                    licensing of a fully customizable distribution.
                  </p>
                </div>
              </section>

              <section id="attributionWeight" class="api">
                <h3>attributionWeight</h3>

                <p>
                  Sets the weight of the attribution group in relation to the total weight of the root-level
                  groups. You can use this option to influence the size of the attribution group.
                </p>

                <div class="alert alert-warning showInDemoVersion">
                  <strong>Heads up!</strong>

                  <p>
                    The limited demo version of FoamTree does not allow to set the attribution weight to a value smaller
                    than <code>0.0025</code>. Please <a href="http://carrotsearch.com/foamtree-how-to-order">contact
                    Carrot Search</a> for licensing of a fully customizable distribution.
                  </p>
                </div>
              </section>

              <section id="attributionPosition" class="api">
                <h3>attributionPosition</h3>

                <p>
                  Determines the position of the attribution group relative to the visualization container. The
                  following values are supported:
                </p>

                <dl class="dl-horizontal wide">
                  <dt>topleft</dt>
                  <dd>top-left corner of the visualization container</dd>

                  <dt>bottomright</dt>
                  <dd>bottom-right corner of the visualization container</dd>

                  <dt>random</dt>
                  <dd>a random point on the perimeter of the visualization container</dd>

                  <dt>number in the [0, 360) range</dt>
                  <dd>
                    The angle (in degrees) that determines position on the perimeter of the visualization container,
                    clockwise, starting at the right hand side of the container. For example:
                    <code>0</code> is the right-hand side of the container, <code>45</code> is the bottom-right
                    corner, <code>90</code> is the bottom side of the container etc.
                  </dd>
                </dl>

                <p>
                  <strong>Note:</strong> When <code>layout</code> is <code>ordered</code> or <code>squarified</code>,
                  only the <code>topleft</code> and <code>bottomright</code> attribution group placement is supported.
                  All other values will result in the group being placed in the bottom-right corner of the visualization
                  area.
                </p>

                <p>
                  <strong>Note:</strong> when there is a small number of groups in the visualization, FoamTree may not
                  be able to place the attribution group exactly at the required point.
                </p>

                <p>
                  The following example places the attribution group in the top-right corner of the visualization.
                </p>
                <pre class="partial executable example">
foamtree.set("attributionPosition", 360 - 45);
foamtree.set("dataObject", { groups: randomGroups(25, 1) } );
</pre>
              </section>

              <section id="attributionDistanceFromCenter" class="api">
                <h3>attributionDistanceFromCenter</h3>

                <p><strong>Note</strong>: applicable only when <code>layout</code> is set to <code>relaxed</code>.</p>

                <p>
                  Determines the distance of the attribution group from the center of the visualization area.
                  The distance of <code>0</code> puts the attribution group in the center of the visualization,
                  the distance of <code>1</code> puts the attribution group near the perimeter of the visualization
                  area.
                </p>

                <p>
                  Please note that when there is a small number of groups in the visualization, FoamTree may not
                  be able to place the attribution group exactly at the required point.
                </p>

                <p>
                  The following example attempts to place the attribution group near the center of the visualization area.
                </p>
                <pre class="partial executable example">
foamtree.set("attributionDistanceFromCenter", 0);
foamtree.set("dataObject", { groups: randomGroups(25, 1) } );
</pre>
              </section>
            </section>
            
            <section id="options-rendering" class="api-group">
              <h2>Rendering</h2>

              <section id="pixelRatio" class="api">
                <h3>pixelRatio</h3>

                <p>
                  The physical-to-display pixel count ratio to assume when drawing the final
                  visualization. On modern devices with high-density screens (such as the
                  Retina display) one logical pixel can be mapped to more than one physical pixel.
                  You can use this option to increase the resolution at which the visualization
                  is drawn to make the image clearer and labels more legible. You can also decrease this
                  resolution to make rendering faster at the cost of quality.
                </p>

                <p>
                  By default, <code>pixelRatio</code> is <code>1</code>. In such cases, the width and
                  height of the canvas on which the visualization is drawn will be equal to the
                  pixel dimensions of the HTML container element. For
                  <code>pixelRatio</code> values greater/smaller than 1, the pixel dimensions of the canvas
                  will be smaller/larger than the dimensions of the enclosing HTML element and the canvas
                  will be stretched to fit in the container's client area.
                  For example, if you set <code>pixelRatio</code> to 2 and if the size of the
                  enclosing HTML element is 400x400 pixels, the size of the canvas will
                  be 800x800 pixels. Such a configuration will better utilize the extra pixels
                  available on Retina displays, for example.
                </p>

                <p>
                  On most modern browsers you can retrieve the device-specific
                  pixel ratio from the <code>window.devicePixelRatio</code> property.
                </p>

                <p>
                  If the pixel ratio is changed after FoamTree has initialized, you will need to call
                  <code>redraw</code> for the change to be applied.
                </p>

                <p>
                  The following examples demonstrate the difference between a pixel ratio higher and lower than the
                  pixel resolution.
                </p>

                <div class="row">
                  <div class="col-sm-6">
                      <pre class="partial executable example">
foamtree.set({
  dataObject: largeDataSet,
  pixelRatio: 0.5
});
foamtree.redraw();</pre>
                  </div>
                  <div class="col-sm-6">
                      <pre class="partial executable example">
foamtree.set({
  dataObject: largeDataSet,
  pixelRatio: 2
});
foamtree.redraw();</pre>
                  </div>
                </div>

                <div class="alert alert-info" id="ipad-with-retina-performance">
                  <strong>Heads up!</strong>
                  <p>
                    To boost the performance on iPads with Retina display set <code>pixelRatio</code> to 2 and the
                    width of the HTML container element to be at least one pixel less than the total screen width.
                    Yes, we know it's weird but it speeds up rendering a lot.
                  </p>

                  <p>
                    When setting <code>pixelRatio</code> to a value larger
                    than 1 on mobile devices, make sure to correctly set the size of the
                    page's viewport. The default viewport may be very large, leading to a
                    very large canvas. Refer to the <a href="../demos/touch.html">mobile demo's</a> source code
                    for examples.
                  </p>
                </div>
              </section>

              <section id="wireframePixelRatio" class="api">
                <h3>wireframePixelRatio</h3>

                <p>
                  The pixel ratio to use when drawing animations, such as rollout, pullback, expose or zooming.
                  You can change the default to a higher value (e.g. <code>2</code> on Retina displays) to have
                  the animation drawn in more detail, but noticeably slower. You can also set this option to
                  a lower value, e.g. 0.5 to have the animation drawn faster, but with less detail.
                  Please see the <code>pixelRatio</code> option for detailed considerations on how the pixel ratio
                  value affects the sizes of the canvases allocated by FoamTree.
                </p>
              </section>

              <section id="groupContentDecorator" class="api">
                <h3>groupContentDecorator</h3>

                <p>
                  A callback function you can use to customize or completely replace the way group polygons'
                  content is drawn. The task of the function is to render the contents by invoking
                  the appropriate drawing methods on the provided drawing context that behaves like the standard
                  <a href="https://developer.mozilla.org/en/docs/Web/API/CanvasRenderingContext2D">CanvasRenderingContext2D</a>.
                </p>

                <p>
                  The signature of the decorator callback should be the following:
                </p>

                <p>
                  <code>function (options, properties, variables)</code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>options</dt>
                  <dd>all current visualization options (keys and values).</dd>

                  <dt>properties</dt>
                  <dd>
                    <p>
                      an object with properties describing the group being rendered. The object will be a union of
                      objects retrieved from the <code>hierarchy</code>, <code>state</code> and <code>geometry</code>
                      options.
                    </p>

                    <p>
                      Additionally, the following shape-decorator-specific properties are available:
                    </p>

                    <dl class="dl-horizontal narrow">
                      <dt>context</dt>
                      <dd>
                        <p>
                          a drawing context that behaves like the standard <a
                          href="https://developer.mozilla.org/en/docs/Web/API/CanvasRenderingContext2D">CanvasRenderingContext2D</a>.
                          The decorator should call the appropriate drawing methods on this object to render the
                          contents of the polygon.
                        </p>

                        <p>
                          The provided object is not an actual canvas drawing context, but a buffer that records all the
                          invocations so that FoamTree can replay them when needed without invoking the decorator, for example during zooming or
                          panning. The <code>groupContentDecoratorTriggering</code> option determines when this decorator
                          will be triggered and when the last buffered content will be "replayed" without invoking
                          the decorator.
                        </p>

                        <p>
                          The drawing context buffer offers a number of <a href="#options-drawing-context">additional methods</a> not available in a
                          standard drawing context, such as drawing rounded rectangles or filling a polygon with text.
                        </p>
                      </dd>

                      <dt>shapeDirty</dt>
                      <dd>
                        <p>
                          indicates whether the geometry of the group's polygon has changed since the last invocation
                          of the decorator. If the custom layout is expensive to compute, you may want to cache it
                          and recompute the layout only when the <code>shapeDirty</code> property is <code>true</code>.
                        </p>

                        <p>
                          This property is meaningful only when <code>groupContentDecoratorTriggering</code> is
                          <code>onSurfaceDirty</code>. If the triggering is done <code>onShapeDirty</code>,
                          the <code>shapeDirty</code> property will <code>true</code> on all invocations
                          of the decorator.
                        </p>
                      </dd>

                      <dt>viewportScale</dt>
                      <dd>
                        <p>
                          the current viewport scale. Values larger than <code>1</code> mean the viewport is zoomed-in, values
                          smaller than <code>1</code> mean the viewport is zoomed-out, a value of <code>1</code> means the
                          viewport is at its neutral zoom level.
                        </p>

                        <p>
                          Using this property makes sense only when <code>groupContentDecoratorTriggering</code>
                          is <code>onSurfaceDirty</code>, in which case you may want to vary the amount of detail
                          drawn depending on the zoom level.
                        </p>
                      </dd>
                    </dl>
                  </dd>

                  <dt>variables</dt>
                  <dd>
                    <p>
                      object with a number of variables this decorator can change.
                    </p>

                    <p>
                      The following variables are available:
                    </p>

                    <dl class="dl-horizontal">
                      <dt>groupLabelDrawn</dt>
                      <dd>
                        set to <code>false</code> to skip rendering of the default group's label; <code>true</code>
                        by default.
                      </dd>

                      <dt>groupPolygonDrawn</dt>
                      <dd>
                        set to <code>false</code> to skip rendering of the polygon corresponding to the group;
                        <code>true</code> by default.
                      </dd>
                    </dl>
                  </dd>
                </dl>

                <p>
                  Please note the following tips and caveats when implementing your drawing code:
                </p>

                <ul>
                  <li>
                    The coordinate space in which all drawing happens is determined by the coordinates of the group's
                    polygon. The coordinates of the polygon are available in the <code><a href="#geometry-polygon">polygon</a></code>
                    property. You may want to apply a suitable transformation to the drawing context to avoid complex
                    coordinate arithmetics.
                  </li>

                  <li>
                    FoamTree exposes a number of <a href="#options-geometry-utils">geometry utilities</a> that may be
                    useful when implementing the shape decorator code.
                  </li>

                  <li>
                    <p>
                      FoamTree does not restrict the drawing area to the area of the polygon being filled. This means
                      that it is the responsibility of your code not to overrun the polygon boundaries. If your code
                      draws beyond the boundaries of the polygon, you will be seeing artifacts resulting from incremental
                      redraws and arbitrary order of polygon drawing.
                    </p>

                    <p>
                      One option is to use the <code>clip</code> method of the drawing context to restrict the drawing
                      area, but this will severely impact the drawing performance. A much faster variant would be, for
                      example, to restrict drawing to an inscribed rectangle computed using
                      the <a href="#geometry.rectangleInPolygon"><code>rectangleInPolygon</code></a> method.
                    </p>
                  </li>

                  <li>
                    Due to performance optimizations applied by FoamTree, such as incremental redraws, your code must
                    not make any assumptions about the order in which this decorator will be invoked. If the code needs
                    to precompute any global information, the best place to do so would be the <code>onRedraw</code>
                    or <code>onModelChanged</code> event listeners. See also the <code>groupContentDecoratorTriggering</code>
                    option.
                  </li>

                  <li>
                    <p>
                      Each group's elements are drawn in the following order:
                    </p>

                    <ol>
                      <li>
                        group's polygon (unless the decorator sets the <code>groupPolygonDrawn</code> variable to
                        <code>false</code>)
                      </li>

                      <li>
                        the shapes drawn by the decorator
                      </li>

                      <li>
                        the default group's label (unless the decorator sets the <code>groupLabelDrawn</code> variable
                        to <code>false</code>)
                      </li>
                    </ol>
                  </li>

                  <li>
                    If the group has a non-empty label, the custom content will only be drawn when the label is
                    visible. When the current viewport scale is too small for the label to be drawn, the custom
                    content will not be drawn either. If, however, the group does not have a label, custom content
                    will always be drawn. In this case, this decorator may further decide whether to draw any content
                    depending on the size of the polygon and the current viewport scale.
                  </li>
                </ul>

                <div class="alert alert-warning showInDemoVersion">
                  <strong>Heads up!</strong>

                  <p>
                    The limited demo version of FoamTree will not call this decorator for the attribution group.
                    Please <a href="http://carrotsearch.com/foamtree-how-to-order">contact Carrot Search</a> for
                    licensing of a fully customizable distribution.
                  </p>
                </div>

                <p>
                  The following example shows how to use the group shape decorator to draw a two-way pie chart
                  that can express some additional information about the group.
                </p>
                <pre class="partial executable example">
foamtree.set({
  rolloutDuration: 3000,
  dataObject: largeDataSet,

  // Our custom drawing depends on the group state,
  // therefore we need to use the "onSurfaceDirty" triggering.
  groupContentDecoratorTriggering: "onSurfaceDirty",

  // Our custom drawing is pretty fast, so we can draw it during animations
  wireframeContentDecorationDrawing: "always",

  // Our custom drawing callback
  groupContentDecorator: function (opts, params, vars) {
    var ctx = params.context;
    var centerX = params.polygonCenterX;
    var centerY = params.polygonCenterY;

    // Compute pie chart radius
    var radius = CarrotSearchFoamTree.geometry.circleInPolygon(
      params.polygon, centerX, centerY) * 0.8;

    // Increase opacity of the pie chart on hover
    var baseAlpha = (params.hovered ? 2 : 1);

    // Increase stroke width on selection,
    // use thinner lines on lower hierarchy levels
    ctx.lineWidth = (params.selected ? 3.0 : 1.5) * Math.pow(0.5, params.level);

    // The black part of the pie chart
    ctx.beginPath();
    ctx.moveTo(centerX, centerY);
    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI * params.group.rank);
    ctx.closePath();
    ctx.strokeStyle = rgba("0, 0, 0", baseAlpha * 0.2);
    ctx.stroke();
    ctx.fillStyle = rgba("0, 0, 0", baseAlpha * 0.1);
    ctx.fill();

    // The white part of the pie chart
    ctx.beginPath();
    ctx.arc(centerX, centerY, radius, 2 * Math.PI * params.group.rank, 0);
    ctx.strokeStyle = rgba("255, 255, 255", baseAlpha * 0.2);
    ctx.stroke();
    ctx.lineTo(centerX, centerY);
    ctx.fillStyle = rgba("255, 255, 255", baseAlpha * 0.2);
    ctx.fill();

    function rgba(rgb, alpha) {
      return "rgba(" + rgb + ", " + alpha + ")";
    }
  },

  // Generates some random data we'll display in the pie chart
  onModelChanged: function (data) {
    enhance(data);

    function enhance(group) {
      group.rank = 0.1 + Math.random() * 0.9;
      if (group.groups) {
        group.groups.forEach(enhance);
      }
    }
  }
});</pre>

                <p>
                  The following example shows how to draw some extra information below the default label.
                </p>
                <pre class="partial executable example">
foamtree.set({
  dataObject: largeDataSet,

  // Our custom drawing callback
  groupContentDecorator: function (opts, params, vars) {
    var ctx = params.context;
    var centerX = params.polygonCenterX;

    // We want to put the extra label inside a semi transparent rectangle.
    // To do this, we need to draw the rectangle first and then the label.
    // The dimensions of the rectangle are returned by the fillPolygonWithText()
    // method, so to get the right drawing order, we need to draw the text
    // to a scratch buffer, draw the rectangle and then draw the text we
    // saved in the scratch buffer.
    var scratch = ctx.scratch();

    var info = scratch.fillPolygonWithText(
      // Fit the extra text inside the main polygon
      params.polygon,

      // Fit the extra text below the main label
      centerX, params.labelBoxTop + params.labelBoxHeight,

      // use non-breakable space to prevent line breaks
      params.group.weight + "\u00a0docs",

      {
        maxFontSize: 0.6 * params.labelFontSize, // restrict max font size
        verticalAlign: "top", // flow the text downwards from the center point
        verticalPadding: 0.1, // use some smaller than default padding
        maxTotalHeight: 1 // use the full available height
      });

    // Draw the rectangle. FoamTree already set for us the color
    // it used to draw the label, we'll use that color.
    if (info.fit) {
      var labelBox = info.box;
      var boxMargin = labelBox.h * 0.1;
      ctx.roundRect(labelBox.x - 2 * boxMargin, labelBox.y - boxMargin,
        labelBox.w + 4 * boxMargin, labelBox.h + 2 * boxMargin, boxMargin * 2);

      ctx.globalAlpha = 0.15;
      ctx.fill();
      ctx.globalAlpha = 0.25;
      ctx.lineWidth = boxMargin * 0.3;
      ctx.stroke();

      // Draw the text from our scratch buffer
      ctx.globalAlpha = 1.0;
      scratch.replay(ctx);
    }
  }
});</pre>


                <p>
                  See also the <a href="../demos/images.html" target="_blank">images demo</a> for code that renders
                  SVG images inside FoamTree polygons and the <a href="../demos/github.html" target="_blank">GitHub
                  search demo</a> for more complex custom content rendering.
                </p>
              </section>


              <section id="groupContentDecoratorTriggering" class="api">
                <h3>groupContentDecoratorTriggering </h3>

                <p>
                  Determines when the <code>groupContentDecorator</code> will be triggered:
                </p>

                <dl class="dl-horizontal">
                  <dt>onShapeDirty</dt>
                  <dd>
                    <p>
                      The shape decorator will only be triggered if the shape of the group's polygon
                      changes, for example during the relaxation process or after resizing of the visualization area.
                      During redraws in which the shape of the polygon is not changing, such as when zooming or
                      drawing selection outline, FoamTree will "replay" the custom drawing commands issued by the
                      last invocation of the shape decorator, which will improve the rendering performance.
                    </p>

                    <p>
                      Use this triggering mode when the custom content of the group does not depend on the state
                      of the group (selected, hovered) and thus the group shape decorator does not need to be called
                      when group state changes.
                    </p>
                  </dd>

                  <dt>onSurfaceDirty</dt>
                  <dd>
                    <p>
                      The shape decorator will be triggered every time the group's polygon needs to be drawn. Use
                      this triggering mode if your custom content drawing depends on the state of the group
                      (selected, hovered). Depending on the complexity of your custom drawing code, using this
                      triggering mode may result in lower rendering performance.
                    </p>
                  </dd>
                </dl>
              </section>

              <section id="wireframeLabelDrawing" class="api">
                <h3>wireframeLabelDrawing</h3>

                <p>
                  Determines whether FoamTree should draw group labels during animation. The following values
                  are allowed:
                </p>

                <dl class="dl-horizontal">
                  <dt>auto</dt>
                  <dd>
                    FoamTree will try to automatically enable or disable drawing of labels based on the performance
                    of the browser and the size of the data set to meet the limit set in <code>wireframeDrawMaxDuration</code>.
                  </dd>

                  <dt>always</dt>
                  <dd>
                    labels will always be drawn during animations, regardless of the
                    <code>wireframeDrawMaxDuration</code> limit.
                  </dd>

                  <dt>never</dt>
                  <dd>
                    labels will never be drawn during animations, regardless of the
                    <code>wireframeDrawMaxDuration</code> limit.
                  </dd>
                </dl>
              </section>

              <section id="wireframeContentDecorationDrawing" class="api">
                <h3>wireframeContentDecorationDrawing</h3>

                <p>
                  Determines whether FoamTree should draw the group content decorations produced by the
                  <code>groupContentDecorator</code> during animation. The following values
                  are allowed:
                </p>

                <dl class="dl-horizontal">
                  <dt>auto</dt>
                  <dd>
                    <p>
                      FoamTree will try to automatically enable or disable drawing of group content decorations based on the performance
                      of the browser and the size of the data set to meet the limit set in <code>wireframeDrawMaxDuration</code>.
                    </p>

                    <p>
                      For the purposes of this calculation FoamTree will assume that the custom shapes drawn
                      by the <code>groupContentDecorator</code> are as expensive to draw as labels.
                      If the custom drawing does not contain any text and/or is fast to draw, you can set
                      this option to <code>always</code>.
                    </p>
                  </dd>

                  <dt>always</dt>
                  <dd>
                    group content decorations will always be drawn during animations, regardless of the
                    <code>wireframeDrawMaxDuration</code> limit.
                  </dd>

                  <dt>never</dt>
                  <dd>
                    group content decorations will never be drawn during animations, regardless of the
                    <code>wireframeDrawMaxDuration</code> limit.
                  </dd>
                </dl>
              </section>

              <section id="maxGroupLevelsDrawn" class="api">
                <h3>maxGroupLevelsDrawn</h3>

                <p>
                  The maximum number of levels of closed groups FoamTree will draw. For hierarchies with more than
                  <code>maxGroupLevelsDrawn</code> levels, the lower-level groups will not be drawn until the appropriate
                  number of their parent groups get open. If your data set contains many levels of groups with many
                  children on each level, you may want to lower the value of this option to speed up layout
                  computation and rendering at the cost of lower amount of visible detail.
                </p>

                <p>
                  The following example generates a random 10-level hierarchy with 2 groups at each level, sets the
                  initial <code>maxGroupLevelsDrawn</code> to <code>1</code> so that only the top-level groups
                  are drawn. Then, once a second, the code will increment <code>maxGroupLevelsDrawn</code> to demonstrate
                  that lower-level groups will indeed be drawn. Additionally, the code will gradually lower the
                  <code>parentFillOpacity</code>, so that the lower-level groups are more clearly visible. Finally,
                  the example sets <code>groupMinDiameter</code> to <code>0</code> so that as many groups are possible
                  fit on the screen.
                </p>

                <pre class="partial empty executable example" data-runafter="clearTimeout">
foamtree.set({
  // Lower groupMinDiameter to fit as many groups as possible
  groupMinDiameter: 0,

  // Start with drawing just the top-level groups
  maxGroupLevelsDrawn: 1,

  // Generate a 10-level hierarchy
  dataObject: { groups: randomGroups(2, 10 /* levels */) }
});

// Initiate revealing of lower levels
var timeout;
(function reveal() {
  timeout = window.setTimeout(function () {
    var levels = foamtree.get("maxGroupLevelsDrawn") + 1;
    foamtree.set("maxGroupLevelsDrawn", levels);
    foamtree.set("parentFillOpacity", foamtree.get("parentFillOpacity") * 0.8);
    foamtree.redraw();
    if (levels < 10) {
      reveal();
    }
  }, 1000);
})();
</pre>
              </section>

              <section id="maxGroupLabelLevelsDrawn" class="api">
                <h3>maxGroupLabelLevelsDrawn</h3>

                <p>
                  The maximum number of levels of group labels FoamTree will draw. For hierarchies with more than
                  <code>maxGroupLabelLevelsDrawn</code> levels, only the top specified number of open groups will have
                  their labels drawn. You can lower the default value of this option for faster rendering of the
                  visualization at the cost of lower amount of visible detail.
                </p>

                <p>
                  The following example generates and visualizes a random 10-level hierarchy with 2 groups at each level.
                  Click and hold on the groups to open them and observe how deeper level polygons and labels get revealed.
                </p>

                <pre class="partial empty executable example" data-runafter="clearTimeout">
foamtree.set({
  // Lower groupMinDiameter to fit as many groups as possible
  groupMinDiameter: 0,

  // Draw 2 levels of labels and 4 levels of group polygons
  maxGroupLevelsDrawn: 4,
  maxGroupLabelLevelsDrawn: 2,

  // Tune the border options to make them more visible
  parentFillOpacity: 0.3,
  parentStrokeOpacity: 1.0,
  groupBorderRadius: 0,
  groupBorderWidth: 3,
  groupBorderWidthScaling: 0.8,

  // Generate a 10-level hierarchy
  dataObject: { groups: randomGroups(2, 10 /* levels */) },

  // Always draw the same "label"
  groupLabelDecorator: function (opts, params, vars) {
    vars.labelText = params.level;
  }
});
</pre>
              </section>

              <section id="wireframeToFinalFadeDelay" class="api">
                <h3>wireframeToFinalFadeDelay</h3>

                <p>
                  Once animation of the visualization completes, FoamTree will redraw the final image
                  using more detail. This option determines the amount of time that should pass after the last animation
                  frame before the high-quality image is shown.
                </p>
              </section>

              <section id="wireframeToFinalFadeDuration" class="api">
                <h3>wireframeToFinalFadeDuration</h3>

                <p>
                  The duration of the fading animation used to switch between the wireframe and the high-quality
                  visualization image.
                </p>
              </section>

              <section id="finalToWireframeFadeDuration" class="api">
                <h3>finalToWireframeFadeDuration</h3>

                <p>
                  The duration of the fading animation used to switch between the high-quality and the wireframe
                  visualization image.
                </p>
              </section>

              <section id="wireframeDrawMaxDuration" class="api">
                <h3>wireframeDrawMaxDuration</h3>

                <p>
                  The desired maximum duration of drawing one frame of animation. Decreasing the value, possibly to
                  <code>0</code>, will make the animation more smooth at the cost of lower number of details.
                  Increasing the value will increase the number of details, but may slow down the animation.
                </p>
              </section>

              <section id="finalCompleteDrawMaxDuration" class="api">
                <h3>finalCompleteDrawMaxDuration</h3>

                <p>
                  The desired maximum duration of a complete high-quality redraw of the visualization. Please see
                  the <a href="#rendering-performance">Visualization rendering performance</a> section for a detailed
                  discussion.
                </p>
              </section>

              <section id="finalIncrementalDrawMaxDuration" class="api">
                <h3>finalIncrementalDrawMaxDuration</h3>

                <p>
                  The desired maximum duration of an incremental high-quality redraw of the visualization. Please see
                  the <a href="#rendering-performance">Visualization rendering performance</a> section for a detailed
                  discussion.
                </p>
              </section>

              <section id="androidStockBrowserWorkaround" class="api">
                <h3>androidStockBrowserWorkaround</h3>

                <p>
                  There is a <a href="https://code.google.com/p/android/issues/detail?id=39247">bug in Android stock
                  browsers</a>, that affects the incremental updates of the visualization as well as cross-fading
                  between the wireframe and final visualization images. Setting this option to <code>true</code> will
                  enable a workaround for the bug. As a side effect, cross fading between the wireframe and final
                  images will be disabled, regardless of the <code>wireframeToFinalFadeDuration</code> amd
                  <code>finalToWireframeFadeDuration</code> options.
                </p>

                <p>
                  The default value of this option is <code>true</code> on <strong>all</strong> Android browsers and
                  <code>false</code> on all other browsers.
                </p>
              </section>

              <section id="viewport" class="api">
                <h3>viewport</h3>

                <p>
                  A read-only option that returns the parameters of the current viewport. This option returns
                  an object with the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>x</dt>
                  <dd>The horizontal offset of the viewport.</dd>

                  <dt>y</dt>
                  <dd>The vertical offset of the viewport.</dd>

                  <dt>scale</dt>
                  <dd>
                    The scale of the viewport. Values larger than <code>1.0</code> mean the viewport is magnified.
                    A value of <code>1.0</code> means the viewport is in its neutral state. Values lower than
                    <code>1.0</code> mean the viewport is demagnified, which may happen when some groups
                    are exposed.
                  </dd>
                </dl>

                <p>
                  The following example renders the current viewport parameters inside each group's polygon.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(10) },

  groupLabelDecorator: function (opts, params, vars) {
    var viewport = this.get("viewport");
    vars.labelText =
      "x\u00a0=\u00a0" + viewport.x.toFixed(2) + " " +
      "y\u00a0=\u00a0" + viewport.y.toFixed(2) + " " +
      "scale\u00a0=\u00a0" + viewport.scale.toFixed(2);
  }
});
</pre>

                <p>
                  The example below shows how to prevent panning of the visualization area if the viewport
                  is not zoomed-in.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(10) },

  onGroupDragStart: function (e) {
    if (this.get("viewport").scale <= 1.0) {
      return false;
    }
  }
});
</pre>
              </section>
            </section>
            
            <section id="options-export" class="api-group">
              <h2>Export</h2>

              <section id="imageData" class="api">
                <h3>imageData</h3>

                <p>
                  Returns the current state of the visualization as an image in the
                  <a target="_blank" href="http://en.wikipedia.org/wiki/Data_URI_scheme">data URL</a> format.
                  Unlike most attributes, this one accepts an optional object which can
                  specify the image format details. This object can contain the following keys:
                </p>


                <dl class="dl-horizontal">
                  <dt>format</dt>
                  <dd>
                    format of the image data: <code>image/png</code> or <code>image/jpeg</code>
                  </dd>

                  <dt>quality</dt>
                  <dd>
                    if <code>format</code> is <code>image/jpeg</code>, specifies the desired quality of JPEG compression
                    in the 0..1 range, where 1 means the highest quality and largest image data. Note that JPEG images
                    are always opaque, even if the background color is specified as transparent. Use PNG images to
                    handle background transparency.
                  </dd>

                  <dt>pixelRatio</dt>
                  <dd>
                    the pixel ratio to use when producing the export image. Use a value larger than <code>1</code>,
                    such as <code>2</code> to create a higher-resolution image.
                  </dd>

                  <dt>backgroundColor</dt>
                  <dd>
                    if specified, the background of the exported image will be filled in with the provided color.
                    This option is especially useful when exporting images in the JPEG format.
                  </dd>
                </dl>

                <p>
                  The visualization image can be used by your application in many different ways. On certain browsers,
                  it is possible to <a target="_blank" href="http://jsfiddle.net/flyingsheep/wpQtH/">trigger a
                  dialog</a> allowing the user to save the image to the local disk. The image data can be also sent to a
                  server that will do further processing (for example save it or send it via e-mail somewhere).
                </p>

                <div class="alert alert-danger">
                  <strong>Heads up!</strong>

                  <p>
                    If the attribution logo was fetched from a different domain than the page that embeds the
                    visualization, getting the visualization image will not be possible due to <a target="_blank"
                    href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#security-with-canvas-elements">security
                    constraints</a>.
                  </p>
                </div>

                <p>
                  The following example logs the size of the visualization image (the data URL string, not actual bytes)
                  in various formats to <code>console</code>.
                </p>

                <pre class="partial executable example">
foamtree.set({
  dataObject: largeDataSet,
  onRolloutComplete: function() {
    var opts = [
      { format: "image/png" },
      { format: "image/jpeg", quality: 0.2 },
      { format: "image/jpeg", quality: 0.4 },
      { format: "image/jpeg", quality: 0.6 },
      { format: "image/jpeg", quality: 0.8 },
      { format: "image/jpeg", quality: 1 }
    ];
    $(opts).each(function(i, format) {
      console.log(format, "Image takes: " +
                  (foamtree.get("imageData", format).length / 1024).toFixed(0) + "kB");
    });
  }
});</pre>
              </section>
            </section>

            <section id="options-interactions" class="api-group">
              <h2>Interactions</h2>

              <section id="selection" class="api">
                <h3>selection</h3>

                <p>
                  You can use this option to obtain or alter the current selection.
                </p>

                <dl class="dl-horizontal">
                  <dt>getter</dt>
                  <dd>
                    <p>
                      Calling <code>get("selection")</code> returns an object with the currently selected groups. The
                      object contains one property, <code>groups</code>, containing an array of references to the
                      data objects corresponding to the selected groups.
                    </p>

                    <pre class="hidden" id="redSelectionOutline">
foamtree.set({
  groupSelectionOutlineColor: "red",
  groupSelectionOutlineWidth: 6,
  groupSelectionOutlineShadowSize: 4
})</pre>

                    <pre class="partial executable example" data-runbefore="redSelectionOutline">
foamtree.set("dataObject", { groups: [
  { label: "Group 1", selected: true },
  { label: "Group 2" },
  { label: "Group 3", selected: true },
  { label: "Group 4" }]});

console.log(foamtree.get("selection").groups);</pre>
                  </dd>

                  <dt>setter</dt>
                  <dd>
                    <p>
                      You can set the selection option to alter the current selection. The provided value must be
                      a <a href="#multiple-group-selector">multiple group selector</a> designating the groups to
                      select or deselect.
                    </p>

                    <ul>
                      <li>
                        <p>
                          If the selector is an <strong>individual selector</strong> or an <strong>array of individual
                          selectors</strong>, the designated groups will get selected, the state of the other groups
                          will remain unchanged.
                        </p>

                        <pre class="partial executable example" data-runbefore="redSelectionOutline" data-runafter="clearTimeout">
foamtree.set("selection", "1");
var timeout = window.setTimeout(function() {
  foamtree.set("selection", "2");
}, 2000);</pre>
                      </li>

                      <li>
                        <p>
                          If the <strong>selector is an object</strong>, two additional properties are supported, apart from the common
                          <code>groups</code> and <code>all</code> properties:
                        </p>

                        <dl class="dl-horizontal">
                          <dt>selected</dt>
                          <dd>
                            If <code>true</code> or not provided, the designated groups will get selected.
                            If <code>false</code>, the designated groups will get deselected.
                          </dd>

                          <dt>keepPrevious</dt>
                          <dd>
                            If <code>true</code> or not provided, only the state of the designated groups will be altered.
                            If <code>false</code>, the state of the designated groups will be altered,
                            the other groups will get closed.
                          </dd>
                        </dl>

                        <p>
                          To deselect all groups, you can use the selector with the <code>all</code> property:
                        </p>

                        <pre class="partial executable example" data-runbefore="redSelectionOutline" data-runafter="clearTimeout">
foamtree.set("selection", ["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.set("selection", { all: true, selected: false });
}, 2000);</pre>
                      </li>
                    </ul>

                    <p>
                      <strong>Note: </strong> when selection state is changed by setting this option, the event listeners
                      will not be called.
                    </p>
                  </dd>
                </dl>
              </section>

              <section id="open" class="api">
                <h3>open</h3>

                <p>
                  You can use this option to obtain or alter the set of open groups.
                </p>

                <dl class="dl-horizontal">
                  <dt>getter</dt>
                  <dd>
                    <p>
                      Calling <code>get("open")</code> returns an object with the currently open groups. The
                      object contains one property, <code>groups</code>, containing an array of references to the
                      data objects corresponding to the open groups.
                    </p>

                    <pre class="partial executable example">
foamtree.set("dataObject", { groups: [
  { label: "Group 1", groups: [ { label: "Group 1.1" }, {label: "Group 1.2" } ], open: true },
  { label: "Group 2" },
  { label: "Group 3", groups: [ { label: "Group 3.1" }, {label: "Group 3.2" } ], open: true },
  { label: "Group 4" }]});

console.log(foamtree.get("open").groups);</pre>
                  </dd>

                  <dt>setter</dt>
                  <dd>
                    <p>
                      You can set this option to alter the currently open groups. The provided value must be
                      a <a href="#multiple-group-selector">multiple group selector</a> designating the groups to
                      open or close.
                    </p>

                    <ul>
                      <li>
                        <p>
                          If the selector is an <strong>individual selector</strong> or an <strong>array of individual
                          selectors</strong>, the designated groups will get open, the state of the other groups
                          will remain unchanged.
                        </p>

                        <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("open", "1");
var timeout = window.setTimeout(function() {
  foamtree.set("open", "2");
}, 2000);</pre>
                      </li>

                      <li>
                        <p>
                          If the <strong>selector is an object</strong>, two additional properties are supported, apart from the common
                          <code>groups</code> and <code>all</code> properties:
                        </p>

                        <dl class="dl-horizontal">
                          <dt>open</dt>
                          <dd>
                            If <code>true</code> or not provided, the designated groups will get open.
                            If <code>false</code>, the designated groups will get closed.
                          </dd>

                          <dt>keepPrevious</dt>
                          <dd>
                            If <code>true</code> or not provided, only the state of the designated groups will be altered.
                            If <code>false</code>, the state of the designated groups will be altered,
                            the other groups will get closed.
                          </dd>
                        </dl>

                        <p>
                          To close all groups, you can use the selector with the <code>all</code> property:
                        </p>

                        <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("open", ["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.set("open", { all: true, open: false });
}, 2000);</pre>
                      </li>
                    </ul>

                    <p>
                      <strong>Note: </strong> when open state is changed by setting this option, the event listeners
                      will not be called.
                    </p>

                    <p>
                      <strong>Tip: </strong> to get a notification of the completed open/close animation, you can use
                      the <code data-href="#open_method">open</code> method instead.
                    </p>
                  </dd>
                </dl>
              </section>

              <section id="exposure" class="api">
                <h3>exposure</h3>

                <p>
                  You can use this option to obtain or alter the set of exposed groups.
                </p>

                <dl class="dl-horizontal">
                  <dt>getter</dt>
                  <dd>
                    <p>
                      Calling <code>get("exposure")</code> returns an object with the currently exposed groups. The
                      object contains one property, <code>groups</code>, containing an array of references to the
                      data objects corresponding to the exposed groups.
                    </p>

                    <pre class="partial executable example">
foamtree.set("dataObject", { groups: [
  { label: "Group 1", exposed: true },
  { label: "Group 2" },
  { label: "Group 3", exposed: true },
  { label: "Group 4" }]});

console.log(foamtree.get("exposure").groups);</pre>
                  </dd>

                  <dt>setter</dt>
                  <dd>
                    <p>
                      You can set this option to alter the currently open groups. The provided value must be
                      a <a href="#multiple-group-selector">multiple group selector</a> designating the groups to
                      expose or unexpose.
                    </p>

                    <ul>
                      <li>
                        <p>
                          If the selector is an <strong>individual selector</strong> or an <strong>array of individual
                          selectors</strong>, the designated groups will be exposed, all other groups will get unexposed.
                        </p>

                        <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("exposure", "1");
var timeout = window.setTimeout(function() {
  foamtree.set("exposure", "2");
}, 2000);</pre>

                        <p>
                          The following example shows how to unexpose all groups.
                        </p>

                        <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("exposure", ["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.set("exposure", []);
}, 2000);</pre>

                        <p>
                          A similar effect could be achieved using the <code>reset</code> method.
                        </p>
                      </li>

                      <li>
                        <p>
                          If the <strong>selector is an object</strong>, two additional properties are supported, apart from the common
                          <code>groups</code> and <code>all</code> properties:
                        </p>

                        <dl class="dl-horizontal">
                          <dt>exposed</dt>
                          <dd>
                            If <code>true</code> or not provided, the designated groups will get exposed.
                            If <code>false</code>, the designated groups will be unexposed.
                          </dd>

                          <dt>keepPrevious</dt>
                          <dd>
                            If <code>true</code>, only the exposure of the designated groups will be altered.
                            If <code>false</code> or not provided, the exposure of the designated groups will be altered,
                            the other groups will get unexposed.
                          </dd>
                        </dl>

                        <p>
                          The following example uses the <code>keepExpose</code> property of the group selector
                          to expose one more group in addition to the already exposed ones. Notice that if the parent
                          group of the group to be exposed is closed (groups 3 and 4 in the example), the parents will
                          be automatically opened as part of the exposure process.
                        </p>

                        <pre class="partial executable example" data-runafter="clearTimeout">
foamtree.set("exposure", ["1", "2"]);
var timeout = window.setTimeout(function() {
  foamtree.set("exposure", { groups: ["3.1", "4.1"], keepPrevious: true });
}, 2000);</pre>
                      </li>
                    </ul>

                    <p>
                      <strong>Note: </strong> when exposure is changed by setting this option, the event listeners
                      will not be called.
                    </p>

                    <p>
                      <strong>Note: </strong> there are some <a href="#api-triggered-exposure-with-visible-releaxation">limitations
                      when relaxation is visible</a>.
                    </p>

                    <p>
                      <strong>Tip: </strong> to get a notification of the completed expose animation, you can use
                      the <code>expose</code> method instead.
                    </p>
                  </dd>
                </dl>
              </section>

              <section id="state" class="api">
                <h3>state</h3>

                <p>
                  Returns information about the state of the group. The returned object contains the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>selected</dt>
                  <dd><code>true</code> if the group is currently selected</dd>

                  <dt>hovered</dt>
                  <dd><code>true</code> if the group is currently hovered over</dd>

                  <dt>open</dt>
                  <dd><code>true</code> if the group is currently open</dd>

                  <dt>openness</dt>
                  <dd>the progress of the opening/closing animation on the <code>0..1</code> scale</dd>

                  <dt>exposed</dt>
                  <dd><code>true</code> if the group is currently exposed</dd>

                  <dt>exposure</dt>
                  <dd>the progress of the expose animation on the <code>0..1</code> scale</dd>

                  <dt>transitionProgress</dt>
                  <dd>the progress of the rollout/pullback animation on the <code>0..1</code> scale</dd>

                  <dt>revealed</dt>
                  <dd>
                    <code>true</code> if the group is being drawn on the screen, also when the group
                    is currently invisible due to zooming/panning; <code>false</code> when the group
                    is not being drawn on the screen, due to, for example, too small size or because
                    the relaxation process has not yet revealed it.
                  </dd>

                  <dt>browseable</dt>
                  <dd>
                    <span class="label label-default">Since 3.2.0</span> This property can assume three states:

                    <dl class="dl-horizontal">
                      <dt><code>true</code></dt>
                      <dd>
                        FoamTree has computed the layout for the direct children of this group and the
                        group can be opened for browsing.
                      </dd>

                      <dt><code>false</code></dt>
                      <dd>
                        <p>
                          FoamTree has attempted to compute the layout for the direct children of this group, but
                          the layout could not be computed for any of the following reasons: a. the diameter of the
                          child groups would not exceed <code>groupMinDiameter</code>, b. the total limit of <code>maxGroups</code>
                          would have been exceeded if the layouts got computed, c. JavaScript standard
                          floating point precision is not enough to compute the layout, which can happen for very
                          deeply nested groups.
                        </p>

                        <p>
                          When the group is not browseable, you may want to allow the user to reload the visualization
                          passing the non-browseable group as the <code>dataObject</code>, and possibly allow the user
                          to get back to the original top-level data.
                        </p>
                      </dd>

                      <dt><code>undefined</code></dt>
                      <dd>
                        FoamTree has not yet attempted to compute the layout for the direct children of this group.
                        FoamTree will attempt to compute the layout when at most <code>maxGroupLevelsDrawn</code>
                        above this groups are open.
                      </dd>
                    </dl>
                  </dd>

                  <dt>visible</dt>
                  <dd>
                    <code>true</code> if the group is visible in the current viewport
                  </dd>

                  <dt>labelDrawn</dt>
                  <dd>
                    <code>true</code> if the group's label is being drawn; <code>false</code> if the
                    label is not being drawn due to, for example, to small area of the polygon.
                  </dd>
                </dl>

                <p>
                  To retrieve the information about a group, provide the <a href="#individual-group-selector">individual
                  group selector</a> as the second parameter of the <code>get</code> method:
                </p>

                <pre class="partial executable example" data-runafter="clearTimeout">
var timeout = window.setTimeout(function() {
  console.log(foamtree.get("state", "1"));
}, 500);</pre>
              </section>

              <section id="interactionHandler" class="api">
                <h3>interactionHandler</h3>

                <p>
                  Determines which use interaction capture mechanism FoamTree should be using:
                </p>

                <dl class="dl-horizontal">
                  <dt>builtin</dt>
                  <dd>the built-in mechanism, suitable mostly for desktop devices</dd>

                  <dt>hammerjs</dt>
                  <dd>
                    use <a href="http://eightmedia.github.io/hammer.js/">Hammer.js</a> to capture the interactions,
                    see the <a href="#touch-devices">Touch devices</a> section for details.
                  </dd>

                  <dt>external</dt>
                  <dd>
                    all interaction events will be triggered externally, please see the <a
                    href="#externally-triggered-interaction">Externally triggered interaction</a> section for details.
                  </dd>
                </dl>

                <p>
                  The default value of this option is <code>builtin</code> on desktop browsers and <code>hammerjs</code>
                  on touch-enabled devices.
                </p>
              </section>
            </section>

            <section id="options-debugging" class="api-group">
              <h2>Debugging</h2>

              <section id="logging" class="api">
                <h3>logging</h3>

                <p>Enables logging of some debug information to <code>console</code>.</p>
              </section>

              <section id="times" class="api">
                <h3>times</h3>

                <p>
                  Execution times and statistics. The details of the returned object are not
                  guaranteed to work between versions but it may turn useful for debugging performance
                  problems.
                </p>

                <pre class="partial executable example">
window.setTimeout(function() {
  console.log("Execution time stats: ", foamtree.get("times"));
}, 500);</pre>
              </section>
            </section>
          </section>

          <section id="events">
            <div class="page-header"><h1>Events</h1></div>

            <section id="events-visualization" class="api-group">
              <h2>Visualization events</h2>

              <p>
                This section describes events that relate to the life cycle of the whole visualization.
              </p>

              <section id="onModelChanging" class="api">
                <h3>onModelChanging</h3>

                <p>
                  Called after the pullback animation of the previous data model has completed, but before the
                  visualization has parsed the new data model provided in the <code>dataObject</code>
                  option and before the new data has been rendered. The listeners will be called with one argument
                  &ndash; the new data object the visualization is about to parse and show.
                </p>

                <p>
                  You can use this event to modify and enhance the data model. For example, you can add or remove groups
                  and sub-groups at this stage, as in the following example:
                </p>


                <pre class="partial empty executable example">
foamtree.set({
  onModelChanging: function (data) {
    data.groups.forEach(function (group) {
      group.label = "Group with " + group.count + " child groups";
      group.weight = group.count;

      // Generate the child groups
      group.groups = [];
      for (var i = 0; i < group.count; i++) {
        group.groups.push({ label: "Group " + i });
      }
    });
  }
});

foamtree.set("dataObject", { groups: [
  { count: 8  },
  { count: 12 },
  { count: 5  },
  { count: 4  },
  { count: 7  }
]});</pre>

                <p>
                  In the context of each callback, <code>this</code> points to the involved instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onModelChanged" class="api">
                <h3>onModelChanged</h3>

                <p>
                  Called after the pullback animation of the previous data model has completed and the visualization
                  has parsed the new data model provided in the <code>dataObject</code>
                  option, but before the new data has been rendered. The listeners will be called with one argument
                  &ndash; the new data object the visualization is about to show.
                </p>

                <p>
                  You can use this event to enhance the data model. For example, if the computation of the group's
                  polygon color is expensive, you may want to perform the computation once in the <code>onModelChanged</code>
                  listener, store it in the data object and then use it in the <code>groupColorDecorator</code>, as shown
                  in the following example.
                </p>


                <pre class="partial empty executable example">
foamtree.set({
  onModelChanged: function (data) {
    data.groups.forEach(function (group) {
      group.color = "hsl(" + (-60 * (group.sentiment - 1)) + ", 100%, 50%)";
    });
  },
  groupColorDecorator: function (opts, props, vars) {
    vars.groupColor = props.group.color;
  }
});

foamtree.set("dataObject", { groups: [
  { label: "Positive", sentiment: 1 },
  { label: "Negative", sentiment: -1 },
  { label: "Neutral",  sentiment: 0 }
]});</pre>

                <p>
                  <strong>Note:</strong> group hierarchy changes, such as adding or removing groups or sub-groups, will not be
                  taken into account in the <code>onModelChanged</code>. You can make such changes in the
                  <code>onModelChanging</code> listener.
                </p>

                <p>
                  In the context of each callback, <code>this</code> points to the involved instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onRolloutStart" class="api">
                <h3>onRolloutStart</h3>

                <p>
                  Called just before the visualization starts the animated rollout. If the application implements some
                  sort of loading indicator, the indicator should be hidden once this event is fired.
                </p>

                <div class="alert alert-info">
                  <strong>Heads up!</strong>

                  <p>
                    This listener will not be called when an empty (<code>null</code>, <code>undefined</code>)
                    <code>dataObject</code> is set. To get a notification in such cases, register a listener
                    for the <code>onModelChanging</code> or the <code>onModelChanged</code> event.
                  </p>
                </div>

                <p>In the context of the callback, <code>this</code> points to the involved instance of <code>CarrotSearchFoamTree</code>.</p>
              </section>

              <section id="onRolloutComplete" class="api">
                <h3>onRolloutComplete</h3>

                <p>
                  Called after the rollout animation has completed. Please note that this listener will not be called
                  when an empty <code>dataObject</code> is set, see <code>onRolloutStart</code> for an alternative
                  for such cases.
                </p>

                <p>In the context of the callback, <code>this</code> points to the involved instance of <code>CarrotSearchFoamTree</code>.</p>
              </section>

              <section id="onRelaxationStep" class="api">
                <h3>onRelaxationStep</h3>

                <p>
                  Invoked once per layout relaxation step, but only when <code>relaxationVisible</code> is <code>true</code>.
                  The signature of the listener function should be the following:
                </p>

                <p>
                  <code>function (relaxationProgress, relaxationComplete, relaxationTimeout)</code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>relaxationProgress</dt>
                  <dd>the progress of the relaxation process on the 0..1 scale</dd>

                  <dt>relaxationComplete</dt>
                  <dd>
                    When <code>true</code>, this is the last step of relaxation because the
                    requested <code>relaxationQualityThreshold</code> has been achieved.
                  </dd>

                  <dt>relaxationTimeout</dt>
                  <dd>
                    When <code>true</code>, this is the last step of relaxation because the
                    <code>relaxationMaxDuration</code> has been exceeded.
                  </dd>
                </dl>

                <p>
                  You can use this event to create a progress indicator for the relaxation, just as the
                  <a href="#relaxation-progress-indicator">relaxation progress utility</a> does.
                </p>
              </section>

              <section id="onRedraw" class="api">
                <h3>onRedraw</h3>

                <p>
                  Called after the internal- or API-triggered redraw of the visualization. The listener will be called
                  with one boolean parameter set to <code>true</code> if the redraw as an incremental one.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved instance of <code>CarrotSearchFoamTree</code>.
                </p>

                <p>Any code in this callback should be minimal and ultra fast to keep the transition animations smooth.</p>

                <p>
                  The following example uses the <code>onRedraw</code> listener to count incremental and complete
                  redraws. The data object contains two special groups that hold the counters. The example also
                  defines a simple <code>groupColorDecorator</code> that draws the complete redraws group in red and
                  the incremental redraws group in yellow.
                </p>

                <pre class="partial executable example">
foamtree.set({
  onRedraw: function (incremental) {
    var group = this.get("dataObject").groups[incremental ? 0 : 1];
    group.redraws++;
    group.label = group.redraws.toString();
  },
  groupColorDecorator: function(opts, props, vars) {
    switch (props.group.type) {
      case "complete":    vars.groupColor = "hsl(0, 65%, 75%)"; break;
      case "incremental": vars.groupColor = "hsl(60, 65%, 75%)"; break;
      default:            vars.groupColor = "hsl(0, 0%, 85%)";
    }
  },
  rolloutDuration: 1000
});

foamtree.set("dataObject", { groups: [
  { label: "0", redraws: 0, weight: 2, type: "incremental" },
  { label: "0", redraws: 0, weight: 2, type: "complete" },
  { label: "" }, { label: "" },
  { label: "" }, { label: "" },
  { label: "" }, { label: "" },
  { label: "" }, { label: "" }
]});</pre>
              </section>

              <section id="onViewReset" class="api">
                <h3>onViewReset</h3>

                <p>
                  Invoked after the view has been <a href="#interaction-reset">reset by a user interaction</a>. See
                  the <code>reset</code> method for more details.
                </p>
              </section>
            </section>


            <section id="events-group-state" class="api-group">
              <h2>Group state events</h2>

              <p>
                This section documents events triggered when the state of one or more groups is changed by the
                user's interaction.
              </p>

              <section id="onGroupSelectionChanging" class="api">
                <h3>onGroupSelectionChanging</h3>

                <p>
                  Called during group selection changes. For each selected or deselected group, the listener will be
                  invoked with one parameter containing the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>group</dt>
                  <dd>Reference to the data object which is subject to selection state change.</dd>

                  <dt>selected</dt>
                  <dd><code>true</code> if the group has just been selected, <code>false</code> otherwise</dd>
                </dl>

                <p>
                  Note that one user action may result in many events of this type, for example deselection of
                  currently selected groups and selection of another group. The global selection state is easier to track
                  using <code>onGroupSelectionChanged</code> event.
                </p>

                <p>
                  When multiple callbacks are present the entire, set will be invoked, even if one or more callbacks
                  changes the selection via an API call.
                </p>

                <p>
                  The listener will <strong>not</strong> be invoked for API-initiated state changes, only for user
                  interactions. In the context of the callback, <code>this</code> points to the involved instance of
                  <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupSelectionChanged" class="api">
                <h3>onGroupSelectionChanged</h3>

                <p>
                  Called once after the selection has changed. The callback receives one parameter: an object containing
                  the <code>groups</code> property with an array of references to the data objects representing the
                  groups that are currently selected.
                </p>

                <p>
                  When multiple callbacks are present, the entire set will be invoked, even if one or more callbacks
                  changes the selection via an API call.
                </p>

                <p>
                  The listener will <strong>not</strong> be invoked for API-initiated state changes, only for user
                  interactions. In the context of the callback, <code>this</code> points to the involved instance of
                  <code>CarrotSearchFoamTree</code>.
                </p>

                <pre class="partial executable example">
foamtree.set({
  onGroupSelectionChanged: function(info) {
    console.log(info);
  }
});</pre>
              </section>

              <section id="onGroupExposureChanging" class="api">
                <h3>onGroupExposureChanging</h3>

                <p>
                  Called during group exposure changes. For each exposed or unexposed group, the listener will be
                  invoked with one parameter containing the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>group</dt>
                  <dd>Reference to the data object which is subject to exposure state change.</dd>

                  <dt>exposed</dt>
                  <dd><code>true</code> if the group has just been exposed, <code>false</code> otherwise</dd>

                  <dt>indirect</dt>
                  <dd>
                    <code>true</code> if the exposure change is a side effect of some other user interaction,
                    such as <a href="#interaction-reset">view reset</a>.
                  </dd>
                </dl>

                <p>
                  Note that one user action may result in many events of this type, for example unexposure of
                  currently exposed groups and exposure of another group. The global exposure state is easier to track
                  using <code>onGroupExposureChanged</code> event.
                </p>

                <p>
                  When multiple callbacks are present the entire, set will be invoked, even if one or more callbacks
                  changes the exposure via an API call.
                </p>

                <p>
                  The listener will <strong>not</strong> be invoked for API-initiated state changes, only for user
                  interactions. In the context of the callback, <code>this</code> points to the involved instance of
                  <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupExposureChanged" class="api">
                <h3>onGroupExposureChanged</h3>

                <p>
                  Called once after the exposure has changed. The callback receives one parameter: an object containing
                  the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>groups</dt>
                  <dd>an array of references to the data objects representing the groups that are currently exposed</dd>

                  <dt>indirect</dt>
                  <dd>
                    <code>true</code> if the exposure change is a side effect of some other user interaction,
                    such as <a href="#interaction-reset">view reset</a>.
                  </dd>
                </dl>

                <p>
                  When multiple callbacks are present, the entire set will be invoked, even if one or more callbacks
                  changes the exposure via an API call.
                </p>

                <p>
                  The listener will <strong>not</strong> be invoked for API-initiated state changes, only for user
                  interactions. In the context of the callback, <code>this</code> points to the involved instance of
                  <code>CarrotSearchFoamTree</code>.
                </p>

                <pre class="partial executable example">
foamtree.set({
  onGroupExposureChanged: function(info) {
    console.log(info);
  }
});</pre>
              </section>

              <section id="onGroupOpenOrCloseChanging" class="api">
                <h3>onGroupOpenOrCloseChanging</h3>

                <p>
                  Called during group opening state changes. For each opened or closed group, the listener will be
                  invoked with one parameter containing the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>group</dt>
                  <dd>Reference to the data object which is subject to opening state change.</dd>

                  <dt>open</dt>
                  <dd><code>true</code> if the group has just been opened, <code>false</code> otherwise</dd>

                  <dt>indirect</dt>
                  <dd>
                    <code>true</code> if the state change is a side effect of some other user interaction,
                    such as group exposure change or <a href="#interaction-reset">view reset</a>.
                  </dd>
                </dl>

                <p>
                  Note that one user action may result in many events of this type, for example closing of
                  currently opened groups and opening of another group. The global state is easier to track
                  using <code>onGroupOpenOrCloseChanged</code> event.
                </p>

                <p>
                  When multiple callbacks are present the entire, set will be invoked, even if one or more callbacks
                  changes the state via an API call.
                </p>

                <p>
                  The listener will <strong>not</strong> be invoked for API-initiated state changes, only for user
                  interactions. In the context of the callback, <code>this</code> points to the involved instance of
                  <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupOpenOrCloseChanged" class="api">
                <h3>onGroupOpenOrCloseChanged</h3>

                <p>
                  Called once after some groups have been opened or closed. The callback receives one parameter: an
                  object containing the following properties:
                </p>

                <dl class="dl-horizontal">
                  <dt>groups</dt>
                  <dd>an array of references to the data objects representing the groups that are currently open</dd>

                  <dt>indirect</dt>
                  <dd>
                    <code>true</code> if the state change is a side effect of some other user interaction,
                    such as group exposure change or <a href="#interaction-reset">view reset</a>.
                  </dd>
                </dl>

                <p>
                  When multiple callbacks are present, the entire set will be invoked, even if one or more callbacks
                  changes the exposure via an API call.
                </p>

                <p>
                  The listener will <strong>not</strong> be invoked for API-initiated state changes, only for user
                  interactions. In the context of the callback, <code>this</code> points to the involved instance of
                  <code>CarrotSearchFoamTree</code>.
                </p>

                <pre class="partial executable example">
foamtree.set({
  onGroupOpenOrCloseChanged: function(info) {
    console.log(info);
  }
});</pre>
              </section>
            </section>

            <section id="events-interaction" class="api-group">
              <h2>Interaction events</h2>

              <p>
                This section documents events related to low-level interactions initiated by the user. Listeners
                registered for the those events will receive the <a href="#event-details">event details object</a>
                that they may use to prevent the <a href="#interaction">default action </a> associated with the specific
                event.
              </p>

              <section id="onGroupClick" class="api">
                <h3>onGroupClick</h3>

                <p>
                  Called after a mouse click (or tap gesture) was detected on a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-select">default action</a>.
                </p>

                <p>
                  The following example shows how to make certain group unselectable.
                </p>

                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [
    { label: "Selectable" },
    { label: "Selectable" },
    { label: "Selectable" },
    { label: "Unselectable", unselectable: true },
    { label: "Unselectable", unselectable: true }
  ]},
  onGroupClick: function (event) {
    if (event.group.unselectable) {
      event.preventDefault();
    }
  },
  groupColorDecorator: function (opts, props, vars) {
    vars.groupColor = props.group.unselectable ? "#aaa" : "#77ff00";
    vars.labelColor = props.group.unselectable ? "#888" : "auto";
  }
});</pre>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupDoubleClick" class="api">
                <h3>onGroupDoubleClick</h3>

                <p>
                  Called after a double click (or double tap gesture) was detected on a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-expose">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupHold" class="api">
                <h3>onGroupHold</h3>

                <p>
                  Called after a click-and-hold (or tap-and-hold gesture) was detected on a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-open">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupHover" class="api">
                <h3>onGroupHover</h3>

                <p>
                  Called after the mouse pointer enters the area covered by a group or leaves the visualization area
                  completely. The callback will be invoked with one parameter &ndash; the <a href="#event-details">event
                  details object</a>. You can use that object to get more information about the affected group. You can
                  also use it to prevent the default action, which is highlighting of the hovered-on group.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupMouseWheel" class="api">
                <h3>onGroupMouseWheel</h3>

                <p>
                  Called after the mouse wheel is rotated over a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-zoom">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupMouseDown" class="api">
                <h3>onGroupMouseDown</h3>

                <p>
                  Called after the mouse pointer enters the area covered by a group or leaves the visualization area
                  completely. The callback will be invoked with one parameter &ndash; the <a href="#event-details">event
                  details object</a>. You can use that object to get more information about the affected group.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupDragStart" class="api">
                <h3>onGroupDragStart</h3>

                <p>
                  Called after the user starts dragging a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-pan">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupDrag" class="api">
                <h3>onGroupDrag</h3>

                <p>
                  Called when the user is dragging a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-pan">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupDragEnd" class="api">
                <h3>onGroupDragEnd</h3>

                <p>
                  Called when group dragging is complete. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupTransformStart" class="api">
                <h3>onGroupTransformStart</h3>

                <p>
                  Called after the user starts touch-based zooming over a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-zoom">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupTransform" class="api">
                <h3>onGroupTransform</h3>

                <p>
                  Called when the user is performing touch-based zooming over a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-zoom">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onGroupTransformEnd" class="api">
                <h3>onGroupTransformEnd</h3>

                <p>
                  Called when the user has completed touch-based zooming over a group. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>

              <section id="onKeyUp" class="api">
                <h3>onKeyUp</h3>

                <p>
                  Called when the user pressed a key. The callback will be invoked with
                  one parameter &ndash; the <a href="#event-details">event details object</a>. You can use that object
                  to get more information about the affected group. You can also use it to prevent the
                  <a href="#interaction-reset">default action</a>.
                </p>

                <p>
                  In the context of the callback, <code>this</code> points to the involved
                  instance of <code>CarrotSearchFoamTree</code>.
                </p>
              </section>
            </section>

            <section id="options-geometry-utils" class="api-group">
              <h2>Geometry utils</h2>

              <p>
                FoamTree exposes a number of geometry utilities useful when implementing <code>groupContentDecorator</code>s.
                The utilities are grouped into a static object available from <code>CarrotSearchFoamTree.geometry</code>.
                Please see below for a detailed list of utility methods.
              </p>

              <section id="geometry.boundingBox" class="api">
                <h3 class="nodefault" data-alt="boundingBox()">boundingBox(points)</h3>

                <p>
                  Given an array of points, returns the bounding box of the points.
                </p>

                <p>
                  The method is available statically as:
                </p>

                <p>
                  <code>
                    CarrotSearchFoamTree.geometry.boundingBox(points)
                  </code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>points</dt>
                  <dd>
                    <p>
                      the array of point coordinates. Each element of the array must be an object containing the
                      <code>x</code> and <code>y</code> properties representing the coordinates
                      of the point.
                    </p>
                  </dd>

                  <dt>&lt;return value&gt;</dt>
                  <dd>
                    <p>
                      an object representing the bounding box. The object contains the <code>x</code> and
                      <code>y</code> properties denoting the coordinates of the top-left corner of the rectangle, as well
                      as the <code>w</code> and <code>h</code> properties denoting the width and height of the
                      rectangle, respectively.
                    </p>
                  </dd>
                </dl>
              </section>

              <section id="geometry.polygonCentroid" class="api">
                <h3 class="nodefault" data-alt="polygonCentroid()">polygonCentroid(polygon)</h3>

                <p>
                  Computes the centroid (center of mass) and area of the provided polygon.
                </p>

                <p>
                  The method is available statically as:
                </p>

                <p>
                  <code>
                    CarrotSearchFoamTree.geometry.polygonCentroid(polygon)
                  </code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>polygon</dt>
                  <dd>
                    <p>
                      the input polygon. The polygon must be specified as an array of objects,
                      each object containing the <code>x</code> and <code>y</code> property representing the coordinates
                      of the polygon's vertex.
                    </p>

                    <p>
                      The polygon must be non-self-intersecting, vertex coordinates must be enumerated in clockwise or anti-clockwise
                      order. For performance reasons, this method will not verify if the criteria are met. If the
                      provided polygon does not satisfy the criteria, the result will be unspecified. Note that the
                      polygons returned when getting the <code>geometry</code> option meet both criteria.
                    </p>
                  </dd>

                  <dt>&lt;return value&gt;</dt>
                  <dd>
                    <p>
                      an object containing the <code>x</code> and <code>y</code> properties denoting the coordinates
                      of the centroid as well as the <code>area</code> property containing the area of the polygon
                      in pixels.
                    </p>
                  </dd>
                </dl>
              </section>

              <section id="geometry.rectangleInPolygon" class="api">
                <h3 class="nodefault" data-alt="rectangleInPolygon()">rectangleInPolygon(polygon, cx, cy, wTH, scale, fx, fy)</h3>

                <p>
                  Given a convex polygon, finds the largest inscribed rectangle of given aspect ratio <code>wTH</code>,
                  centered around the provided center point (<code>cx</code>, <code>cy</code>). Additionally, the resulting
                  rectangle can be scaled by the provided <code>scale</code> factor. Also, the alignment of the center
                  point relative to the rectangle can be defined by the (<code>fx</code>, <code>fy</code>) point.
                </p>

                <p>
                  The method is available statically as:
                </p>

                <p>
                  <code>
                    CarrotSearchFoamTree.geometry.rectangleInPolygon(polygon, cx, cy, wTH, scale, fx, fy)
                  </code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>polygon</dt>
                  <dd>
                    <p>
                      the polygon to inscribe the rectangle into. The polygon must be specified as an array of objects,
                      each object containing the <code>x</code> and <code>y</code> property representing the coordinates
                      of the polygon's vertex.
                    </p>

                    <p>
                      The polygon must be convex, vertex coordinates must be enumerated in clockwise or anti-clockwise
                      order. For performance reasons, this method will not verify if the criteria are met. If the
                      provided polygon does not satisfy the criteria, the result will be unspecified. Note that the
                      polygons returned when getting the <code>geometry</code> option meet both criteria.
                    </p>
                  </dd>

                  <dt>cx, cy</dt>
                  <dd>
                    <p>
                      coordinates of the point inside the polygon around which the rectangle should be centered.
                      For performance reasons, this method will not verify if the point lies inside the polygon.
                      For points outside or on the boundary of the polygon, the result is not specified.
                    </p>
                  </dd>

                  <dt>wTH</dt>
                  <dd>
                    <p>
                      (optional) the aspect ratio of the polygon to inscribe, the ratio is assumed to be the polygons width
                      divided by the polygon's height. If not provided, the ratio of <code>1.0</code> will be used, which
                      will produce a square.
                    </p>
                  </dd>

                  <dt>scale</dt>
                  <dd>
                    <p>
                      (optional) the scale factor to apply to the resulting rectangle. The rectangle will be scaled
                      relative to the alignment point determined by (<code>fx</code>, <code>fy</code>). If not provided,
                      the scale of <code>1.0</code> will be used, which will produce the largest possible rectangle
                      that fits inside the polygon and meets the center and alignment criteria.
                    </p>
                  </dd>

                  <dt>fx, fy</dt>
                  <dd>
                    <p>
                      (optional) defines what the the position of the center point (<code>cx</code>, <code>cy</code>)
                      should be relative to the rectangle. The default value is (<code>0.5</code>, <code>0.5</code>), which
                      will position the rectangle in such a way that the center point is at the center of the rectangle.
                      For (<code>fx</code>, <code>fx</code>) = (<code>0.0</code>, <code>0.0</code>), the center point
                      will overlap with the top-left corner of the rectangle. Similarly, when
                      (<code>fx</code>, <code>fx</code>) = (<code>1.0</code>, <code>1.0</code>), the center point
                      will be at the bottom-right corner of the rectangle. Values larger than <code>1.0</code> or
                      lower than <code>0.0</code> are also supported, in which case the center point will lie outside
                      of the rectangle.
                    </p>
                  </dd>

                  <dt>&lt;return value&gt;</dt>
                  <dd>
                    <p>
                      an object representing the produced rectangle. The object contains the <code>x</code> and
                      <code>y</code> properties denoting the coordinates of the top-left corner of the rectangle, as well
                      as the <code>w</code> and <code>h</code> properties denoting the width and height of the
                      rectangle, respectively.
                    </p>
                  </dd>
                </dl>

                <p>
                  The following example demonstrates the usage and results of this method.
                </p>
                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [
    { ratio: 1.0, shift: 0.0, scale: 1.0, fx: 0.5, fy: 0.5 },
    { ratio: 1.0, shift: 0.0, scale: 0.7, fx: 0.5, fy: 0.5 },
    { ratio: 1.0, shift: 0.0, scale: 0.5, fx: 0.5, fy: 0.5 },
    { ratio: 1.0, shift: 0.0, scale: 1.0, fx: 0.0, fy: 0.0 },
    { ratio: 1.0, shift: 0.0, scale: 1.0, fx: 1.0, fy: 1.0 },
    { ratio: 1.0, shift: 0.0, scale: 1.0, fx: 0.2, fy: 0.7 },
    { ratio: 1.0, shift: 0.0, scale: 1.0, fx: 0.2, fy: -0.5 },
    { ratio: 1.0, shift: 0.0, scale: 1.0, fx: 0.5, fy: 1.5 },
    { ratio: 2.0, shift: 0.0, scale: 1.0, fx: 0.5, fy: 0.5 },
    { ratio: 0.5, shift: 0.0, scale: 1.0, fx: 0.5, fy: 0.5 },
    { ratio: 1.0, shift: 0.2, scale: 1.0, fx: 0.5, fy: 0.5 },
    { ratio: 1.0, shift: 0.5, scale: 1.0, fx: 0.5, fy: 0.5 },
    { ratio: 1.0, shift: 0.7, scale: 1.0, fx: 0.5, fy: 0.5 }
  ]},
  groupContentDecorator: function (opts, params, vars) {
    // Prepare some variables
    var centerX = params.polygonCenterX;
    var centerY = params.polygonCenterY;
    var polygon = params.polygon;
    var scale = params.group.scale;
    var shift = params.group.shift;
    var fx = params.group.fx, fy = params.group.fy;

    if (shift > 0) {
      // Shift towards one vertex to make sure the point stays within the polygon
      centerX = centerX * (1 - shift) + polygon[0].x * shift;
      centerY = centerY * (1 - shift) + polygon[0].y * shift;
    }

    // Compute the inscribed rectangle
    var box = CarrotSearchFoamTree.geometry.rectangleInPolygon(
      polygon, centerX, centerY, params.group.ratio, scale, fx, fy);

    // Draw the rectangle
    var ctx = params.context;
    ctx.strokeStyle = "rgba(0, 0, 0, 0.5)";
    ctx.lineWidth = 2;
    ctx.strokeRect(box.x, box.y, box.w, box.h);

    // Draw the center point
    ctx.beginPath();
    ctx.arc(centerX, centerY, 5, 0, 2 * Math.PI);
    ctx.fill();

    // Draw the parameters too
    var fontSize = (params.boxHeight / 30);
    ctx.font = fontSize.toFixed(2) + "px Tahoma, sans-serif";
    ctx.textAlign = "center";
    ctx.fillText("(fx, fy) = (" + fx + ", " + fy + ")", centerX + 0.5 * fontSize, centerY - fontSize);
    ctx.fillText("scale = " + scale, centerX + 0.5 * fontSize, centerY - fontSize * 2);
  },
  titleBarDecorator: function (opts, params, vars) {
    // Display the details in the title bar on hover
    vars.titleBarShown = true;
    vars.titleBarText =
      "widthToHeight = " + params.group.ratio + "&#160;&#160;&#160;" +
        "shiftFromCenter = " + params.group.shift + "&#160;&#160;&#160;" +
        "margin = " + params.group.margin;
  }
});</pre>
              </section>

              <section id="geometry.circleInPolygon" class="api">
                <h3 class="nodefault" data-alt="circleInPolygon()">circleInPolygon(polygon, cx, cy)</h3>

                <p>
                  Given a convex polygon, finds the largest inscribed circle centered around the provided point.
                </p>

                <p>
                  The method is available statically as:
                </p>

                <p>
                  <code>
                    CarrotSearchFoamTree.geometry.circleInPolygon(polygon, cx, cy)
                  </code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>polygon</dt>
                  <dd>
                    <p>
                      the polygon to inscribe the circle into. The polygon must be specified as an array of objects,
                      each object containing the <code>x</code> and <code>y</code> property representing the coordinates
                      of the polygon's vertex.
                    </p>

                    <p>
                      The polygon must be convex, vertex coordinates must be enumerated in clockwise or anti-clockwise
                      order. For performance reasons, this method will not verify if the criteria are met. If the
                      provided polygon does not satisfy the criteria, the result will be unspecified. Note that the
                      polygons returned when getting the <code>geometry</code> option meet both criteria.
                    </p>
                  </dd>

                  <dt>cx, cy</dt>
                  <dd>
                    <p>
                      coordinates of the point inside the polygon around which the circle should be centered.
                      For performance reasons, this method will not verify if the point lies inside the polygon.
                      For points outside or on the boundary of the polygon, the result is not specified.
                    </p>
                  </dd>

                  <dt>&lt;return value&gt;</dt>
                  <dd>
                    <p>
                      the radius of the inscribed polygon in pixels.
                    </p>
                  </dd>
                </dl>

                <p>
                  The following example demonstrates the usage and results of this method.
                </p>
                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [
    { shift: 0.0, margin: 0.0 },
    { shift: 0.0, margin: 0.2 },
    { shift: 0.0, margin: 0.4 },
    { shift: 0.0, margin: 0.6 },
    { shift: 0.2, margin: 0.0 },
    { shift: 0.4, margin: 0.0 },
    { shift: 0.6, margin: 0.0 }
  ]},
  groupContentDecorator: function (opts, params, vars) {
    // Prepare some variables
    var centerX = params.polygonCenterX;
    var centerY = params.polygonCenterY;
    var polygon = params.polygon;
    var margin = params.group.margin;
    var shift = params.group.shift;

    if (shift > 0) {
      // Shift towards one vertex to make sure the point stays within the polygon
      centerX = centerX * (1 - shift) + polygon[0].x * shift;
      centerY = centerY * (1 - shift) + polygon[0].y * shift;
    }

    // Compute the inscribed circle
    var radius = CarrotSearchFoamTree.geometry.circleInPolygon(
      polygon, centerX, centerY) * (1 - margin);

    // Draw the circle
    params.context.lineWidth = 2;
    params.context.beginPath();
    params.context.arc(centerX, centerY, radius, 0, 2 * Math.PI);
    params.context.stroke();

    // Draw the center point
    params.context.beginPath();
    params.context.arc(centerX, centerY, 5, 0, 2 * Math.PI);
    params.context.fill();
  },
  titleBarDecorator: function (opts, params, vars) {
    // Display the details in the title bar on hover
    vars.titleBarShown = true;
    vars.titleBarText =
      "shiftFromCenter = " + params.group.shift + "&#160;&#160;&#160;" +
        "margin = " + params.group.margin;
  }
});</pre>
              </section>

              <section id="geometry.stabPolygon" class="api">
                <h3 class="nodefault" data-alt="stabPolygon()">stabPolygon(polygon, cx, cy, angle)</h3>

                <p>
                  Splits the given convex polygon into two polygons along the line defined by the
                  provided point and angle.
                </p>

                <p>
                  The method is available statically as:
                </p>

                <p>
                  <code>
                    CarrotSearchFoamTree.geometry.stabPolygon(polygon, cx, cy, angle)
                  </code>
                </p>

                <p>
                  where:
                </p>

                <dl class="dl-horizontal">
                  <dt>polygon</dt>
                  <dd>
                    <p>
                      the polygon to split. The polygon must be specified as an array of objects,
                      each object containing the <code>x</code> and <code>y</code> property representing the coordinates
                      of the polygon's vertex.
                    </p>

                    <p>
                      The polygon must be convex, vertex coordinates must be enumerated in clockwise or anti-clockwise
                      order. For performance reasons, this method will not verify if the criteria are met. If the
                      provided polygon does not satisfy the criteria, the result will be unspecified. Note that the
                      polygons returned when getting the <code>geometry</code> option meet both criteria.
                    </p>
                  </dd>

                  <dt>cx, cy</dt>
                  <dd>
                    <p>
                      coordinates of the point that defines the splitting line.
                    </p>
                  </dd>

                  <dt>angle</dt>
                  <dd>
                    <p>
                      the angle defining the splitting line, in radians.
                    </p>
                  </dd>

                  <dt>&lt;return value&gt;</dt>
                  <dd>
                    <img src="../demos/assets/img/polygon-stabbing.jpg"
                         style="float: right; max-width: 50%; min-width: 30%" />

                    <p>
                      an array of two polygons being the result of the split or <code>undefined</code> if the provided
                      line does not intersect the provided polygon.
                    </p>

                    <p>
                      An example result is shown in the figure, where one of the resulting polygons (drawn in white
                      dashed line) has 4 vertices and the other (drawn in black dashed line) has 5 vertices.
                    </p>

                    <p>
                      Please note the following properties of the returned polygons:
                    </p>

                    <ul>
                      <li>
                        Each polygon is represented by an array of objects representing the polygon's vertices;
                        each such object has the <code>x</code> and <code>y</code> properties defining the coordinates
                        of the vertex.
                      </li>

                      <li>Both returned polygons are convex with vertices enumerated in the clockwise order.</li>

                      <li>
                        The returned polygons have one edge in common as shown by the black-white dashed in the figure.
                        The two points defining the common edge in both polygons are always at indices <code>0</code>
                        and <code>1</code> in the corresponding arrays, although not in the same order to preserve the
                        clockwise enumeration order of the vertices.
                      </li>

                      <li>
                        The order of the two resulting polygons in the returned array is deterministic. For example, if
                        <code>angle = 0</code>, the polygon at index <code>0</code> will be the upper one, polygon
                        at index <code>1</code> will be the lower one. When the angle becomes 90 degrees, polygon at
                        index <code>0</code> will be on the left, polygon at index <code>1</code> will be on the right.
                      </li>

                      <li>
                        If the provided line overlaps with any edge of the provided polygon or contains any
                        vertex of the provided polygon, the returned polygons may be degenerate (e.g. have zero area and
                        duplicated vertices).
                      </li>
                    </ul>
                  </dd>
                </dl>

                <p>
                  The following example demonstrates the usage and results of this method.
                </p>
                <pre class="partial empty executable example">
foamtree.set({
  dataObject: {
    groups: (function () {
      var groups = [];
      for (var i = 0; i < 24; i++) {
        groups.push({ angle: Math.PI * i / 24 });
      }
      return groups;
    })()
  },
  relaxationInitializer: "squarified",
  groupBorderRadius: 0,

  groupContentDecorator: function (opts, params, vars) {
    // Split the polygon along its center
    var split = CarrotSearchFoamTree.geometry.stabPolygon(params.polygon,
      params.polygonCenterX, params.polygonCenterY, params.group.angle);

    // If splitting was successful, draw both polygons
    if (split) {
      var j;
      var ctx = params.context;
      ctx.setLineDash([8, 8]);

      ctx.fillStyle = "blue";
      ctx.beginPath();
      ctx.arc(params.polygonCenterX, params.polygonCenterY, 5, 0, Math.PI * 2);
      ctx.fill();

      // Draw the first polygon
      ctx.lineWidth = 3;
      ctx.strokeStyle = "white";
      ctx.beginPath();
      ctx.moveTo(split[0][0].x, split[0][0].y);
      for (j = 1; j < split[0].length; j++) {
        ctx.lineTo(split[0][j].x, split[0][j].y);
      }
      ctx.closePath();
      ctx.stroke();

      // Draw the second polygon. We set a line dash offset
      // and the use unusual iteration order to draw the common
      // edge of the two polygons in a coherent way (start and end
      // the line in at the same points). This will ensure that
      // the dashed elements don't overlap.
      ctx.lineDashOffset = 8;
      ctx.strokeStyle = "black";
      ctx.beginPath();
      ctx.moveTo(split[1][1].x, split[1][1].y);
      var len = split[1].length;
      for (var i = len - 1; i >= 1; i--) {
        var p = split[1][(i + 1) % len];
        ctx.lineTo(p.x, p.y);
      }
      ctx.closePath();
      ctx.stroke();
    }
  }
});</pre>
              </section>
            </section>

            <section id="options-drawing-context" class="api-group">
              <h2>Drawing context</h2>

              <p>
                The <code>groupContentDecorator</code> exposes a drawing context buffer that must be used do
                draw the custom content of the polygon. While the provided context behaves like the standard
                <a href="https://developer.mozilla.org/en/docs/Web/API/CanvasRenderingContext2D">CanvasRenderingContext2D</a>,
                it also exposes a number of useful non-standard methods.
              </p>

              <section id="context.roundRect" class="api">
                <h3 class="nodefault" data-alt="roundRect()">roundRect(x, y, w, h, r)</h3>

                <p>
                  Prepares a path of a rectangle with rounded corners. The path can then be filled and/or stroked
                  depending on the needs.
                </p>

                <p>
                  This method accepts the following parameters:
                </p>

                <dl class="dl-horizontal">
                  <dt>x, y</dt>
                  <dd>
                    <p>
                      coordinates of the top-left corner of the rectangle.
                    </p>
                  </dd>

                  <dt>w, h</dt>
                  <dd>
                    <p>
                      width and height of the rectangle, in pixels.
                    </p>
                  </dd>

                  <dt>r</dt>
                  <dd>
                    <p>
                      radius of the corners, in pixels.
                    </p>
                  </dd>
                </dl>

                <p>
                  The following example demonstrates the this method.
                </p>
                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: randomGroups(30) },

  groupContentDecorator: function (opts, params, vars) {
    var box = CarrotSearchFoamTree.geometry.rectangleInPolygon(
      params.polygon, params.polygonCenterX, params.polygonCenterY,
      4, 0.8);

    var ctx = params.context;
    ctx.roundRect(box.x, box.y, box.w, box.h, box.h * 0.1);
    ctx.fillStyle = "rgba(255, 255, 255, 0.4)";
    ctx.fill();
    ctx.strokeStyle = "rgba(255, 255, 255, 0.7)";
    ctx.stroke();
  }
});</pre>

              </section>

              <section id="context.fillPolygonWithText" class="api">
                <h3 class="nodefault" data-alt="fillPolygonWithText()">fillPolygonWithText(polygon, cx, cy, text, options)</h3>

                <p>
                  Fills the provided polygon with text. If needed, this method will split the text into multiple lines
                  and then record the appropriate <code>fillText()</code> calls to the context on which the method was
                  called.
                </p>

                <p>
                  Please note that it may happen that the method is unable to fill the polygon with text given
                  the provided set of options. Therefore, the callers must check the information object returned
                  by this method to ensure the text was actually fit in the polygon.
                </p>

                <p>
                  This method accepts the following parameters:
                </p>

                <dl class="dl-horizontal">
                  <dt>polygon</dt>
                  <dd>
                    <p>
                      the polygon to fill the text with. The polygon must be specified as an array of objects,
                      each object containing the <code>x</code> and <code>y</code> property representing the coordinates
                      of the polygon's vertex.
                    </p>

                    <p>
                      The polygon must be convex, vertex coordinates must be enumerated in the clockwise
                      order. For performance reasons, this method will not verify if the criteria are met. If the
                      provided polygon does not satisfy the criteria, the result will be unspecified. Note that the
                      polygons returned when getting the <code>geometry</code> option meet both criteria.
                    </p>
                  </dd>

                  <dt>cx, cy</dt>
                  <dd>
                    <p>
                      the center point that determines the location of the text within the polygon.
                    </p>
                  </dd>

                  <dt>text</dt>
                  <dd>
                    <p>
                      the text to fill the polygon with. This method supports a number of <a
                      href="#special-characters-in-labels">special characters</a> in the text.
                    </p>
                  </dd>

                  <dt>options</dt>
                  <dd>
                    <p>
                      Additional options for this method:
                    </p>

                    <dl class="dl-horizontal wide">
                      <dt>fontFamily</dt>
                      <dd>
                        the font family to assume when filling the polygon with text, <code>sans-serif</code> by default.
                      </dd>

                      <dt>fontWeight</dt>
                      <dd>
                        <span class="label label-default">Since 3.2.2</span> the font weight (e.g. <code>bold</code>)
                        to assume when filling the polygon with text, <code>normal</code> by default.
                      </dd>

                      <dt>fontStyle</dt>
                      <dd>
                        <span class="label label-default">Since 3.2.2</span> the font style (e.g. <code>italic</code>)
                        to assume when filling the polygon with text, <code>normal</code> by default.
                      </dd>

                      <dt>fontVariant</dt>
                      <dd>
                        <span class="label label-default">Since 3.2.2</span> the font variant (e.g. <code>small-caps</code>)
                        to assume when filling the polygon with text, <code>normal</code> by default.
                      </dd>

                      <dt>minFontSize</dt>
                      <dd>
                        the minimum font size in pixels to use for filling the text, <code>0</code> by default.
                      </dd>

                      <dt>maxFontSize</dt>
                      <dd>
                        the maximum font size in pixels to use for filling the text, <code>72</code> by default.
                      </dd>

                      <dt>lineHeight</dt>
                      <dd>
                        the line height to assume when splitting the text into mulitple lines, <code>1.05</code> by default.
                        Line heights smaller than <code>1.0</code> are currently not supported.
                      </dd>

                      <dt>verticalAlign</dt>
                      <dd>
                        the vertical align of the text relative to the center point (<code>cx</code>, <code>cy</code>),
                        <code>center</code> by default. The following allignments are supported:

                        <dl class="dl-horizontal narrow">
                          <dt>top</dt>
                          <dd>the top line of the text will be at the <code>cy</code> coordinate of the center point</dd>

                          <dt>bottom</dt>
                          <dd>the bottom line of the text will be at the <code>cy</code> coordinate of the center point</dd>

                          <dt>center</dt>
                          <dd>the text will be centered vertically around the center point</dd>
                        </dl>

                        <p>
                          Please note that currently the horizontal align option is not available, the text will always
                          be centered horizontally.
                        </p>
                      </dd>

                      <dt>horizontalPadding</dt>
                      <dd>
                        the horizontal padding to apply to each line of text. The unit of this option is the font
                        size used to render the text. Default value: <code>1.0</code>.
                      </dd>

                      <dt>verticalPadding</dt>
                      <dd>
                        the vertical padding to apply to the whole block of text. The unit of this option is the font
                        size used to render the text. Default value: <code>0.5</code>.
                      </dd>

                      <dt>maxTotalTextHeight</dt>
                      <dd>
                        The maximum total height of the text block as a fraction of the polygon's bounding box height,
                        <code>0.95</code> by default.
                      </dd>

                      <dt>allowEllipsis</dt>
                      <dd>
                        if <code>true</code> and the complete text does not fit in the polygon, fill as much text
                        as possible and append the ellipsis to replace the non-fitting part of the text, <code>false</code>
                        by default.
                      </dd>

                      <dt>allowForcedSplit</dt>
                      <dd>
                        if <code>true</code> the text can be split at arbitrary points, such as inside words,
                        during the filling process, <code>false</code> by default.
                      </dd>

                      <dt>cache</dt>
                      <dd>
                        <p>
                          if a non-null object is provided, this method will use it to cache some geometry information
                          to speed up the text filling process. When another text filling request is made and the same
                          cache object is presented, this method will try to reuse the cached information to speed up
                          the layout process. If, however, the geometry of the polygon changes a lot, the cache will not
                          be used and a complete filling process will be performed.
                        </p>

                        <p>
                          For caching to work properly, dedicated cache objects need to be provided for each
                          logical polygon. For example, each group polygon will require a separate cache object.
                          Moreover, to perform caching, the <code>area</code> option must also be provided.
                        </p>

                        <p>
                          Default value: <code>undefined</code>, meaning no caching will be performed.
                        </p>
                      </dd>

                      <dt>area</dt>
                      <dd>
                        the current area of the polygon for which the filling is performed. The area must only be
                        provided if layout caching is desired.
                      </dd>

                      <dt>cacheInvalidationThreshold</dt>
                      <dd>
                        determines how much the area of the polygon must change in order to discard the cached
                        layout and invoke the complete text fitting process, <code>0.05</code> by default.
                      </dd>

                      <dt>invalidate</dt>
                      <dd>
                        if <code>true</code>, the cache will be invalidated and full text filling process will be
                        performed, regardless of whether the geometry of the polygon changed or not. If the label
                        text or font has changed, you must set the <code>invalidate</code> option to <code>true</code> to ensure
                        the text fitting is correctly performed.
                      </dd>
                    </dl>
                  </dd>
                  
                  <dt>&lt;return value&gt;</dt>
                  <dd>
                    <p>
                      an object summarizing the text filling process:
                    </p>

                    <dl class="dl-horizontal">
                      <dt>fit</dt>
                      <dd>
                        <code>true</code> when the text fit in the polygon. If this property is <code>false</code>,
                        then no text drawing commands were issued and the returned summary object does not have any other
                        properties.
                      </dd>

                      <dt>lineCount</dt>
                      <dd>
                        the number of lines into which the text was split.
                      </dd>

                      <dt>fontSize</dt>
                      <dd>
                        the font size, in pixels, in which the text was drawn.
                      </dd>

                      <dt>box</dt>
                      <dd>
                        the bounding box of the complete text block, an object with the <code>x</code>, <code>y</code>,
                        <code>w</code> and <code>h</code> properties representing the top-left corner coordinates,
                        width and height, respectively.
                      </dd>

                      <dt>ellipsis</dt>
                      <dd>
                        <code>true</code> if the ellipsis was applied at the end of the text.
                      </dd>
                    </dl>
                  </dd>
                </dl>

                <p>
                  The following example demonstrates the results of invoking this method with different options.
                </p>
                <pre class="partial empty executable example">
foamtree.set({
  dataObject: { groups: [
    { align: "center", minFontSize: 0, ellipsis: false,
      text: "Some short text" },

    { align: "center", minFontSize: 0, ellipsis: false,
      text: "Some italic text", style: "italic" },
    { align: "center", minFontSize: 0, ellipsis: false,
      text: "Some bold text", weight: "bold" },
    { align: "center", minFontSize: 0, ellipsis: false,
      text: "Some small-caps text", variant: "small-caps" },

    { align: "center", minFontSize: 0, ellipsis: false,
      text: "Some text longer by a small bit" },

    { align: "center", minFontSize: 0, ellipsis: false,
      text: "A rather long text which should still fit the polygon pretty comfortably" },

    { align: "center", minFontSize: 40, ellipsis: false,
      text: "A rather long text that will most likely not fit the polygon with some " +
            "large minFontSize. A rather long text that will most likely not fit " +
            "the polygon with some minFontSize."},

    { align: "center", minFontSize: 40, ellipsis: true,
      text: "A rather long text that will most likely require an ellipsis to fit the " +
            "polygon at some large minFontSize. A rather long text that will most likely " +
            "require an ellipsis to fit the polygon at some large minFontSize." },

    { align: "center", minFontSize: 0, ellipsis: false,
      text: "Testing vertical align of 'center'" },

    { align: "top",    minFontSize: 0, ellipsis: false,
      text: "Testing vertical align of 'top'" },

    { align: "bottom", minFontSize: 0, ellipsis: false,
      text: "Testing vertical align of 'bottom'" }
  ]},

  groupContentDecorator: function (opts, params, vars) {
    var ctx = params.context;

    var group = params.group;
    var fillTextInfo = ctx.fillPolygonWithText(
      params.polygon,
      params.polygonCenterX, params.polygonCenterY,
      group.text, {
        fontWeight: group.weight || "normal",
        fontStyle: group.style || "normal",
        fontVariant: group.variant || "normal",
        minFontSize: group.minFontSize,
        allowEllipsis: group.ellipsis,
        verticalAlign: group.align
      });

    if (!fillTextInfo.fit) {
      // Draw a red cross instead
      var box = CarrotSearchFoamTree.geometry.rectangleInPolygon(params.polygon,
        params.polygonCenterX, params.polygonCenterY, 1.0, 0.8);
      ctx.lineWidth = 3;
      ctx.strokeStyle = "red";
      ctx.moveTo(box.x, box.y);
      ctx.lineTo(box.x + box.w, box.y + box.h);
      ctx.moveTo(box.x + box.w, box.y);
      ctx.lineTo(box.x, box.y + box.h);
      ctx.stroke();
    }
  }
});</pre>

              </section>

              <section id="context.scratch" class="api">
                <h3 class="nodefault" data-alt="scratch()">scratch()</h3>

                <p>
                  Creates and returns a temporary drawing context buffer. Combined with the
                  <code><a href="#context.replay">replay()</a></code> method, the temporary contexts
                  can be useful in the following scenarios:
                </p>

                <ol>
                  <li>
                    <p>
                      <strong>Drawing a rectangle beneath the text that was fitted in a polygon.</strong>
                      The <code><a href="#context.fillPolygonWithText">fillPolygonWithText()</a></code>
                      method issues the drawing commands immediately, but in order to draw a rectangle beneath
                      the text, we need to know the bounding box of the text in advance. The solution is to
                      invoke the text filling on the temporary context, draw the rectangle based on the
                      text filling info returned by <code>fillPolygonWithText()</code> and finally replay
                      the temporary text buffer buffer to draw the text on top of the rectangle. The following
                      example demonstrates this approach.
                    </p>

                    <pre class="partial empty executable example">
  foamtree.set({
    dataObject: { groups: randomGroups(20) },

    groupContentDecorator: function (opts, params, vars) {
      var ctx = params.context;
      var group = params.group;

      var scratch = ctx.scratch();
      var fillTextInfo = ctx.fillPolygonWithText(
        params.polygon,
        params.polygonCenterX, params.polygonCenterY,
        "Group\u00a0" + (params.index + 1));

      if (fillTextInfo.fit) {
        // Draw the rectangle first
        var box = fillTextInfo.box;
        var padding = box.h * 0.15;
        ctx.lineWidth = 2;
        ctx.roundRect(box.x - padding, box.y - padding,
          box.w + 2 * padding, box.h + 2 * padding, padding);
        ctx.globalAlpha = 0.2;
        ctx.fill();
        ctx.globalAlpha = 0.6;
        ctx.stroke();
        scratch.replay(ctx);
      }
    }
  });</pre>
                  </li>

                  <li>
                    <p>
                      <strong>Caching expensive layout computations.</strong> When <code>groupContentDecoratorTriggering</code>
                      is <code>onSurfaceDirty</code>, the content decorator will be invoked each time the visualization
                      needs to be redrawn. During most of those calls, the geometry of the groups' polygons will remain
                      the same, so there may be no need recompute the layout of the custom content. One way to cache the
                      layout in such cases would be to create one or more drawing context buffers per group, fill
                      the buffers only when the <code>shapeDirty</code> property of the decorator is <code>true</code>
                      and when <code>shapeDirty</code> is <code>false</code>, replay the previously buffered drawing
                      commands. Please see the <a target="_blank" href="../demos/github.html">GitHub search example</a> for this
                      pattern applied in practice.
                    </p>
                  </li>
                </ol>
              </section>

              <section id="context.replay" class="api">
                <h3 class="nodefault" data-alt="replay()">replay(targetContext)</h3>

                <p>
                  Replays the content of the drawing context buffer to the <code>targetContext</code>. The target
                  context can either be another context buffer of the actual native drawing context. For usage
                  scenarios and examples, please see the <code><a href="#context.scratch">scratch()</a></code> method.
                </p>
              </section>
            </section>
          </section>

          <section id="releases">
            <div class="page-header"><h1>Release notes</h1></div>

            <section id="release-3.3.1">
              <h2>Version 3.3.1</h2>
              <span>19.09.2015</span>

              <p style="margin-top: 20px">
                The 3.3.1 fixes a number of minor issues found in version 3.3.0.
              </p>

              <p>
                The 3.3.1 release is a drop-in replacement for the 3.3.0 release.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>attributionWeight</dt>
                  <dd>
                    <p>
                      Version 3.3.1 introduces the <code>attributionWeight</code> option that you can use
                      to influence the size of the attribution group relative to other groups.
                    </p>
                  </dd>

                  <dt>attributionLogoScale</dt>
                  <dd>
                    <p>
                      Version 3.3.1 introduces the <code>attributionLogoScale</code> option that you can use
                      to customize the scale at which FoamTree will draw the custom attribution logo.
                    </p>
                  </dd>

                  <dt>attributionLogo accepts<br />the Image object</dt>
                  <dd>
                    <p>
                      Since version 3.3.1, the <code>attributionLogo</code> option also accepts the
                      <code><a href="https://developer.mozilla.org/en/docs/Web/API/HTMLImageElement.Image">Image</a></code>
                      instances. With this enhancement, you can <a href="../demos/attribution.html" target="_blank">render an SVG
                      attribution logo</a> that will look well regardless of the zoom level.
                    </p>
                  </dd>

                  <dt>attribution flag<br />passed to decorators</dt>
                  <dd>
                    <p>
                      As of version 3.3.1, the decorator functions, such as the <code>groupColorDecorator</code>,
                      will receive an extra flag indicating if the currently processed group is an attribution group.
                      Please see the <code>hierarchy</code> documentation for details.
                    </p>
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>attributionPosition <br />not respected for <br /> rectangular layouts</dt>
                  <dd>
                    <p>
                      Version 3.3.0 did not respect the <code>attributionPosition</code> option when layout was
                      set to <code>ordered</code> or <code>squarified</code>. Version 3.3.1 fixes this issue.
                      Please note, however, that the position of the attribution site in rectangular layouts
                      is limited to the top-left or bottom-right corner. Please see the <code>attributionPosition</code>
                      documentation for more details.
                    </p>
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.3.0">
              <h2>Version 3.3.0</h2>
              <span>16.02.2015</span>

              <p style="margin-top: 20px">
                The 3.3.0 release introduces rectangular group layouts as well as a number of small improvements
                and bug fixes.
              </p>

              <p>
                The 3.3.0 release is a drop-in replacement for earlier 3.2.x releases.
              </p>

              <section>
                <h3>New features</h3>

                <dl class="dl-horizontal wide">
                  <dt>Rectangular tree maps</dt>
                  <dd>
                    As of version 3.3.0 FoamTree can generate the traditional rectangular tree maps in addition
                    to the default polygonal layouts.

                    <a target="_blank" href="../demos/rectangular.html">
                      <img src="../demos/assets/img/rectangular-layouts.jpg" class="img-rounded img-responsive"
                           style="margin: 20px 0" alt="Traditional rectangular treemap in FoamTree" />
                    </a>

                    For more details, please see the <code>layout</code> option documentation
                    section and the source code of the above demo.
                  </dd>

                  <dt>Laying out groups<br />in left-to-right order</dt>
                  <dd>
                    <p>
                      Version 3.3.0 comes with support for laying out groups in the left-to-right fashion according to
                      their original order in the data object. Such ordered layout is possible with both
                      the polygonal and rectangular treemaps.
                    </p>

                    <p>
                      To generate the ordered polygonal layout, set the <code>relaxationInitializer</code> to
                      <code>ordered</code>; to generate the ordered rectangular layout, set <code>layout</code> to
                      <code>ordered</code>. In both cases, set <code>layoutByWeightOrder</code> to <code>false</code>.
                      Please see the <a href="../demos/rectangular.html" target="_blank">ordered layouts demo</a> source
                      code for a complete example.
                    </p>
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>indexByWeight property<br />uninitialized for<br />lower level groups</dt>
                  <dd>
                    <p>
                      Versions 3.2.x leave the <code>indexByWeight</code> property, available for decorator functions
                      and from the <code>hierarchy</code> option, uninitialized for non-root level groups. Version
                      3.3.0 fixes this issue.
                    </p>
                  </dd>
                </dl>
              </section>

              <section>
                <h3>API changes</h3>

                <dl class="dl-horizontal wide">
                  <dt>initializer renamed to<br />relaxationInitializer</dt>
                  <dd>
                    <p>
                      As of version 3.3.3, the <code>initializer</code> option would only be applicable when
                      <code>layout</code> is set to <code>relaxed</code>. To emphasize this dependency, the
                      <code>initializer</code> option has been renamed to <code>relaxationInitializer</code>.
                      With this change, all options that apply only when <code>layout</code> is <code>relaxed</code>
                      have the <code>relaxation*</code> prefix.
                    </p>

                    <p>
                      The 3.3.x and 3.4.x versions will keep <code>initializer</code> as an alias for
                      <code>relaxationInitializer</code>. In 3.5.0, the <code>initializer</code> alias will be removed.
                    </p>
                  </dd>

                  <dt>relaxationInitializer<br />value changes</dt>
                  <dd>
                    To better accommodate the multiple initializer algorithms, some values of the
                    <code>relaxationInitializer</code> option have been renamed as follows:

                    <table class="table" style="margin-top: 10px">
                      <thead>
                        <tr>
                          <th>Old value</th>
                          <th>New value</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td><code>treemap</code></td>
                          <td>becomes <code>squarified</code></td>
                        </tr>
                        <tr>
                          <td><code>order</code></td>
                          <td>becomes <code>ordered</code></td>
                        </tr>
                      </tbody>
                    </table>

                    <p>
                      The 3.3.x and 3.4.x versions will keep the previous values as aliases. In 3.5.0 the
                      aliases will be removed.
                    </p>
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.2.3">
              <h2>Version 3.2.3</h2>
              <span>12.11.2014</span>

              <p style="margin-top: 20px">
                The 3.2.2 release fixes a number of minor issues found in the earlier versions.
              </p>

              <p>
                The 3.2.3 release is a drop-in replacement for earlier 3.2.x releases.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>Getting current zoom scale</dt>
                  <dd>
                    As of version 3.2.3, you can get the <code>viewport</code> property to access the current zoom
                    scale and offsets. This information may be useful when drawing custom content on a separate
                    canvas on top of FoamTree.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>Preventing default action<br />for onGroupDragStart<br />should prevent panning</dt>
                  <dd>
                    <p>
                      Earlier versions required preventing the default action of all <code>onGroupDragStart</code>,
                      <code>onGroupDrag</code> and <code>onGroupDragEnd</code> to reliably disable
                      panning of the visualization area. As of version 3.2.3, it is enough to prevent
                      the default action of <code>onGroupDragStart</code> to achieve the same effect. Please see the
                      <code>viewport</code> option for a practical example.
                    </p>
                  </dd>

                  <dt>Incorrect gesture in the<br />interaction hints utility</dt>
                  <dd>
                    <p>
                      The <a href="#hints">interaction guide utility</a> incorrectly contained the right double-click
                      as the gesture to close the group. This release corrects the name of the gesture to be
                      right click-and-hold.
                    </p>
                  </dd>

                  <dt>JavaScript errors<br />on unsupported browsers</dt>
                  <dd>
                    <p>
                      Previous versions of FoamTree, when loaded on unsupported browsers, such as Internet Explorer 7,
                      would throw JavaScript errors before the the calling code had a chance to inspect
                      the <code>supported</code> property. Version 3.2.3 fixes this issue.
                    </p>
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.2.2">
              <h2>Version 3.2.2</h2>
              <span>10.11.2014</span>

              <p style="margin-top: 20px">
                The 3.2.2 release fixes a number of minor issues found in the earlier versions and adds
                the possibility to control the style, weight and variant of labels.
              </p>

              <p>
                The 3.2.2 release is a drop-in replacement for earlier 3.2.x releases.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>Font style, weight and<br />variant customization</dt>
                  <dd>
                    As of version 3.2.2, you can set the style, weight and variant of the font used to draw group
                    labels, title bar and generic text. For details, see: <code>groupLabelFontStyle</code>, <code>groupLabelFontWeight</code>,
                    <code>groupLabelFontVariant</code>, <code>titleBarFontStyle</code>, <code>titleBarFontWeight</code>,
                    <code>titleBarFontVariant</code> and <code>context.fillPolygonWithText</code>.
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>HTML tooltips example</dt>
                  <dd>
                    Version 3.2.2 comes with an <a href="../demos/tooltips.html" target="_blank">example of displaying
                    rich HTML-based tooltips</a> for each group.
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>More precise<br /> group hover detection</dt>
                  <dd>
                    Version 3.2.2 takes into account the <code>groupBorderWidth</code> when reporting group hover
                    change in the <code>onGroupHover</code> event. As a result, if the user pointer moves to the
                    gap between groups, FoamTree will trigger <code>onGroupHover</code> event with an <code>undefined</code>
                    group to indicate that no group is being hovered over.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>JavaScript errors when<br />showZeroWeightGroups<br />= false</dt>
                  <dd>
                    <p>
                      Versions prior to 3.2.2 may throw JavaScript errors when some groups
                      have zero weight and <code>showZeroWeightGroups</code> is set to <code>false</code>.
                    </p>

                    <p>
                      Version 3.2.2 fixes this issue.
                    </p>
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.2.1">
              <h2>Version 3.2.1</h2>
              <span>released on 09.09.2014</span>

              <p style="margin-top: 20px">
                The 3.2.1 release fixes a number of minor issues found in the earlier versions and adds
                the possibility to control the position of the attribution group.
              </p>

              <p>
                The 3.2.1 release is a drop-in replacement for earlier 3.2.x releases.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>Setting position of the<br />attribution group</dt>
                  <dd>
                    As of version 3.2.1, you can set the desired position of the attribution group using the
                    <code>attributionPosition</code> and <code>attributionDistanceFromCenter</code> attributes.
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>Lazy loading of data</dt>
                  <dd>
                    Example code of <a href="../demos/lazy-loading.html" target="_blank">lazy-loading of visualization
                    data</a> has been added.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>Touch-enabled desktop<br />devices supported</dt>
                  <dd>
                    <p>
                      Versions prior to 3.2.1 would disable mouse- and keyboard-based interactions when
                      support for touch input was detected. This would make it impossible to interact
                      with FoamTree using keyboard and mouse on a regular desktop computer with a touch-enabled
                      monitor attached.
                    </p>

                    <p>
                      Version 3.2.1 fixes this issue.
                    </p>
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>Correctly closing<br />unexposed groups</dt>
                  <dd>
                    <p>
                      Versions prior to 3.2.1 would close an unexposed group only when he user right-double-clicked
                      some child group of the exposed group. If the user right-double-clicked outside of the
                      exposed group, the group would get unexposed, but it would remain open.
                    </p>

                    <p>
                      As of version 3.2.1, if a group was opened as part the expose interaction, it will get closed
                      when the group gets unexposed, regardless of the gesture that triggered the unexposure.
                    </p>
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>groupContentDecorator<br />correctly set after<br />FoamTree is initialized</dt>
                  <dd>
                    Versions 3.1.0 and 3.2.0 would ignore the <code>groupContentDecorator</code> if set
                    after FoamTree was initialized. The 3.2.1 release fixes this issue.
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>JavaScript error in<br />groupContentDecorator<br />at high zoom levels</dt>
                  <dd>
                    Version 3.2.0 may throw JavaScript errors inside <code>groupContentDecorator</code>
                    code when drawing content at very high zoom levels. Version 3.2.1 fixes the issue.
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.2.0">
              <h2>Version 3.2.0</h2>
              <span>released on 08.07.2014</span>

              <p style="margin-top: 20px">
                The 3.2.0 release makes it possible to browse very large hierarchies consisting of 100k+ groups at 100+ levels.
                It also introduces a number of minor related improvements and bug fixes.
              </p>

              <p>
                The 3.2.0 release is a drop-in replacement for earlier 3.1.x releases in terms of API compatibility.
                For a list of functional changes, please see below.
              </p>

              <section>
                <h3>New features</h3>

                <dl class="dl-horizontal wide">
                  <dt>Support for browsing<br />very large data sets</dt>
                  <dd>
                    As of version 3.2.0, FoamTree switches from eagerly precomputing the layout for all group levels to
                    lazily initializing the layout when required. As a result of this change, you can now use FoamTree
                    to browse hierarchies consisting of many thousands of nodes without noticeable performance
                    degradation.

                    <a target="_blank" href="../demos/large.html">
                      <img src="../demos/assets/img/large-data-sets.jpg" class="img-rounded img-responsive"
                           style="margin: 20px 0" alt="FoamTree visualizing the Tree of Life" />
                    </a>

                    For more details, please see the <a href="#large-data-sets">Visualizing large data sets</a>
                    section and the source code of the above demo.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>Programmatic zooming</dt>
                  <dd>
                    You can now use the <code>zoom</code> method to zoom to the specified group.
                  </dd>

                  <dt>Performance improvements</dt>
                  <dd>
                    <p>
                      Version 3.2.0 significantly improves performance when <code>rolloutDuration</code>
                      is <code>0</code>. This setting is particularly useful when visualizing large numbers of groups
                      on one level.
                    </p>

                    <p>
                      Also, you can use the <code>maxGroupLevelsDrawn</code> and <code>maxGroupLabelLevelsDrawn</code>
                      options to improve the rendering performance at the cost of lowering the amount of detail.
                    </p>
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Functional changes</h3>

                <dl class="dl-horizontal wide">
                  <dt>Not all levels<br/>of groups drawn</dt>
                  <dd>
                    <p>
                      As of version 3.2.0, FoamTree draws only <code>maxGroupLevelsDrawn</code> of closed group levels.
                      In some cases, such as lowered <code>parentFillOpacity</code>, you may want to increase the
                      <code>maxGroupLevelsDrawn</code> to bring more group levels into view.
                    </p>
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.1.0">
              <h2>Version 3.1.0</h2>
              <span>released on 03.06.2014</span>

              <p style="margin-top: 20px">
                The 3.1.0 release adds two major new features: drawing custom content in FoamTree polygons and the ability
                to dynamically update the weights of existing groups. Additionally, version 3.1.0 comes with a number of
                new demos, minor improvements and bug fixes.
              </p>

              <p>
                The 3.1.0 release is a drop-in replacement for earlier 3.0.x releases.
              </p>

              <section>
                <h3>New features</h3>

                <dl class="dl-horizontal wide">
                  <dt>Drawing custom content<br/> in FoamTree polygons</dt>
                  <dd>
                    Since version 3.1.0, the <code>groupContentDecorator</code> option makes it possible to
                    draw arbitrary content in each FoamTree polygon. Please see the examples in the documentation
                    as well as the <a target="_blank" href="../demos/images.html">SVG images</a> and
                    <a target="_blank" href="../demos/github.html">GitHub search</a> for example decorations that can
                    be drawn.

                    <a target="_blank" href="../demos/github.html">
                      <img src="../demos/assets/img/github-search.jpg" class="img-rounded img-responsive"
                           style="margin: 20px" alt="FoamTree GitHub search demo" />
                    </a>
                  </dd>

                  <dt>Dynamic weight updates</dt>
                  <dd>
                    It is now possible to dynamically update weights of the visualized groups, FoamTree will
                    perform an animated transition between the old and new weight values. See the
                    <code>update</code> method for a complete example.
                  </dd>

                  <dt>Data generator<br />in settings panel</dt>
                  <dd>
                    The <a target="_blank" href="../demos/settings.html">settings panel</a> now comes with a data generator
                    that you can use to test your settings with data sets of different characteristics.

                    <a target="_blank" href="../demos/settings.html">
                      <img src="../demos/assets/img/data-generator.jpg" class="img-rounded img-responsive"
                           style="margin: 20px" alt="FoamTree data generator dialog" />
                    </a>
                  </dd>

                  <dt>New demos</dt>
                  <dd>
                    Version 3.1.0 come with four new demos:
                    <a target="_blank" href="../demos/github.html">GitHub search</a>,
                    <a target="_blank" href="../demos/csv.html">CSV to FoamTree</a>,
                    <a target="_blank" href="../demos/coverage.html">Code coverage visualization</a> and
                    <a target="_blank" href="../demos/images.html">Images in polygons</a>.
                    All of the demos make advanced use of the new and existing FoamTree APIs.

                    <a target="_blank" href="../demos/index.html">
                      <img src="../demos/assets/img/3.1.0-new-demos.jpg" class="img-rounded img-responsive"
                           style="margin: 20px" alt="New demos in FoamTree 3.1.0" />
                    </a>
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>Per-group layout initializers</dt>
                  <dd>
                    You can now specify <a href="#initializer-per-group">different layout initializers</a>
                    for each parent group separately.
                  </dd>

                  <dt>Redraw hints</dt>
                  <dd>
                    You can now suggest which groups need redrawing when calling the <code>redraw</code> method.
                  </dd>

                  <dt>Zoom scale exposed<br/>in titleBarDecorator</dt>
                  <dd>
                    Current zoom scale is now provided in the titleBarDecorator, which may be useful to determine
                    the title bar visibility when the content of the polygon is customized using the
                    <code>groupContentDecorator</code>.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>Fixing a memory leak when<br/>groupGrowingDuration &gt; 0</dt>
                  <dd>
                    <p>
                      When <code>groupGrowingDuration</code> was larger than <code>0</code>, FoamTree would prevent the
                      objects provided in the <code>dataObject</code> option from being garbage collected even after
                      some new data was subsequently set for rendering. Please note that the default value of <code>groupGrowingDuration</code>
                      is <code>0</code>, so this issue does not affect set ups running with the default value of that
                      option.
                    </p>

                    <p>
                      The 3.1.0 release fixes the memory leak.
                    </p>
                  </dd>

                  <dt>Undocumented options</dt>
                  <dd>
                    <p>
                      Since version 3.0.0, the <code>imageData</code> offered the <code>backgroundColor</code> option that
                      may come especially useful when exporting JPEG images. The option was undocumented in previous
                      versions.
                    </p>

                    <p>
                      Also, the <code>order</code> <code>relaxationInitializer</code> option was previously undocumented.
                    </p>
                  </dd>
                </dl>
              </section>

              <section>
                <h3>API changes</h3>

                <dl class="dl-horizontal wide">
                  <dt>groupLabelDottingThreshold<br/>removed</dt>
                  <dd>
                    <p>
                      Version 3.1.0 removes the <code>groupLabelDottingThreshold</code> option. FoamTree will now
                      always attempt to fit the group's label into its polygon and will draw the ellipsis instead of
                      the label if the label's font size (taking the current zoom factor into account) is smaller
                      than <code>groupLabelMinFontSize</code>.
                    </p>
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.0.3">
              <h2>Version 3.0.3</h2>
              <span>released on 10.04.2014</span>

              <p style="margin-top: 20px">
                The 3.0.3 release fixes a number of rendering issues found in version 3.0.2.
              </p>

              <p>
                The 3.0.3 release is a drop-in replacement for earlier 3.0.x releases.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>Better rendering<br />of small-font labels</dt>
                  <dd>
                    Version 3.0.3 improves rendering of small-font labels of deeply-nested groups
                    in Chrome, Safari and Firefox. The image below shows small-font label rendered
                    in Chrome by FoamTree 3.0.2 (left) and FoamTree 3.0.3 (right).

                    <img src="../demos/assets/img/foamtree-219.png" class="img-rounded img-responsive"
                         style="margin: 20px" alt="Improved small-font label rendering in FoamTree 3.0.3" />
                  </dd>
                </dl>

                <dl class="dl-horizontal wide">
                  <dt>Allowing default browser<br />actions on selected events</dt>
                  <dd>
                    Version 3.0.3 makes it possible to allow default browser actions on selected events,
                    such as mouse wheel movement. To allow the default browser event action, call the
                    <a href="#allowOriginalEventDefault">allowOriginalEventDefault()</a> method on the
                    appropriate <a href="#events-interaction">interaction event</a> details object. The
                    <a href="../demos/scrolling.html">scrollable content example</a> shows how to use
                    this technique to allow page content scrolling when mouse wheel is moved over FoamTree
                    element.
                  </dd>
                </dl>
              </section>
              
              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>Incorrect handling<br />of numeric group<br />identifier <code>0</code></dt>
                  <dd>
                    Fixes a problem with groups identified with an integer <code>0</code>, which could not be
                    selected and were ignored in methods accepting a list of identifiers.
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.0.2">
              <h2>Version 3.0.2</h2>
              <span>released on 14.02.2014</span>

              <p style="margin-top: 20px">
                The 3.0.2 release fixes a number of rendering issues found in version 3.0.1 and provides
                example code that <a target="_blank" href="../demos/legacy.html">emulates the look and feel of FoamTree 2.0.x</a>.
              </p>

              <p>
                The 3.0.1 release is a drop-in replacement for version 3.0.1 and 3.0.0.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>FoamTree 2.0.x emulation</dt>
                  <dd>
                    Version 3.0.2 adds a code example that
                    <a target="_blank" href="../demos/legacy.html">emulates the look and feel of FoamTree 2.0.x</a>. Please note
                    that the example code requires FoamTree 3.0.2 or later to run (FOAMTREE-201).
                  </dd>

                  <dt>FOAMTREE-203</dt>
                  <dd>
                    As of version 3.0.2, the <code>geometry</code> option exposes the coordinates of the
                    top-left corner of the group polygon's bounding box.
                  </dd>

                  <dt>FOAMTREE-209</dt>
                  <dd>
                    Version 3.0.2 reintroduces the <code>indexByWeight</code> group property known from FoamTree
                    2.0.x. The <code>indexByWeight</code> property is available in the <code>groupColorDecorator</code>
                    callback and also directly through the <code>hierarchy</code> read-only option.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>Certain options ignored</dt>
                  <dd>
                    Versions 3.0.0 and 3.0.1 would ignore certain options when provided at <code>CarrotSearchFoamTree</code>
                    instantiation. When the same options were changed using the <code>set</code> method, the
                    changes would not be ignored. The following options were affected by this bug:
                    <code>groupLabelFontFamily</code>, <code>groupLabelLineHeight</code>, <code>groupLabelHorizontalPadding</code>,
                    <code>groupLabelVerticalPadding</code>, <code>groupLabelMaxTotalHeight</code>,
                    <code>groupLabelMaxFontSize</code>. FoamTree 3.0.2 fixes the issue (FOAMTREE-211).
                  </dd>

                  <dt>Incorrect polygon clipping</dt>
                  <dd>
                    Versions 3.0.0 and 3.0.1 would occasionally incorrectly clip the child groups' polygons, which
                    may have resulted in distorted rendering and "flickering" during animated relaxation. Version
                    3.0.2 fixes the issue and also slightly improves the performance of polygon rendering (FOAMTREE-207,
                    FOAMTREE-210).
                  </dd>

                  <dt>All-black child groups</dt>
                  <dd>
                    If a group is the only direct child group of some parent, versions 3.0.0 and 3.0.1 would render
                    the child group in black, regardless of the lightness and color of the parent group. Version 3.0.2
                    fixes the issue (FOAMTREE-202).
                  </dd>

                  <dt>Non-string group IDs</dt>
                  <dd>
                    Versions prior to 3.0.2, did not resolve non-string group identifiers used in
                    <a href="#individual-group-selector">individual</a> and <a href="#multiple-group-selector">multiple
                    group selectors</a>. Version 3.0.2 fixes this issue (FOAMTREE-206).
                  </dd>
                </dl>
              </section>
            </section>

            <section id="release-3.0.1">
              <h2>Version 3.0.1</h2>
              <span>released on 09.01.2014</span>
              
              <p style="margin-top: 20px">
                The 3.0.1 release fixes a number of minor issues found in version 3.0.0.
              </p>

              <p>
                The 3.0.1 release is a drop-in replacement for version 3.0.0.
              </p>

              <section>
                <h3>Improvements</h3>

                <dl class="dl-horizontal wide">
                  <dt>FOAMTREE-199</dt>
                  <dd>
                    Version 3.0.1 improves rendering performance estimation on Webkit-based browsers
                    for increased animation smoothness.
                  </dd>

                  <dt>FOAMTREE-200</dt>
                  <dd>
                    Version 3.0.1 improves the layout of demo pages viewed on mobile devices.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <dl class="dl-horizontal wide">
                  <dt>FOAMTREE-197</dt>
                  <dd>
                    Version 3.0.0 incorrectly computed touch event coordinates when Hammer.js was used
                    to detect touch events. Version 3.0.1 fixes this issue and additionally improves
                    the performance of event detection on both desktop and mobile devices.
                  </dd>

                  <dt>FOAMTREE-198</dt>
                  <dd>
                    Version 3.0.0 would throw a JavaScript error on browsers that support local storage
                    in general but deny the use of it to the specific page in which FoamTree is embedded.
                    Version 3.0.1 fixes this issue.
                  </dd>
                </dl>
              </section>
            </section>            
            
            <section id="release-3.0.0">
              <h2>Version 3.0.0</h2>
              <span>released on 07.01.2014</span>

              <p style="margin-top: 20px">
                FoamTree 3.0.0 is a major new release with the layout and display engine
                rebuilt from ground up and a number of API improvements.
              </p>

              <section>
                <h3>New features</h3>

                <dl class="dl-horizontal wide">
                  <dt>New layout engine</dt>
                  <dd>
                    FoamTree 3.0.0 comes with a completely new layout and display engine. The new engine allows the same
                    data to be displayed in many <a href="#relaxationInitializer">arrangements</a> (such as with large
                    groups in the center, small groups in the center or large groups in the corner, like in FoamTree
                    2.0.x) while preserving the group weight to polygon area relationship.
                  </dd>

                  <dt>Zooming &amp; panning</dt>
                  <dd>
                    The new display engine allows you to zoom into specific groups and pan around the visualization.
                    On touch devices, the natural scaling and panning gestures are supported.
                  </dd>

                  <dt>Exposure</dt>
                  <dd>
                    Double clicking on a group, zooms to the group, visually
                    highlights it and opens for browsing the child groups.
                  </dd>

                  <dt>New label fitting</dt>
                  <dd>
                    The new label fitting algorithm is much faster and better uses the available
                    polygon area. The new algorithm also supports <a href="#special-characters-in-labels">special
                    characters</a>, such as non-breakable space, zero-width space and soft-hyphens.
                  </dd>

                  <dt>Polygon decorations</dt>
                  <dd>
                    New <a href="#group-decorations">polygon decorations</a> are now available,
                    including stroke and drop shadow.
                  </dd>

                  <dt>New effects</dt>
                  <dd>
                    Using detailed settings, you can now create your own <a href="#options-rollout">rollout</a>
                    and <a href="#options-pullback">pullback</a> effects.
                  </dd>

                  <dt>Utility scripts</dt>
                  <dd>
                    FoamTree now comes with a number of <a href="#utilities">utility scripts</a> which
                    you can use to add data loading progress indicator or a simple interaction guide dialog.
                  </dd>

                  <dt>API improvements</dt>
                  <dd>
                    Version 3.0.0 introduces a number of API improvements, such as registering multiple listener
                    functions for the same event or <a href="#promise">promises</a>.
                  </dd>
                </dl>
              </section>

              <section>
                <h3>Migration</h3>

                <p>
                  For typical use cases of the FoamTree API, version 3.0.0 should be a drop-in replacement for
                  FoamTree 2.0.x. The most common adjustment, if any, would be updating your code not to use the
                  <a href="#3.0.0-deprecations">options deprecated in version 2.0.x that have been removed in
                  version 3.0.0</a>. To quickly identify deprecated options in your code, <a href="#debugging">run
                  FoamTree with debugging assertions</a> right after the update. You may also consider using some of the
                  <a href="#3.0.0-noteworthy-improvements">API improvements added in version 3.0.0</a>.
                </p>

                <p>
                  If you have any problems porting your code to version 3.0.0, feel free to
                  <a href="mailto:info@carrotsearch.com">contact us</a> for help.
                </p>

                <div class="alert alert-warning">
                  <strong>Heads up!</strong>

                  <p>
                    While FoamTree 3.0.x is a drop-in replacement for the 2.0.x line
                    in terms of the JavaScript API compatibility, it introduced a
                    number of option defaults changes to refresh the visual appearance
                    and improve interaction.
                  </p>

                  <p>
                    If you'd like to revert to the look and feel known from FoamTree 2.0.x,
                    you can do so by tweaking a number of options as
                    <a target="_blank" href="../demos/legacy.html">this example code shows</a>.
                    The example is available in FoamTree 3.0.2 and later.
                  </p>
                </div>
              </section>

              <section id="3.0.0-api-changes" class="notoc">
                <h3>API changes</h3>

                <section id="3.0.0-noteworthy-improvements">
                  <h4>Noteworthy improvements</h4>

                  <dl class="dl-horizontal wide">
                    <dt>multiple event listeners</dt>
                    <dd>
                      You can now register <a href="#visualization-events">multiple</a> event listeners for
                      the same type of event. Furthermore, you can now use the <code>on</code>
                      and <code>off</code> methods to add and remove event listeners
                      without affecting the other registered listeners.
                    </dd>

                    <dt>promises</dt>
                    <dd>
                      Groups can now be open and exposed using the <code data-href="#open_method">open</code> and <code>expose</code>
                      methods. The methods return <a href="#promise">promises</a> that get resolved after the associated
                      animation completes.
                    </dd>

                    <dt>group properties</dt>
                    <dd>
                      You can now query various properties related to the group's state by reading the
                      <code>state</code>, <code>hierarchy</code> and <code>geometry</code> options.
                    </dd>

                    <dt>new group selectors</dt>
                    <dd>
                      There are more ways to <a href="#multiple-group-selector">designate a group or groups</a>
                      to be selected, open or exposed. In particular, the data object representing the group can
                      be used as a selector now.
                    </dd>

                    <dt>preventing default actions</dt>
                    <dd>
                      You can now prevent the <a href="#interaction">default interactions</a>
                      by calling the <code>preventDefault()</code> method of the <a
                      href="#event-details">low-level event</a> object in the appropriate
                      low-level event, such as <code>onGroupClick</code>.
                    </dd>
                  </dl>
                </section>

                <section id="3.0.0-deprecations">
                  <h4>Deprecations</h4>


                  <dl class="dl-horizontal wide api-changes">
                    <dt><code>onGroupSelectionChanged</code></dt>
                    <dd>
                      The array of selected groups previously available in the <code>selectedGroups</code> property of the
                      <code>onGroupSelectionChanged</code> event details is now available as the <code>groups</code> property.
                    </dd>

                    <dt><code>groupLabelDecorator</code></dt>
                    <dd>
                      FoamTree 2.0.x would expose the <code>labelColor</code> variable both in <code>groupLabelDecorator</code>
                      and <code>groupColorDecorator</code>. As of version 3.0.0, <code>labelColor</code> is only available
                      in <code>groupColorDecorator</code>.
                    </dd>
                  </dl>
                </section>

                <section>
                  <h4>Renamed options</h4>

                  <p>
                    A number of options have been renamed to form consistent option-grouping prefixes
                    or to follow conventions established by other option names.
                  </p>

                  <dl class="dl-horizontal wide api-changes">
                    <dt><code>labelDarkColor</code></dt>
                    <dd>renamed to <code>groupLabelDarkColor</code></dd>

                    <dt><code>labelLightColor</code></dt>
                    <dd>renamed to <code>groupLabelLightColor</code></dd>

                    <dt><code>labelColorThreshold</code></dt>
                    <dd>renamed to <code>groupLabelColorThreshold</code></dd>

                    <dt><code>groupGradientRadius</code></dt>
                    <dd>renamed to <code>groupFillGradientRadius</code></dd>

                    <dt><code>groupOverlayOpacity</code></dt>
                    <dd>renamed to <code>parentFillOpacity</code></dd>

                    <dt><code>groupFontFamily</code></dt>
                    <dd>renamed to <code>groupLabelFontFamily</code></dd>

                    <dt><code>groupMaxTotalLabelHeight</code></dt>
                    <dd>renamed to <code>groupLabelMaxTotalHeight</code></dd>

                    <dt><code>minGroupDiameter</code></dt>
                    <dd>renamed to <code>groupMinDiameter</code></dd>

                    <dt><code>pixelRatioDuringRollout</code></dt>
                    <dd>renamed to <code>wireframePixelRatio</code></dd>

                    <dt><code>onGroupOpenOrClose</code></dt>
                    <dd>renamed to <code>onGroupOpenOrCloseChanged</code></dd>
                  </dl>
                </section>

                <section>
                  <h4>Removed options</h4>

                  <p>
                    A number of options have been removed. Certain removed options have been replaced with
                    other options that allow you to achieve the same and a range of similar effects. A number
                    of options have been removed because they were not relevant in the updated layout and
                    rendering engine.
                  </p>

                  <dl class="dl-horizontal wide api-changes">
                    <dt><code>backgroundColor</code></dt>
                    <dd>
                      <p>
                        as of FoamTree 3.0.0 incremental group redrawing is performed on a much larger scale.
                        Explicit drawing of background color would prevent FoamTree from incremental visualization
                        updates and thus slow down rendering.
                      </p>

                      <p>
                        You can modify the background of the visualization by applying CSS styling to the
                        HTML element in which FoamTree is embedded .
                      </p>
                    </dd>

                    <dt><code>groupGradientType</code></dt>
                    <dd>
                      use the <code>groupFillType</code> to <code>plain</code> to disable gradients.
                    </dd>

                    <dt><code>groupGradientStrength</code></dt>
                    <dd>
                      use the <code>groupFillGradientCenterLightnessShift</code> and
                      <code>groupFillGradientRimLightnessShift</code> to achieve similar effects.
                    </dd>

                    <dt><code>groupSelectionColor</code></dt>
                    <dd>
                      use the <code>groupSelectionFillSaturationShift</code>
                      and <code>groupColorDecorator</code>
                      to tune the fill color of selected groups.
                    </dd>

                    <dt><code>groupHoverColor</code></dt>
                    <dd>
                      use the <code>groupHoverFillSaturationShift</code>
                      and <code>groupColorDecorator</code>
                      to tune the fill color of hovered groups.
                    </dd>

                    <dt><code>groupHoverOutlineColor</code></dt>
                    <dd>
                      use the <code>groupHoverStrokeSaturationShift</code>
                      and <code>groupHoverStrokeLightnessShift</code> options to tune the stroke color of hovered groups.
                    </dd>
                  </dl>

                  <dl class="dl-horizontal wide api-changes">
                    <dt><code>groupLinePadding</code></dt>
                    <dd>
                      renamed to <code>groupLabelLineHeight</code>, which now behaves
                      similar to the CSS <code>line-padding</code> property.
                    </dd>

                    <dt><code>groupMinFontSize</code></dt>
                    <dd>
                      to <code>groupLabelMinFontSize</code>. Note: as of FoamTree 3.0.0 only pixel-based values are
                      supported. You can apply percentage-based scaling using the <code>groupLabelMaxTotalHeight</code>
                      option.
                    </dd>

                    <dt><code>groupMaxFontSize</code></dt>
                    <dd>
                      to <code>groupLabelMaxFontSize</code>. Note: as of
                      FoamTree 3.0.0 only pixel-based values are supported.
                      You can apply percentage-based scaling using the
                      <code>groupLabelMaxTotalHeight</code> option.
                    </dd>
                  </dl>

                  <dl class="dl-horizontal wide api-changes">
                    <dt><code>rolloutType</code></dt>
                    <dd>
                      you can now create your own rollout effects using the <a href="#options-rollout">rollout options</a>.
                      Please see the API reference or the settings panel for a number of predefined effects.
                    </dd>

                    <dt><code>rolloutSpeed</code></dt>
                    <dd>
                      use <code>rolloutDuration</code> to determine the duration of the initial animation.
                    </dd>

                    <dt><code>rolloutRate</code></dt>
                    <dd>
                      use <code>rolloutLabelDrag</code> options
                      to determine how quickly subsequent groups are included in the initial animation.
                    </dd>

                    <dt><code>siblingRevealingParallelism</code></dt>
                    <dd>
                      you can use the <code>rolloutChildGroupsDrag</code> option to control the
                      sibling revealing parallelism.
                    </dd>

                    <dt><code>childRevealingParallelism</code></dt>
                    <dd>
                      you can use the <code>rolloutChildGroupsDelay</code> option to control the
                      child group revealing parallelism.
                    </dd>

                    <dt><code>fadeInTime</code></dt>
                    <dd>
                      fading-in time is now controlled by the overall <code>rolloutDuration</code>
                      option. To use a simple fade-in effect instead of the animated rollout,
                      see the <code>fadeDuration</code> option.
                    </dd>

                    <dt><code>fadeOutTime</code></dt>
                    <dd>
                      fading-out time is now controlled by the overall <code>pullbackDuration</code>
                      option. To use a simple fade-out effect instead of the animated pullback,
                      see the <code>fadeDuration</code> option.
                    </dd>

                    <dt><code>drawLabelsDuringRollout</code></dt>
                    <dd>
                      use the <code>wireframeLabelDrawing</code> option to control label drawing
                      during animations.
                    </dd>
                  </dl>

                  <dl class="dl-horizontal wide api-changes">
                    <dt><code>onBeforeSelection</code></dt>
                    <dd>
                      you can now prevent the selection action directly in the
                      <code>onGroupClick</code> event.
                    </dd>

                    <dt><code>onBeforeOpenOrClose</code></dt>
                    <dd>
                      you can now prevent the group opening action directly in the
                      <code>onGroupHold</code> event.
                    </dd>

                    <dt><code>roundBordersDuringRollout</code></dt>
                    <dd>
                      with improved rendering speed, this option is not relevant any more.
                    </dd>
                  </dl>

                  <dl class="dl-horizontal wide api-changes">
                    <dt id="deprecated-useFastRenderingRoutines"><code>useFastRenderingRoutines</code></dt>
                    <dd>not relevant as of FoamTree 3.0.0</dd>

                    <dt><code>aspectRatioImprovementSteps</code></dt>
                    <dd>not relevant as of FoamTree 3.0.0</dd>

                    <dt id="deprecated-groupWeightScaling"><code>groupWeightScaling</code></dt>
                    <dd>not relevant as of FoamTree 3.0.0</dd>

                    <dt><code>groupsVisibleAtRolloutStart</code></dt>
                    <dd>not relevant as of FoamTree 3.0.0</dd>

                    <dt><code>explodeDistance</code></dt>
                    <dd>not relevant as of FoamTree 3.0.0</dd>
                  </dl>
                </section>
              </section>
            </section>

            <section id="release-2.0.4">
              <h2>Version 2.0.4</h2>
              <span>released on 04.09.2013</span>

              <section>
                <h3>Improvements</h3>

                <ul>
                  <li>
                    Added support for <code>altKey</code>, <code>shiftKey</code> and other key modifiers to
                    the object passed to all mouse or touch callback events.
                  </li>
                  <li><code>onGroupClick</code> callback provides <code>group</code> property for the
                    topmost group one clicked on.
                  </li>
                </ul>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <ul>
                  <li>
                    FoamTree cells may move around (in a cycle) on redraw.
                  </li>
                </ul>
              </section>
            </section>

            <section id="release-2.0.3">
              <h2>Version 2.0.3</h2>
              <span>released on 06.03.2013</span>

              <section>
                <h3>Improvements</h3>

                <ul>
                  <li>
                    A number of events have been added to make it possible to change the default user interaction
                    mappings, such as selecting groups on an event other than single mouse click.
                  </li>
                </ul>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <ul>
                  <li>
                    A JavaScript error would be thrown when setting or getting unknown option. Release 2.0.3 fixes
                    this issue and logs the appropriate warning to the browser console.
                  </li>
                </ul>
              </section>
            </section>

            <section id="release-2.0.2">
              <h2>Version 2.0.2</h2>
              <span>released on 06.03.2013</span>

              <section>
                <h3>Improvements</h3>

                <ul>
                  <li>
                    The <code data-deprecation-href="#deprecated-groupWeightScaling">groupWeightScaling</code> option
                    has been added to influence the relative sizes of group polygons.
                  </li>

                  <li>
                    Versions prior to 2.0.2 would not draw selection outline when <code>groupBorderWidth</code> was smaller than 2.
                    Version 2.0.2 draws selection outline for all group border widths.
                  </li>
                </ul>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <ul>
                  <li>
                    Pinch-in and -out gestures would not always open/close the desired group
                    when the FoamTree HTML element was absolutely positioned. Release 2.0.2 fixes this issue.
                  </li>

                  <li>
                    When a number of groups had the same weight, FoamTree might needlessly change
                    the layout of polygons during redraw. As of release 2.0.2 the layout remains
                    stable if the size of the visualization is not changing.
                  </li>

                  <li>
                    The <code>onRedraw</code> callback would not be called after new data set was loaded. Release 2.0.2
                    fixes this problem.
                  </li>

                  <li>
                    Options object passed to the <code>set</code> method could get modified by FoamTree. Release 2.0.2
                    will not modify objects passed to the <code>set</code> method.
                  </li>

                  <li>
                    Options objects passed to the decorator callbacks, such as <code>groupColorDecorator</code>
                    contained obfuscated option names. As of release 2.0.2, the callbacks will
                    receive options object with original option names.
                  </li>

                  <li>
                    Color variables in decorator callbacks, such as <code>groupColorDecorator</code>,
                    now support CSS3 color strings in hex, hsl, hsla, rgb and rgba models in addition
                    to the object-based color specification.
                  </li>

                  <li>
                    On Mac OS, +click brings up context menu instead of adding new
                    groups to the current selection. Release 2.0.2 fixes this issue.
                  </li>
                  <li>
                    The <code>group</code> property was undefined in <code>groupLabelDecorator</code> for
                    the attribution group. Release 2.0.2 returns the <code>{ attribution: true }</code>
                    object in that property.
                  </li>
                </ul>
              </section>

              <section>
                <h3>Deprecations</h3>

                <ul>
                  <li>
                    As of version 2.1.0, the property in which the <code>onGroupSelectionChanged</code>
                    event exposes the selected groups will be renamed from <code>selectedGroups</code>
                    to <code>groups</code>. Throughout 2.0.x line, the deprecated property
                    <code>selectedGroups</code> will be maintained as an alias in addition to the
                    new property.
                  </li>

                  <li>
                    As of version 2.1.0, the <code>labelColor</code> variable affecting group label color will be moved
                    from <code>groupLabelDecorator</code> to <code>groupColorDecorator</code>. To allow rapid migration
                    and to preserve compatibility, the 2.0.x line will handle <code>labelColor</code> changes both in
                    <code>groupLabelDecorator</code> and <code>groupColorDecorator</code>.
                  </li>
                </ul>
              </section>
            </section>

            <section id="release-2.0.1">
              <h2>Version 2.0.1</h2>
              <span>released on 08.08.2012</span>

              <section>
                <h3>Improvements</h3>

                <ul>
                  <li>
                    The 2.0.1 release introduces support for high-density screens, such
                    as Retina. You can use the <code>pixelRatio</code>
                    option to set the physical-to-display pixel ratio FoamTree should assume.
                  </li>

                  <li>
                    As of the 2.0.1 release, group <code>weight</code>s become optional in the <code>dataObject</code>
                    specification. Groups with unspecified weights will be assumed to have the weight equal to
                    <code>1.0</code>.
                  </li>
                </ul>
              </section>

              <section>
                <h3>Bug fixes</h3>

                <ul>
                  <li>
                    Opening a group by double click would change the selection state of the group being open.
                    Release 2.0.1 fixes this issue.
                  </li>

                  <li>
                    Adding a CSS border to the FoamTree container element might create a blurry
                    visualization image. Release 2.0.1 fixes this issue.
                  </li>

                  <li>
                    FoamTree optimized rendering routines would produce incorrect results on
                    certain mobile devices, most likely caused by the browser bugs. Until the bugs get
                    fixed, as of version 2.0.1 FoamTree defaults to slower but correct rendering
                    routines on those devices. Please see the <code data-deprecation-href="#deprecated-useFastRenderingRoutines">useFastRenderingRoutines</code>
                    option for more details.
                  </li>

                  <li>
                    In certain cases the initial layout generated by FoamTree might be unstable
                    and change after the first call to <code>redraw</code>. Version 2.0.1 fixes the issue.
                  </li>

                  <li>
                    FoamTree would not redraw groups without <code>id</code>s on programmatic changes of selection and
                    expansion. Version 2.0.1 fixes the issue.
                  </li>

                  <li>
                    FoamTree would throw a JavaScript error when selection is programmatically
                    changed immediately after a new data model has been set. Version 2.0.1 fixes the
                    issue.
                  </li>
                </ul>
              </section>


              <section id="release-2.0.0">
                <h2>Version 2.0.0</h2>
                <span>released on 25.06.2012</span>

                <p style="margin-top: 20px">
                  Initial release of FoamTree for HTML5.
                </p>
              </section>
            </section>
          </section>


          <!--
          <div class="api-group">
            <h2 id=""></h2>

            <div class="api">
              <h3 id=""></h3>
            </div>
          </div>
          -->

          <hr />
          <footer><p>&copy; Carrot Search s.c.</p></footer>
        </section>
      </div>
    </div>

    <script src="../demos/assets/js/jquery-2.0.3.min.js"></script>
    <script src="../demos/assets/js/hammer.min.js"></script>

    <script src="../demos/assets/js/bootstrap-scrollspy.js"></script>
    <script src="../demos/assets/js/highlight.pack.js"></script>

    <script src="../carrotsearch.foamtree.js"></script>
    <script src="../carrotsearch.foamtree.asserts.js"></script>
    <script src="../demos/assets/js/carrotsearch.api.helpers.js"></script>

    <!-- Preload some data sets with JSONP. -->
    <script>
      window['dataSets'] = {};
      modelDataAvailable = function(data, description) {
        dataSets[description.file] = description;
        description.data = data;

        // Make a shorter alias to the large file.
        if (description.file == "data-mining-500-topic-hierarchical.jsonp") {
          window['largeDataSet'] = data;
        }
      }
    </script>
    <script src="../demos/assets/data/data-mining-500-topic-hierarchical.js"></script>
    <script src="../demos/assets/data/full-3-level.js"></script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-317750-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
